<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <script>
        /*
            call()
                调用一个函数，其具有一个指定的this值和分别地提供的参数(参数列表)
            
            call() 和 apply()区别:
                call(): 接受的是若干个参数的列表

                apply(): 接受的是一个包含多个参数的数组

            bind() 与 call() 和 apply()最大的区别:
                bind(): 返回一个绑定上下文的函数

                call()和apply(): 直接执行了函数
        */

        /*
            原型
        */

        var value = 0;
        var foo = {
            value: 1
        };
        function bar(){
            console.log(this.value);
        }
        bar.call(foo);

        var foo = {
            value: 1,
            bar: function(){
                console.log(this.value);
            }
        };
        foo.bar();  // 1

        /*
            1. 将函数设置为对象的属性: foo.fn = bar
            2. 执行函数: foo.fn()
            3. 删除函数: delete foo.fn
        */
        Function.prototype.call2 = function(context){
            // 首先要获取调用call的函数，用this可以获取
            context.fn = this;
            console.log('------', this);
            context.fn();
            console.log('--111---', this);
            delete context.fn;
        }
        bar.call2(foo);

        /*
            bar如果有参数怎么解决
        */
        Function.prototype.call3 = function(context){
            context.fn = this;
            var args = [];
            for(var i=1, len=arguments.length; i<len; i++){
                args.push('arguments[' + i + ']');
            }
            eval('context.fn(' + args + ')');
            delete context.fn;
        }
        function bar(name, age){
            console.log(name, age, this.value);
        }
        bar.call3(foo, 'conk', 18);

        /*
            1. this传入null或者undefined，此时this指向window
            2. this参数可以传基本类型数据， 原生的call会自动用Object()转换
            3. 函数是可以有返回值的
        */
        Function.prototype.call4 = function(context){
            context = context ? Object(context) : window;
            context.fn = this;
            var args = [];
            for(var i=1, len=arguments.length; i<len; i++){
                args.push('arguments[' + i + ']');
            }
            var result = eval('context.fn(' + args + ')');
            delete context.fn;
            return result;
        }

        /*
            1. 指定this
            2. 返回一个函数
            3. 可以传入参数
            4. 柯里化
        */
        

    </script>
</body>
</html>