
        <html xmlns:v="urn:schemas-microsoft-com:vml"
        xmlns:o="urn:schemas-microsoft-com:office:office"
        xmlns:w="urn:schemas-microsoft-com:office:word"
        xmlns="http://www.w3.org/TR/REC-html40">
        <head><meta http-equiv=Content-Type content="text/html;  
        charset=utf-8">
		<style type="text/css">
			table  
			{  
				border-collapse: collapse;
				border: none;  
				width: 100%;  
			}  
			td  
			{  
				border: solid #CCC 1px;  
			}  
			.codestyle{
				word-break: break-all;
				background:silver;mso-highlight:silver;
			}
		</style>
        <meta name=ProgId content=Word.Document>
        <meta name=Generator content="Microsoft Word 11">
        <meta name=Originator content="Microsoft Word 11">
        <xml><w:WordDocument><w:View>Print</w:View></xml></head>
        <body><h1>1、默认页面</h1><div style="margin-left:20px;"><ul>
<li>oss 获取token 接口定义
url：x.namibox.com/vschool/get_oss_utoken?objectKey=vschool/facial&bucket=namibox
args：
<ol>
<li>objectKey： path设置</li>
<li>bucket：bucket设置，不写就是默认值</li>
</ol></li>
</ul>
<p>result：</p>
<pre><code class="language-json">{
  &quot;AccessKeySecret&quot;: &quot;HR3fYuy1v6QxHZmApzFajTzax5XKo5QZjVqnoBHaa8qH&quot;, 
  &quot;errcode&quot;: 0,
  &quot;SecurityToken&quot;: &quot;CAISqQJ1q6Ft5B2yfSjIq/HBIvb3rph7xoO/VVbHrmo/bslDrZHPkTz2IH5Lf3ZuBuEdsfUwlWxU6P4SlqZ4QodZWFbJWpAptMQIoFv5yRJeWgPxv9I+k5SANTW5H3yShb3NAYjQSNfaZY3iCTTtnTNyxr3XbCirW0ffX7SClZ9gaKZwPGy/diEUPMpKAQFgpcQGT1azU8ygKRn3mGHdIVN1sw5n8wNF5L+439eX52if7hLzwfRHoJ/qcNr2LZtqNZJ+WdClmfMxaLHK0ClX719B/b9qkbZJvnXlxojGXgUPu0XeabqNq400c19DC/JkS/Ienp/VjuZlv+HfrYPzxitWMPtdOyalH97/m5SaR7LyaYdmJOqnZSydyLGJP5z0uQQ0JG0LtrHvgRbJ9hUagAEWEsifHxyonebeVWfoU1i5wTtfEtV9wqiOCFGG6vZi+Avob5bTJMJsRPUTyeUxvRCNIz1r+6tGQX/AGZ8bNTDZPUBRAyJfp+RYEK7vgPWk9CXIfKMXKQvyhV20UJra+LXtAjdPjHy9iGY1Hex+wQLrIHp2rhVbLD6IT/0hi8N8/Q==&quot;, 
  &quot;AccessKeyId&quot;: &quot;STS.J2tiLCCGZqATWpvJjjbFoBTds&quot;, 
  &quot;Expiration&quot;: &quot;20180329101149&quot;, 
  &quot;bucketName&quot;: &quot;namibox&quot;, 
  &quot;objectKey&quot;: &quot;vschool/facial&quot;, 
  &quot;endpoint&quot;: &quot;oss-cn-hangzhou.aliyuncs.com&quot;
}</code></pre></table></div><h1>2、APP&amp;WEBVIEW接口</h1><div style="margin-left:20px;"><h2>2.1、backcontrol</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>app点击返回的时候的控制逻辑</li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 “backcontrol”</td>
</tr>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>常量值 “tip_to_quit”</td>
</tr>
<tr>
<td style="text-align: left;">tip</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">object</td>
<td>一些文字信息，如标题等； 示例：{'title':'提醒','text':'确定要返回么？','cancel':'取消' , 'confirm':'确定'}</td>
</tr>
<tr>
<td style="text-align: left;">app_handle</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">boolean</td>
<td>是否由APP处理关闭当前页面的操作。如果否，则客户端不需要关闭当前页面，之传回用户的选择，由页面自己处理关闭当前view</td>
</tr>
</tbody>
</table>
<p><strong>请求示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    'command'   :   'backcontrol',
    'action'    :   'tip_to_quit',
    'tip'       :   {'title':'提醒','text':'确定要放弃该订单么？','cancel':'取消' , confirm:'确定'},
    'app_handle': true/false
}
</code></pre></table>
<p><strong>客户端返回值</strong></p>
<p>app点击发送命令</p>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 “backcontrol_callback”</td>
</tr>
<tr>
<td style="text-align: left;">chooseindex</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>常量值 0或1 （1表示<strong>确定</strong>返回； 0表示<strong>取消</strong>返回）</td>
</tr>
</tbody>
</table>
<ul>
<li>app_handel为true时，客户端不做任何处理，只上报即可 </li>
</ul></div><h2>2.2、menucontrol</h2><div style="margin-left:20px;"><ul>
<li>导航栏右上方按钮定义（4.2新增左上方按钮定义）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>menucontrol</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">menu_action</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">否</td>
<td></td>
<td>按钮数组</td>
</tr>
<tr>
<td style="text-align: left;">left_action</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">否</td>
<td></td>
<td>按钮数组</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>备注：最多支持两个按钮</p>
</li>
<li>menu_action、left_action定义</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>hide/show</td>
</tr>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>支持4种固定id：（1）刷新 10010 （2）分享10011 （3）打开设置10012 （4）签到 10013  （5）二维码10014 （6）展开+10015，以上是固定id样式固定，不受web控制，另外web可以自定义id，以下样式只针对自定义id</td>
</tr>
<tr>
<td style="text-align: left;">image</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>图标（如果能够取到图标，则以下设置不生效），<em>4.2+版本支持该字段为url，首次只在线请求，下次生效，黑色为主   </em></td>
</tr>
<tr>
<td style="text-align: left;">selectimage</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>图标（如果能够取到图标，则以下设置不生效），<em>4.2+版本支持该字段为url，首次只在线请求，下次生效，白色为主   </em></td>
</tr>
<tr>
<td style="text-align: left;">name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>按钮名称</td>
</tr>
<tr>
<td style="text-align: left;">foregroundcolor</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>#333333</td>
<td>文字颜色</td>
</tr>
<tr>
<td style="text-align: left;">strokeStyle</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">否</td>
<td>false</td>
<td>按钮是否有描边</td>
</tr>
<tr>
<td style="text-align: left;">backgroundcolor</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>#333333</td>
<td>按钮背景色，如果strokeStyle为true，则为描边颜色</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：（1）menucontrol在fullscreen_no_title模式下无效    （2）menucontrol_control在fullscreen模式下，文字颜色和背景颜色设置的是导航栏展示时的颜色，导航栏隐藏时默认都是白色  （3）4种固定id的按钮样式不受web控制  （4）为了兼容老的版本，在image字段有的时候也要传值name等属性，如果客户端能够取到image则图标显示，否则文字显示  （5）图标显示时，foregroundcolor、backgroundcolor、strokeStyle等设置不生效   （6）目前支持的image有：收藏文章、取消收藏  （7）图标尺寸大小为72x72，实际显示内容为48x48（8）image保存在app_cache目录下，层级结构如下：
<img src="http://bbs.namibox.com:5555/Public/Uploads/2017-07-11/596495352146f.png" alt="" />
（8）4.2之后的image不限于在app_cache下，可以实时在线更新，4.2新增left_action，4.2支持selectimage以支持导航栏两种样式的展示</li>
</ul></div><h2>2.3、打开页面</h2><div style="margin-left:20px;"><ul>
<li>打开页面openview</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>openview</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>webview的url</td>
</tr>
<tr>
<td style="text-align: left;">template</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td>normal或该字段不传</td>
<td>指定模式打开（video、audio、fullscreen、fullscreen_notitle，normal或该字段不传，search（4.0+支持））</td>
</tr>
<tr>
<td style="text-align: left;">template_ratio</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">是</td>
<td>1.78</td>
<td>宽高比(16/9)，不传默认以16：9的比例</td>
</tr>
<tr>
<td style="text-align: left;">view_name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>web名称</td>
</tr>
<tr>
<td style="text-align: left;">keeplight</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">是</td>
<td>false</td>
<td>是否保持屏幕常亮</td>
</tr>
<tr>
<td style="text-align: left;">tabs</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">是</td>
<td></td>
<td>tab模式（3.0.7+支持）</td>
</tr>
</tbody>
</table>
<ul>
<li>template说明</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>template</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>video</td>
<td>导航栏隐藏，上部是原生video（默认宽高比16：9），下面是webview</td>
</tr>
<tr>
<td>audio</td>
<td>上部原生audio，下部webview</td>
</tr>
<tr>
<td>fullscreen</td>
<td>导航栏随着webview的滚动自动隐藏和显示，支持[menucontrol](<a href="http://bbs.namibox.com:5555/index.php?s=/1&page_id=42">http://bbs.namibox.com:5555/index.php?s=/1&page_id=42</a> "menucontrol")</td>
</tr>
<tr>
<td>fullscreen_notiltle</td>
<td>导航栏隐藏，默认带返回箭头，页面可发消息隐藏或显示， 可控制状态栏内容颜色（深色或浅色）</td>
</tr>
<tr>
<td>search</td>
<td>同fullscreen模式，支持导航栏随web滚动自动隐藏与展示，导航栏中间显示searchbar</td>
</tr>
<tr>
<td>normal</td>
<td>导航栏一直显示，支持[menucontrol](<a href="http://bbs.namibox.com:5555/index.php?s=/1&page_id=42">http://bbs.namibox.com:5555/index.php?s=/1&page_id=42</a> "menucontrol")</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>备注：
（1）tab模式下，template、URL、view_name设置无效
（2）template_ratio只有在template是video模式下设置才有意义
（3）template可以不传，默认是normal模式
（4）search模式下，导航栏渐变，不显示title，显示searchbar
（5）除了tab模式，其他模式均支持url拼接 app_template模式打开
（6）video，audio模式下，被打开的页面需要上传[viedo](<a href="http://bbs.namibox.com:5555/index.php?s=/1&page_id=33">http://bbs.namibox.com:5555/index.php?s=/1&page_id=33</a> "viedo")命令
（7）search模式下，被打开页面需要上传searchcontrol命令</p>
</li>
<li>tab模式下的数据结构</li>
</ul>
<table width='100%' class='codestyle'><pre><code>  {
       &quot;items&quot;: [{
          &quot;view_name&quot;: &quot;&quot;,
          &quot;title&quot;: &quot;历史播放&quot;,
          &quot;url&quot;: &quot;https://xxx.com&quot;
         },
        {
          &quot;view_name&quot;: &quot;&quot;,
          &quot;title&quot;: &quot;当前播放&quot;,
          &quot;url&quot;: &quot;https://xxx.com&quot;
     }
    ]
    &quot;selectindex&quot;:0     #从0开始
  }</code></pre></table>
<ul>
<li>search模式下，页面在ready后发送searchcontroll所必备的消息（web->app4.0+支持）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>searchcontrol</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>点击搜索框打开的页面</td>
</tr>
<tr>
<td style="text-align: left;">placeholder</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>搜索框显示的热词</td>
</tr>
</tbody>
</table>
<ul>
<li><code>fullscreen_notiltle</code>模式下，页面发送<code>backshowcontrol</code>命令隐藏或显示返回箭头(默认显示)，发送<code>statusbarcontrol</code>命令控制状态栏内容颜色（深色或浅色，默认浅色），页面刷新或重载时重置返回箭头和状态栏内容颜色的状态为默认状态（<strong>app4.0以上支持</strong>）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>backshowcontrol</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">show</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">是</td>
<td>false</td>
<td>是否显示返回箭头</td>
</tr>
</tbody>
</table>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>statusbarcontrol</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">dark</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">是</td>
<td>false</td>
<td>true表示深色样式</td>
</tr>
</tbody>
</table></div><h2>2.4、设置推送标签</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>设置推送标签</li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 “set_push_tag”</td>
</tr>
<tr>
<td style="text-align: left;">push_tags</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">数组</td>
<td>推送标签的数组,为空表示只触发app设置tag,不设置新的tag</td>
</tr>
<tr>
<td style="text-align: left;">tag_key</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>tag的key</td>
</tr>
<tr>
<td style="text-align: left;">tag_value</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>tag的值,不传或者传空字符串表示删除当前key对应的tag</td>
</tr>
<tr>
<td style="text-align: left;">relate_user</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">boolean</td>
<td>是否关联用户,关联用户的tag app会在退出登录时自动删除</td>
</tr>
</tbody>
</table>
<p><strong>请求示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;command&quot;: &quot;set_push_tag&quot;,
    &quot;push_tags&quot;: [{                   //tag数组
      &quot;tag_key&quot;: &quot;key&quot;,             //tag的key
      &quot;tag_value&quot;: &quot;value&quot;,         //tag的值
      &quot;relate_user&quot;: true/false,  //是否关联用户,关联用户的tag app会在退出登录时自动删除
    },...]
  }</code></pre></table>
<p><strong>备注</strong> </p>
<ul>
<li>推送设置tag只设置tag_value,tag_key是用来更新本地存储tag的依据</li>
<li>之前本地获取到地理位置信息的tag为用户无关</li>
<li>relate_user为true的tag应当只在用户登录的情况下设置</li>
<li>之前传过的TAG,下一次没传,设置tag时还是会带上</li>
<li>客户端使用了"NATIVE_TAG_PROVINCE","NATIVE_TAG_PROVINCE_CITY"两个key,iOS和android需保持一致,且页面不能传这两个tag_key</li>
<li>页面需要传性别字段"tag_key":"sex","tag_value": "男/女","relate_user": true</li>
<li>个推文档中说一天只能成功设置一次tag,所以设置tag最好在五大页面一次性设置全部tag,多次设置tag android端会在第二天设置tag时生效</li>
</ul>
<p><strong>标签示例</strong>
[
{
"tag_key": "province",
"tag_value": "上海市",
"relate_user": true
},
{
"tag_key": "city",
"tag_value": "上海市",
"relate_user": true
},
{
"tag_key": "district",
"tag_value": "虹口区",
"relate_user": true
},
{
"tag_key": "school_id",
"tag_value": "10029",
"relate_user": true
},
{
"tag_key": "grade",
"tag_value": "三年级",
"relate_user": true
},
{
"tag_key": "class_no",
"tag_value": "5班",
"relate_user": true
}
]</p></div><h2>2.5、APP在微课观看过程中的评测</h2><div style="margin-left:20px;"><p>一、完整度
定义：
（1）播放器的连续播放时间
（2）拖动进度条不计入播放时间</p>
<p>实现规则：监听视频播放和暂停的状态
（1）每次播放时插入（或取出）一个时间节点，如果是插入的则设置该节点的起始时间
（2）每次暂停时判断当前节点的结束时间是否小于当前播放时间，如果小于则设置节点结束时间为当前播放时间</p>
<p>注意：拖动进度条时，在拖拽结束时设置上一节点的结束时间，seek完成后设置当前节点的开始时间</p>
<p>二、认真度
face++检测开启的情况下
（1）人脸有无的判断：播放过程中 检测到人脸的次数/检测过程中总的回调次数，
（2）观看姿势的判断：播放过程中 检测到正常观看姿势的次数/检测过程中总的回调次数</p>
<ul>
<li>web向app查询face++检测数据（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>query_study_state</td>
<td>查询观看状态</td>
</tr>
</tbody>
</table>
<p>返回信息：</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>post_study_state</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">switchon</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">否</td>
<td>false</td>
<td>是否开启face++检测</td>
</tr>
<tr>
<td style="text-align: left;">reason</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>1、摄像头权限未打开 2、用户未开启 3、设备温度太高 4、页面没有开启face++</td>
</tr>
<tr>
<td style="text-align: left;">integrity</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">否</td>
<td>0.61</td>
<td>观看完成度（取值0~1浮点，精确到小数点后两位）</td>
</tr>
<tr>
<td style="text-align: left;">userpresent</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">否</td>
<td>0.51</td>
<td>是否检测到人脸（取值0~1浮点，精确到小数点后两位 ）</td>
</tr>
<tr>
<td style="text-align: left;">focus</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>正确姿势观看视频取值0~1浮点，精确到小数点后两位 ）</td>
</tr>
</tbody>
</table>
<ul>
<li>备注1：在switchon为true时，userpresent、focus值设置有效； switchon为false时，reason值设置有效。integrity一直有效。</li>
</ul></div><h2>2.6、个验、移动验证</h2><div style="margin-left:20px;"><h2>个验</h2>
<h2></h2>
<h2>介绍</h2>
<p>通过个验sdk校验用户输入的手机号是否是当前设备的常用手机号,以验证用户身份</p>
<h2>优点</h2>
<ul>
<li>减少短信发送量</li>
<li>缩短用户注册路径  </li>
</ul>
<h2>使用场景</h2>
<p>原有需要短信验证码的场景,</p>
<ul>
<li>用户注册</li>
<li>修改密码</li>
<li>盒币支付 </li>
<li>修改用户手机号(不建议使用个验)</li>
</ul>
<h2>简单流程</h2>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-10-16/59e472f518a8b.png" alt="" /></p>
<h2>例子</h2>
<h3>注册/忘记密码</h3>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-10-16/59e451f149e77.png" alt="" /></p>
<h3>修改密码</h3>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-10-16/59e471e43aee2.png" alt="" /></p>
<h3>盒币支付</h3>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-10-16/59e471ff20082.png" alt="" /></p>
<h2>接口</h2>
<ul>
<li>
<p>将手机号传给客户端</p>
<table width='100%' class='codestyle'><pre><code>{ 
 &quot;command&quot; : &quot;geyan_vertify&quot;, 
 &quot;phoneNum&quot; : &quot;&quot; ,
  &quot;vertify_time&quot; : 3//校验的超时时间：秒,不传为默认为3，&lt;0无超时
} 
</code></pre></table>
</li>
<li>
<p>客户端响应校验结果(3s没结果返回校验失败)</p>
<table width='100%' class='codestyle'><pre><code>{ 
 &quot;command&quot; : &quot;geyan_vertify_result&quot;, 
 &quot;vertify_pass&quot; : true/false,
 &quot;content &quot;:&quot;jsonstring&quot;//个验校验后返回的结果 转换成json字符串
} 
</code></pre></table>
<h1>------------------------------</h1>
<h2>移动验证</h2>
<h2></h2>
<h2>接口</h2>
<p>*页面调用客户端</p>
<table width='100%' class='codestyle'><pre><code>{
&quot;command&quot;:&quot;cmcc_vertify&quot;,
&quot;vertify_time&quot; : 10//校验的超时时间：秒,不传为默认为10，&lt;0无超时
}</code></pre></table>
<h2>客户端返回校验结果</h2>
<table width='100%' class='codestyle'><pre><code>{
&quot;command&quot;:&quot;cmcc_vertify_result&quot;,
&quot;vertify_pass&quot; : true/false,
&quot;content &quot;:&quot;jsonstring&quot;//移动校验后返回的结果 转换成json字符串
}</code></pre></table>
</li>
</ul></div><h2>2.1、支付</h2><div style="margin-left:20px;"><h3>2.1.1、支付通知</h3><div style="margin-left:30px;"><p>支付成功后web向app发送以下通知：</p>
<table width='100%' class='codestyle'><pre><code>js_app_send({'command': 'paysuccess',
            'product_id': objs[i]['product_id'],
            'bookid' : objs[i]['book_id'],
            'sdkid'  : objs[i]['sdk_id'],
            'type'   : objs[i]['type']
            });</code></pre></table>
<p>其中bookid, sdkid, type字段只有在点读类商品购买成功后才会有效，其它类商品的这些字段值是null。</p></div><h3>2.1.2、Apple Pay</h3><div style="margin-left:30px;"><ul>
<li>判断是否支持Apple Pay
IOS App 4.2 版本以下不支持
IOS APP 4.2 版本及以上通过查询客户端，判断设备是否支持Apple Pay
（支持applepay支付的需要是系统8.0以上，同时已经绑定了银行卡的设备）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>query_support_pay</td>
<td>查询当前设备支持的支付方式</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;alipay&quot;: true,
     &quot;wxpay&quot;: true,
     &quot;iapay&quot;: false,
     &quot;applepay&quot;: true,
  }</code></pre></table>
<ul>
<li>使用Apple Pay进行支付（仅限IOS）web->app</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>applepay</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">paydata</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">否</td>
<td></td>
<td>订单信息</td>
</tr>
<tr>
<td style="text-align: left;">mode</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>00</td>
<td>接入模式，标识商户以何种方式调用支付控件,00生产环境，01测试环境</td>
</tr>
</tbody>
</table>
<ul>
<li>Apple Pay支付回调（app-web）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>applepay_result</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">return_code</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>0000 支付成功</td>
</tr>
<tr>
<td style="text-align: left;">description</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>返回结果描述</td>
</tr>
</tbody>
</table>
<ul>
<li>return_code说明</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">0000</td>
<td style="text-align: left;">成功</td>
</tr>
<tr>
<td style="text-align: left;">9801</td>
<td style="text-align: left;">客户端网络连接错误</td>
</tr>
<tr>
<td style="text-align: left;">9802</td>
<td style="text-align: left;">中途退出</td>
</tr>
<tr>
<td style="text-align: left;">9803</td>
<td style="text-align: left;">报文解析错误</td>
</tr>
<tr>
<td style="text-align: left;">9804</td>
<td style="text-align: left;">未知错误(本地配置文件验证失败)</td>
</tr>
<tr>
<td style="text-align: left;">9805</td>
<td style="text-align: left;">调用参数不正确</td>
</tr>
<tr>
<td style="text-align: left;">9806</td>
<td style="text-align: left;">支付取消</td>
</tr>
<tr>
<td style="text-align: left;">9807</td>
<td style="text-align: left;">支付过程中用户取消了,请查询后台确认订单</td>
</tr>
<tr>
<td style="text-align: left;">2001</td>
<td style="text-align: left;">通讯错误</td>
</tr>
<tr>
<td style="text-align: left;">2002</td>
<td style="text-align: left;">通讯错误</td>
</tr>
<tr>
<td style="text-align: left;">2003</td>
<td style="text-align: left;">通讯错误</td>
</tr>
<tr>
<td style="text-align: left;">2004</td>
<td style="text-align: left;">订单错误</td>
</tr>
<tr>
<td style="text-align: left;">2005</td>
<td style="text-align: left;">订单错误</td>
</tr>
<tr>
<td style="text-align: left;">2006</td>
<td style="text-align: left;">系统异常</td>
</tr>
<tr>
<td style="text-align: left;">2007</td>
<td style="text-align: left;">通讯超时</td>
</tr>
<tr>
<td style="text-align: left;">9899</td>
<td style="text-align: left;">系统异常</td>
</tr>
<tr>
<td style="text-align: left;">9002</td>
<td style="text-align: left;">银行卡验证失败</td>
</tr>
<tr>
<td style="text-align: left;">9999</td>
<td style="text-align: left;">认证失败, 请稍后重试</td>
</tr>
<tr>
<td style="text-align: left;">9900</td>
<td style="text-align: left;">认证失败，请联系发卡行</td>
</tr>
<tr>
<td style="text-align: left;">9901</td>
<td style="text-align: left;">无效的发卡行</td>
</tr>
<tr>
<td style="text-align: left;">9902</td>
<td style="text-align: left;">无效交易</td>
</tr>
<tr>
<td style="text-align: left;">9903</td>
<td style="text-align: left;">无效金额</td>
</tr>
<tr>
<td style="text-align: left;">9904</td>
<td style="text-align: left;">无效卡号</td>
</tr>
<tr>
<td style="text-align: left;">9905</td>
<td style="text-align: left;">客户取消交易</td>
</tr>
<tr>
<td style="text-align: left;">9906</td>
<td style="text-align: left;">无效交易响应</td>
</tr>
<tr>
<td style="text-align: left;">9907</td>
<td style="text-align: left;">此卡已过期</td>
</tr>
<tr>
<td style="text-align: left;">9908</td>
<td style="text-align: left;">密码错误</td>
</tr>
<tr>
<td style="text-align: left;">9909</td>
<td style="text-align: left;">余额不足</td>
</tr>
<tr>
<td style="text-align: left;">9910</td>
<td style="text-align: left;">未开通此功能</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：无</li>
</ul></div><h3>2.1.3、支付宝支付</h3><div style="margin-left:30px;"><ul>
<li>支付宝支付（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>alipay</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">paydata</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">否</td>
<td></td>
<td>支付信息{"order_info":"订单信息","return_url":"回调url"}</td>
</tr>
</tbody>
</table>
<ul>
<li>支付宝支付回调（app->web）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>alipay_result</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">return_code</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>回调code</td>
</tr>
<tr>
<td style="text-align: left;">description</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>返回结果描述</td>
</tr>
<tr>
<td style="text-align: left;">return_url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>透传支付传来的return_url</td>
</tr>
</tbody>
</table></div><h3>2.1.4、微信支付</h3><div style="margin-left:30px;"><ul>
<li>微信支付（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>wxpayReq</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">payreq</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">否</td>
<td></td>
<td>支付携带的信息</td>
</tr>
</tbody>
</table>
<ul>
<li>payreq描述</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">return_url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>wxpayReq</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">noncestr</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>支付携带的信息</td>
</tr>
<tr>
<td style="text-align: left;">package</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>商家根据财付通文档填写的数据和签名</td>
</tr>
<tr>
<td style="text-align: left;">partnerid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>商家向财付通申请的商家id</td>
</tr>
<tr>
<td style="text-align: left;">prepayid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>预支付订单</td>
</tr>
<tr>
<td style="text-align: left;">noncestr</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>随机串，防重发</td>
</tr>
<tr>
<td style="text-align: left;">timestamp</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">否</td>
<td></td>
<td>时间戳，防重发</td>
</tr>
<tr>
<td style="text-align: left;">sign</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>商家根据微信开放平台文档对数据做的签名</td>
</tr>
</tbody>
</table>
<ul>
<li>微信支付回调（app->web）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>wxpayRsp</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">return_code</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>0成功  ，  -1普通错误类型  ，-2用户点击取消并返回 ，-3发送失败 ， -4 授权失败，  -5 微信不支持，9999 未安装微信客户端</td>
</tr>
<tr>
<td style="text-align: left;">description</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>返回结果描述</td>
</tr>
<tr>
<td style="text-align: left;">return_url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>透传支付传来的return_url</td>
</tr>
</tbody>
</table></div></div><h2>2.2、直播</h2><div style="margin-left:20px;"><h3>2.2.1、发起直播/观看直播</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>观看/发起直播</li>
</ul>
<p><strong>注意：</strong></p>
<ul>
<li>观看、发起直播共享接口，通过 "join_permission" 来判断是观众还是主播身份</li>
</ul>
<p><strong>请求方向：</strong></p>
<ul>
<li>webview --> app</li>
</ul>
<p><strong>请求示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;command&quot; : &quot;app_action&quot;, 
     &quot;name&quot; : &quot;openlive&quot;, 
     &quot;domain&quot; : &quot;nami.gensee.com&quot;, 
     &quot;service_type&quot; : &quot;webcast&quot;, 
     &quot;head_img&quot;: &quot;xxxx.jpg&quot;, 
     &quot;webcast_id&quot; : &quot;0fdf1424df9349b3b16dcdaf8ba4ccb5&quot;, 
     &quot;presenter_nick&quot;: &quot;主播昵称&quot;,
     &quot;nick_name&quot; : &quot;观看者昵称&quot;, 
     &quot;watch_password&quot; : &quot;123456&quot;, 
     &quot;room_number&quot; : &quot;123&quot;,
     &quot;time_limit&quot;: &quot;600&quot;,
     &quot;result_page&quot;: &quot;xxxxx&quot;, 
     &quot;join_permission&quot;: &quot;watch&quot;,
     &quot;resolution&quot;: &quot;480&quot;,
     &quot;wx_share&quot;: {
            &quot;share_content&quot; = &quot;\U4f60pwtwwppwwpwwpwpw...&quot;;
            &quot;share_friend&quot; = &quot;\U7eb3\U7c73\U76d2\U6210\U957f\U5708\Uff1a\U4f60pwtwwppwwpwwpwpw...&quot;;
            &quot;share_title&quot; = &quot;\U7eb3\U7c73\U76d2\U6210\U957f\U5708&quot;;
            &quot;url_image&quot; = &quot;https://wr.namibox.com/tina/static/logo-gray.png&quot;;
            &quot;url_link&quot; = &quot;https://w.namibox.com/diary/comment/1737618?x=mLovgAAAAADY&quot;;
},
    &quot;class_share&quot;: &quot;http://baidu.com&quot;,
    &quot;shareable&quot;: &quot;true&quot;
 } 
</code></pre></table>
<p><strong>请求方式：</strong></p>
<ul>
<li>json 传参</li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 "app_action"</td>
</tr>
<tr>
<td style="text-align: left;">name</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令名，常量值 "openlive"</td>
</tr>
<tr>
<td style="text-align: left;">domain</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>直播所在站点的域名</td>
</tr>
<tr>
<td style="text-align: left;">service_type</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>服务类型</td>
</tr>
<tr>
<td style="text-align: left;">webcast_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>直播id</td>
</tr>
<tr>
<td style="text-align: left;">nick_name</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>昵称</td>
</tr>
<tr>
<td style="text-align: left;">watch_password</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>观看密码</td>
</tr>
<tr>
<td style="text-align: left;">room_number</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>房间号</td>
</tr>
<tr>
<td style="text-align: left;">join_permission</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>以何种身份进入房间（即发起直播还是观看直播）： watch 为观看直播；broadcast 为发起直播</td>
</tr>
<tr>
<td style="text-align: left;">wx_share</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>微信分享</td>
</tr>
<tr>
<td style="text-align: left;">result_page</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>直播结束页，仅观看直播时传此参数</td>
</tr>
<tr>
<td style="text-align: left;">class_share</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>分享至其他班级的链接</td>
</tr>
<tr>
<td style="text-align: left;">resolution</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>720 为 1280 <em> 720 分辨率, 480 为 640 </em> 480 分辨率</td>
</tr>
<tr>
<td style="text-align: left;">time_limit</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>当前直播的时长限制（单位：秒）。无此参数时无限制，有此参数时则该直播超过此时长时自动关闭</td>
</tr>
<tr>
<td style="text-align: left;">shareable</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>true/false，观看直播的用户如果该参数为 true，则可进行分享</td>
</tr>
</tbody>
</table>
<p><strong> 结束页面，直播观看人数 </strong>
result_page 的 url 后添加 "&watch_count=xxx"即可</p></div><h3>2.2.2、观看回放</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>观看回放</li>
</ul>
<p><strong>请求URL：</strong> </p>
<table width='100%' class='codestyle'><pre><code>{
    command = &quot;app_action&quot;;
    domain = &quot;nami.gensee.com&quot;;
    name = openvodlive;
    &quot;nick_name&quot; = &quot;三宝&quot;;
    &quot;head_img&quot; = &quot;xxxx.jpg&quot;;
    &quot;room_number&quot; = 53599168;
    &quot;service_type&quot; = webcast;
    &quot;watch_password&quot; = 088196;
}</code></pre></table>
<p><strong>请求方式：</strong></p>
<ul>
<li>POST </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">nick_name</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>昵称</td>
</tr>
<tr>
<td style="text-align: left;">room_number</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>房间号</td>
</tr>
<tr>
<td style="text-align: left;">watch_password</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>观看密码</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;error_code&quot;: 0,
    &quot;data&quot;: {
      &quot;uid&quot;: &quot;1&quot;,
      &quot;username&quot;: &quot;12154545&quot;,
      &quot;name&quot;: &quot;吴系挂&quot;,
      &quot;groupid&quot;: 2 ,
      &quot;reg_time&quot;: &quot;1436864169&quot;,
      &quot;last_login_time&quot;: &quot;0&quot;,
    }
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">groupid</td>
<td style="text-align: left;">int</td>
<td>用户组id，1：超级管理员；2：普通用户</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong> </p>
<ul>
<li>更多返回错误代码请看首页的错误代码描述</li>
</ul></div><h3>2.2.3、结束直播</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>结束直播所需操作</li>
</ul>
<p><strong>参数：</strong> </p>
<p>为了保证直播发起端结束直播时状态及时更新，请发送广播消息 "broadcast_endcast", 格式</p>
<p>{
"command": "message",
"message": "broadcast_endcast",
"cast_id": "xxxx"
}</p></div></div><h2>2.3、点读</h2><div style="margin-left:20px;"><h3>2.3.1、获取本地已下载书本信息</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>获取本地已下载书本信息</li>
</ul>
<p><strong>请求示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;command&quot; : &quot;getbook&quot;, 
 } 
</code></pre></table>
<p><strong>请求方式：</strong></p>
<ul>
<li>json 传参</li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 "getbook"</td>
</tr>
</tbody>
</table>
<p><strong>返回示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> [ { 
     &quot;bookid&quot;  : &quot;tape1b_002001&quot;, 
     &quot;bookname&quot;:&quot;英语（外研版一年级起点）&quot;，
     &quot;icon&quot;    : &quot;https://wr.namibox.com/tina/static/d/tape2a/002002_英语（新起点）/title.jpg?20160705160833&quot;,
    &quot;grade&quot;     :&quot;一年级下&quot;，
    &quot;charge&quot;    :true，
    &quot;category&quot;  :&quot;课本&quot;，
    &quot;status&quot;:1,课本下载状态（4.2新增）
    &quot;booktype&quot;  : &quot;0&quot;
   },
   { 
      &quot;bookid&quot;  : &quot;tape1b_002001&quot;, 
     &quot;bookname&quot;:&quot;英语（外研版一年级起点）&quot;，
     &quot;icon&quot;    : &quot;https://wr.namibox.com/tina/static/d/tape2a/002002_英语（新起点）/title.jpg?20160705160833&quot;,
    &quot;grade&quot;     :&quot;一年级下&quot;，
    &quot;charge&quot;    :true，
    &quot;category&quot;  :&quot;课本&quot;，
    &quot;status&quot;:1,课本下载状态（4.2新增）
    &quot;booktype&quot;  : &quot;1&quot;
   },
 ] 
</code></pre></table>
<p><strong>返回参数说明：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书本id</td>
</tr>
<tr>
<td style="text-align: left;">bookname</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书本名称</td>
</tr>
<tr>
<td style="text-align: left;">grade</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>年级</td>
</tr>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书本封面</td>
</tr>
<tr>
<td style="text-align: left;">charge</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">boolean</td>
<td>是否付费书</td>
</tr>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>课本、非标课本、配套课本教辅、课外教辅、非标课本配套教辅</td>
</tr>
<tr>
<td style="text-align: left;">booktype</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书本类型 0：教科书 1：教辅书</td>
</tr>
<tr>
<td style="text-align: left;">status</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书本状态 0:未下载、1:下载完成 2：进行中 3：暂停 4：失败 5：删除（4.2新增，4.2以下默认不传表示下载完成）</td>
</tr>
</tbody>
</table></div><h3>2.3.2、APP通知页面书本状态</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>APP通知页面书本状态(广播消息)</li>
</ul>
<p><strong>请求示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;command&quot; : &quot;notify_book&quot;, 
     &quot;msg&quot; : [{
                &quot;bookid&quot;:&quot;tape1b_002001&quot;,
                &quot;status&quot; : &quot;2&quot;,
                &quot;rate&quot; : 20
               },
               {
                &quot;bookid&quot;:&quot;tape1b_002001&quot;,
                &quot;status&quot; :&quot;1&quot;
                &quot;rate&quot; : 0
               }] 

 } 
</code></pre></table>
<p><strong>请求方式：</strong></p>
<ul>
<li>json 传参</li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 "notify_book"</td>
</tr>
<tr>
<td style="text-align: left;">msg</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">list</td>
<td>包含本书</td>
</tr>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书本Id</td>
</tr>
<tr>
<td style="text-align: left;">status</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>状态：0:未下载、1:下载完成 2：进行中 3：暂停 4：失败  5：删除</td>
</tr>
<tr>
<td style="text-align: left;">rate</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>下载进度0-100</td>
</tr>
</tbody>
</table></div><h3>2.3.3、打开点读</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>打开点读列表（支持书架列表和我的书本管理）</li>
</ul>
<p><strong>请求示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;command&quot; : &quot;app_action&quot;, 
     &quot;name&quot; : &quot;tape&quot;, 
     &quot;type&quot; : &quot;schoolbook&quot;
 } 
</code></pre></table>
<p><strong>请求方式：</strong></p>
<ul>
<li>json 传参</li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 "app_action"</td>
</tr>
<tr>
<td style="text-align: left;">name</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令名，常量值 "tape"</td>
</tr>
<tr>
<td style="text-align: left;">type</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>类型；schoolbook :教科书，mybook：我的书包括订购和下载 ，referencebook：教辅书</td>
</tr>
</tbody>
</table>
<ul>
<li>openclickread打开点读课本</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>openclickread</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>tape_1a_001</td>
<td>书本id</td>
</tr>
<tr>
<td style="text-align: left;">experience</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">否</td>
<td>ture</td>
<td>是否是体验模式</td>
</tr>
<tr>
<td style="text-align: left;">oral_test_ready</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">否</td>
<td>false</td>
<td>是否支持口语评测</td>
</tr>
<tr>
<td style="text-align: left;">product_id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>评测产品id</td>
</tr>
<tr>
<td style="text-align: left;">oral_request_url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>口语评测数据请求地址</td>
</tr>
<tr>
<td style="text-align: left;">alert_info</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">是</td>
<td></td>
<td>拓展信息</td>
</tr>
</tbody>
</table>
<p>alert_info 描述：（免费书的显示格式）</p>
<table width='100%' class='codestyle'><pre><code>  {
      &quot;isfree&quot;: &quot;true&quot;,
      &quot;content&quot;: &quot;该电子课本由出版机构正版授权，纳米盒为您承担了版权费用，您可以免费使用！&quot;,
      &quot;share_content&quot;: &quot;好东西不能一人独享，推荐给好友赢取微课堂10元通用优惠券！&quot;,
      &quot;okbt&quot;:&quot;朕已阅，感谢爱卿&quot;
      &quot;share_url&quot;:&quot;https://namibox.com/share_book?bookid=tape1a_0001&quot;,//分享成功后的请求地址
      &quot;wxshare&quot;: {},
  }</code></pre></table>
<p>分享成功后客户端发送分享成功的请求给后端,确定是否弹窗获得优惠券信息，接口详见下面分享成功后的api请求</p>
<hr />
<p>收费书的显示格式</p>
<table width='100%' class='codestyle'><pre><code>  {
      &quot;isfree&quot;: &quot;false&quot;,
      &quot;title&quot;: &quot;您已体验完毕&quot;,
      &quot;content&quot;: &quot;该电子课本由出版机构正版授权，完整使用需要付费订购，感谢你对版权的尊重&quot;,
      &quot;order_title&quot;:&quot;20元/6月&quot;,
      &quot;order_num&quot;:&quot;已有567890人订购&quot;,
      &quot;icon_desc&quot;:(icon_url1,iconurl2,iconurl3)  //20元=🍔=超有营养的6个月正版点读课本
}</code></pre></table>
<hr />
<p><strong>简要描述：</strong> </p>
<ul>
<li>分享成功后的api请求</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://namibox.com/share_book?bookid=tape1a_0001</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书本名称</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;error_code&quot;: 0,
    &quot;data&quot;: {
      &quot;content&quot;: &quot;分享成功！恭喜您获得微课堂10元全场通用优惠券！&quot;,
      &quot;use_url&quot;:&quot;https:xxx&quot;,//去使用的url地址
    }
  }</code></pre></table></div><h3>2.3.4、打开定时播放</h3><div style="margin-left:30px;"><ul>
<li>打开定时播放</li>
</ul>
<p>请求示例：
{"command":"app_action","name":"openclock","bookid":"tape1a_0001"}</p>
<p>参数：</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td>app_action</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td>openclock</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>课本id</td>
</tr>
</tbody>
</table></div></div><h2>2.4、贴图秀</h2><div style="margin-left:20px;"><h3>2.4.1、图片查看</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>贴图秀图片查看</li>
</ul>
<p><strong>效果图：</strong> </p>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-05-08/590fc374cf3fc.png" alt="" /></p>
<p><strong>请求示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;command&quot; : &quot;view_photos&quot;, 
     &quot;start_pos&quot; : 2, 
     &quot;thumbnail&quot;: [&quot;http://xxxxxxx.jpg&quot;, &quot;http://xxxxxxx.png&quot;, ...],
     &quot;large_pic&quot;: [&quot;http://xxxxxxx.jpg&quot;, &quot;http://xxxxxxx.png&quot;, ...],
     &quot;original_pic&quot;: [&quot;http://xxxxxxx.jpg&quot;, &quot;http://xxxxxxx.png&quot;, ...],
     &quot;head_img&quot;: &quot;http://xxxx&quot;,
     &quot;user_id&quot;: &quot;xxxx&quot;,
     &quot;object_id&quot;: &quot;1735932&quot;,
     &quot;quick_comment_object_type&quot;: &quot;picshow&quot;, 
     &quot;status_bar&quot;: [
     {&quot;name&quot;: &quot;comments&quot;, &quot;count&quot;: 112, &quot;object_type&quot;: &quot;picshow&quot;},
                {&quot;name&quot;: &quot;likes&quot;, &quot;is_like&quot;: False, &quot;count&quot;: 67, &quot;object_type&quot;: &quot;comment&quot;}, 
                 {&quot;name&quot;: &quot;favs&quot;, &quot;is_fav&quot;: False,&quot;fav_type&quot;: &quot;comment&quot;, &quot;object_type&quot;: &quot;picshow&quot;}, , 
     &quot;post_url&quot;: &quot;http://xxxx&quot;, 
 } 
</code></pre></table>
<p><strong>请求方式：</strong></p>
<ul>
<li>json 传参</li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 "view_photos"</td>
</tr>
<tr>
<td style="text-align: left;">start_pos</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>图片的起始位置</td>
</tr>
<tr>
<td style="text-align: left;">thumbnail</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">list</td>
<td>缩略图的地址列表</td>
</tr>
<tr>
<td style="text-align: left;">large_pic</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">list</td>
<td>大图片的地址列表</td>
</tr>
<tr>
<td style="text-align: left;">original_pic</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">list</td>
<td>原图的地址列表</td>
</tr>
<tr>
<td style="text-align: left;">head_img</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">str</td>
<td>头像地址</td>
</tr>
<tr>
<td style="text-align: left;">user_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">str</td>
<td>用户 id （用于点击头像时导向用户空间）</td>
</tr>
<tr>
<td style="text-align: left;">object_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>该贴的 id，注意改参数同时作为采用新旧图片浏览方式的标志，当存在时启用贴图秀的图片滑动浏览方式</td>
</tr>
<tr>
<td style="text-align: left;">quick_comment_object_type</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">str</td>
<td>该字段存在时表示需支持左下快速回复</td>
</tr>
<tr>
<td style="text-align: left;">icons</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">list</td>
<td>图标的显示顺序</td>
</tr>
<tr>
<td style="text-align: left;">post_url</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">str</td>
<td>帖子标题</td>
</tr>
</tbody>
</table>
<p>当 <code>object_id</code> 参数存在时，请前往 <a href="http://doc.namibox.com/index.php?s=/1&page_id=21">http://doc.namibox.com/index.php?s=/1&page_id=21</a> 所提供的的 API 以获取准确的帖子相关信息。</p>
<p><strong> quick_reply (快速评论) </strong>
点击后可进行快速评论</p>
<p><strong> comments (评论) 的点击 API </strong>
点击后打开帖子的原地址 （即为 post_url 所提供的地址）</p>
<p><strong> likes (点赞) 的点击 API </strong>
<strong> favs (收藏) 的点击 API </strong>
<strong> shares (分享) 的点击 API </strong>
示例 url：
<a href="http://x.namibox.com/api/app/set_obj?obj_id=1735932&fav_type=&operater=&obj_type=comment">http://x.namibox.com/api/app/set_obj?obj_id=1735932&fav_type=&operater=&obj_type=comment</a></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">obj_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">str</td>
<td>该评论 id， 即为之前所传入的参数 object_id</td>
</tr>
<tr>
<td style="text-align: left;">fav_type</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">str</td>
<td>收藏所需参数</td>
</tr>
<tr>
<td style="text-align: left;">operater</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">str</td>
<td>操作类型， share: 分享，favorite：收藏，praise：点赞</td>
</tr>
<tr>
<td style="text-align: left;">obj_type</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">str</td>
<td>所传入的 object_type 参数</td>
</tr>
</tbody>
</table>
<p><strong> 点赞的返回示例 </strong>
成功：{'retcode': 'SUCC', 'count_praise': 982}, 其中 <code>count_praise</code> 为该贴当前获得的赞数量。
失败：{'retcode': 'FAIL', 'description': '提交的信息数据不正确', 'errcode': '1002'}, 其中<code>description</code> 为错误信息</p>
<p><strong> 收藏的返回示例 </strong>
成功：{'retcode': 'FAVORITE'} 或者 {'retcode': 'UNFAVORITE'} 表示收藏或者取消收藏成功
失败：{'retcode': 'FAIL', 'description': '提交的信息数据不正确', 'errcode': '1002'}, 其中  <code>description</code> 为错误信息</p>
<p>当未登录时点赞或者收藏的返回错误信息为：
{'retcode': 'FAIL', 'description': '登录后才可以收藏', 'errcode': '1001'}</p></div></div><h2>2.5、口语评测</h2><div style="margin-left:20px;"><h3>2.5.1、评测活动、口语练等</h3><div style="margin-left:30px;"><ul>
<li>口语评测初始化（web->app原口语练接口所需）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>audioscore</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">type</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>paragraph</td>
<td><del>word：英文单词</del>，phrases：短语或单词，paragraph：段落</td>
</tr>
<tr>
<td style="text-align: left;">enginetype</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>offline_cs</td>
<td>online_cs、<del>online_xf</del>（4.0后废弃）、<del>offline_cs</del>（4.0之后废弃，映射到offline_xs）、online_xs、offline_xs、mix_xs</td>
</tr>
<tr>
<td style="text-align: left;">connent</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>评测文本</td>
</tr>
<tr>
<td style="text-align: left;">leftMargin</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>评测uI左边距百分比</td>
</tr>
<tr>
<td style="text-align: left;">topMargin</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>评测uI右边距百分比</td>
</tr>
<tr>
<td style="text-align: left;">widthPercent</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>宽度百分比</td>
</tr>
<tr>
<td style="text-align: left;">heightPercent</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>高度百分比</td>
</tr>
<tr>
<td style="text-align: left;">alpha</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>评测uI透明度</td>
</tr>
<tr>
<td style="text-align: left;">userid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>用户id，用于驰声和先声初始化</td>
</tr>
<tr>
<td style="text-align: left;">coreType</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>cn.sent.score：中文句、段落评测。 cn.word.score：中文单词评测。</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>备注1：新增先声在线、先声离线、先声混合（优先在线、超时或离线会自动切换到离线），同时驰声在线、驰声离线将不再使用，之前老版本对应的驰声在线对应到新版本的先声在线，驰声离线对应新版本的先声离线</p>
</li>
<li>
<p>备注2：关于sysconfig中enginetype在新版本中将废除（之前是应用于跟读，因为4.0的跟读将会废弃，所以这里的设置也已经没有实际意义了）</p>
</li>
<li>备注3：4.1之后type仅支持 phrases 和 paragraph，如果是单词评测也传phrases；离线评测仅支持phrases，在线评测支持 phrases 和 paragraph</li>
</ul>
<hr />
<p>以上是老的接口</p>
<hr />
<hr />
<hr />
<p>以下是新的接口</p>
<hr />
<ul>
<li>初始化评测引擎（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>audioscoreinit</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">type</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>paragraph</td>
<td><del>word：英文单词</del>，phrases：短语，paragraph：段落</td>
</tr>
<tr>
<td style="text-align: left;">enginetype</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>offline_xs</td>
<td>online_cs、online_xf、offline_cs、online_xs、offline_xs、mix_xs</td>
</tr>
</tbody>
</table>
<ul>
<li>评测引擎初始化结果上报（app->web）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>audioscoreresult</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">result</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">否</td>
<td>false</td>
<td>true、false</td>
</tr>
</tbody>
</table>
<ul>
<li>开始录音评测（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>startaudioscore</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">content</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>评测文本</td>
</tr>
</tbody>
</table>
<ul>
<li>结束录音评测（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>endaudioscore</td>
<td>结束录音</td>
</tr>
</tbody>
</table>
<ul>
<li>口语评测上报接口（app->web）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>postaudioscore</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">type</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>en.sent.score\en.pred.exam</td>
<td>分别对应句子（或单词）、段落评测</td>
</tr>
<tr>
<td style="text-align: left;">result_type</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>success\exception\cancel</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">content</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>当前评测的英文内容</td>
</tr>
<tr>
<td style="text-align: left;">score</td>
<td style="text-align: left;">int(11)</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>overall总分</td>
</tr>
<tr>
<td style="text-align: left;">url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>在线评测的音频地址</td>
</tr>
<tr>
<td style="text-align: left;">localpath</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>对应的本地音频地址</td>
</tr>
<tr>
<td style="text-align: left;">detail</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">否</td>
<td>[{word:"a",score:87},{word:book,score:78}]</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">pron</td>
<td style="text-align: left;">int(11)</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>发音标准打分</td>
</tr>
<tr>
<td style="text-align: left;">fluency</td>
<td style="text-align: left;">int(11)</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>流畅度打分</td>
</tr>
<tr>
<td style="text-align: left;">integrity</td>
<td style="text-align: left;">int(11)</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>完整度打分</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>备注：新增加pron、fluency、integrity打分的上报</p>
</li>
<li>上报口语音频接口（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>audioupload</td>
</tr>
<tr>
<td style="text-align: left;">parmers</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">否</td>
<td></td>
<td>上报阿里云所需的数据</td>
</tr>
<tr>
<td style="text-align: left;">localpath</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>指定本地音频路径</td>
</tr>
<tr>
<td style="text-align: left;">activityid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>活动id</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>其中parmers参数如下
{
AccessKeySecret: "XXX",
SecurityToken:"XXXX",
Expiration: "2016-06-16T10:44:19Z",
AccessKeyId: "STS.HxG3GDkaBSnwphwPdRwsNAafX",
'bucketName'  : '',
'objectKey'  : 'fanshow_upload',
'endpoint'  : ''
}</p>
</li>
<li>上报口语音频回调接口（app->web）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>audiouploadresult</td>
</tr>
<tr>
<td style="text-align: left;">result</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">否</td>
<td>true</td>
<td>true、false</td>
</tr>
<tr>
<td style="text-align: left;">activityid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>活动id</td>
</tr>
</tbody>
</table></div><h3>2.5.2、口语评测</h3><div style="margin-left:30px;"><p>之前的点读内部的跟读、口语练将退出历史舞台，新增加课本同步口语评测，入口在课本离线页面和点读评测（之前的跟读）</p>
<ul>
<li>打开评测页（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>open_audio_score</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">type</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>phrases</td>
<td>word：英文单词，phrases：短语，paragraph：段落</td>
</tr>
<tr>
<td style="text-align: left;">enginetype</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td>offline_xs</td>
<td>online_xs、offline_xs、mix_xs</td>
</tr>
<tr>
<td style="text-align: left;">url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>请求的url，全路径</td>
</tr>
<tr>
<td style="text-align: left;">book_id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>书本的 id</td>
</tr>
<tr>
<td style="text-align: left;">page_no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>页码</td>
</tr>
<tr>
<td style="text-align: left;">product_id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>商品id</td>
</tr>
<tr>
<td style="text-align: left;">extra</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>透传的json字符串</td>
</tr>
<tr>
<td style="text-align: left;">pages</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">是</td>
<td></td>
<td>所有页的列表，包含页的url和页数</td>
</tr>
<tr>
<td style="text-align: left;">index</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">是</td>
<td></td>
<td>当前做的是第几页的题(根据index从pages里获取对应页的url)</td>
</tr>
<tr>
<td style="text-align: left;">score_type</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>评测结果展示类型: score 分数, level 等级</td>
</tr>
<tr>
<td style="text-align: left;">match_id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>活动id</td>
</tr>
</tbody>
</table>
<ul>
<li>备注1： type与本地先声的对应关系如下：word：en.word.score  ，phrases：en.sent.score ， paragraph：en.pred.exam   默认未购买用户使用先声离线，已购买用户使用先声混合</li>
<li>备注2： pages里的元素为json格式, 如下所示: {'url': '<a href="http://xxx.com/xxx">http://xxx.com/xxx</a>', 'page_no': x, 'desc_text': 'xxx', 'is_submit': true/false}   其中url为获取当前页题目的接口地址，page_no为当前页的页数， desc_text为提交结果页面的文字描述. is_submit 为本页数据是否已提交过</li>
</ul>
<p><strong>请求URL：</strong> （url为上面传值过来的，url格式参照背单词或速算，在点读页面的入口，url是以bookid和page拼接得来）</p>
<ul>
<li><code>http://xx.com/api/app/get_oral_exercises?book_id=xxx&amp;page=xxx</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>
<p>GET </p>
<p><strong>返回示例</strong></p>
</li>
</ul>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;error_code&quot;: 0,
    &quot;error_desc&quot;: &quot;成功获取评测题目&quot;
    &quot;exercises &quot;:[{},{}], // 练习题列表
    &quot;params &quot;:{
        AccessKeySecret: “XXX”,
        SecurityToken:”XXXX”,
        Expiration: “2016-06-16T10:44:19Z”,
        AccessKeyId: “STS.HxG3GDkaBSnwphwPdRwsNAafX”,
        ‘bucketName’ : ‘’,
        ‘objectKey’ : ‘fanshow_upload’,
        ‘endpoint’ : ‘’
    }
    &quot;userinfo&quot;: {
      &quot;userid&quot;: 12213,
      &quot;enginetype&quot;: &quot;offline_xs&quot;,
      &quot;isbuy&quot;: false,
      &quot;product_id&quot;: xxx, 
      &quot;experience_count&quot;: 99 ,    //专家模式体验次数
      &quot;buy_url&quot;: &quot;https://xxxx&quot;,    //口语评测商品详情页
      &quot;rule_url&quot;: &quot;https://xxxx&quot;,   //口语评测介绍页面
      &quot;join_count&quot;: &quot;8888&quot;,//已经加入专家模式的用户
    }
  }</code></pre></table>
<p><strong>备注</strong>
error_code: 0 为成功 -1 为失败
error_desc: 请求描述（成功或者失败的具体信息）</p>
<p>exerciese的规则参照背单词及口算题目格式</p>
<table width='100%' class='codestyle'><pre><code>{
&quot;id&quot;:&quot;3123&quot;,//题id
&quot;question&quot;:{
    &quot;content&quot;:&quot;Hi, I'm liu tao&quot;,//评测文本
    &quot;content_display&quot;: &quot;Hi, I'm liu tao&quot;, // 评测显示内容
    &quot;audio&quot;:&quot;http://xx.mp3&quot;//原声播放地址
    } 
}</code></pre></table>
<p>用户评测音频上报及评测结果上报</p>
<p>1、阿里云直传音频的几个原则：
（1）需要该页所有内容都评测过
（2）音频上报在评测页面关闭时，提示是否上传，是则显示上传进度
（3）音频上报以队列形式上传
（4）仅wifi下上报
（5）文件命名规则：book_id+page_id+num+timestamp，例如tape001_page1_2_201706281406.mp3 (num 为题目编号)</p>
<p>2、评测数据上报
音频数据全部上传完毕后，api通知后端上报结果</p>
<p><strong>请求URL：</strong> </p>
<ul>
<li>` <a href="http://namibox.com/api/app/postaudioscore">http://namibox.com/api/app/postaudioscore</a></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>POST </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">book_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书本名称</td>
</tr>
<tr>
<td style="text-align: left;">page_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>当前页面</td>
</tr>
<tr>
<td style="text-align: left;">detail</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">array</td>
<td>上报数据</td>
</tr>
<tr>
<td style="text-align: left;">experience_count</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>剩余的体验次数</td>
</tr>
<tr>
<td style="text-align: left;">avg_score</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>平均得分</td>
</tr>
<tr>
<td style="text-align: left;">enginetype</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>offline_xs</td>
</tr>
<tr>
<td style="text-align: left;">extra</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>保留的json透传字段</td>
</tr>
</tbody>
</table>
<p>detail说明：</p>
<table width='100%' class='codestyle'><pre><code>  [{
    &quot;exercise_id&quot;: 23323, // 题目 id
    &quot;pron&quot;:80,  //精准度打分，先声句子评测为accuracy字段，段落评测为pron字段 
    &quot;fluency&quot;:79, //流畅度打分
    &quot;integrity&quot;:34        //完整度打分
    &quot;engine_used&quot;: &quot;mix_xs&quot;, //所用引擎
    &quot;text&quot;: &quot;xxx&quot;, // 朗读文本
    &quot;score&quot;: 90, // 整体分数
    &quot;mp3name&quot;:&quot;tape001_page1_2_201706281406.mp3&quot;, //上报oss的文件名称
  }]</code></pre></table>
<p><strong>备注说明：</strong>  <em>后端只保留最后一次评测数据</em></p>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;error_code&quot;: 0, // 0 为成功， -1 为失败
    &quot;error_desc&quot;: &quot;上报成绩成功！&quot;, // 上报结果描述
    &quot;result_url&quot;: &quot;xxxx&quot;  // 需跳转的结果页面
  }</code></pre></table>
<p><strong>未购买用户购买后的原生页面的刷新:</strong></p>
<p>原生页面跳转到购买页面进行购买操作，页面会发送购买成功的通知([paysuccess](<a href="http://bbs.namibox.com:5555/index.php?s=/1&page_id=3">http://bbs.namibox.com:5555/index.php?s=/1&page_id=3</a> "paysuccess"))，app在收到通知后刷新评测页面（重新请求api接口）</p>
<p><strong>点读进入页面新增 oral_test_ready 字段</strong>
在 'app_action' 的 '[openclickread](<a href="http://bbs.namibox.com:5555/index.php?s=/1&page_id=22">http://bbs.namibox.com:5555/index.php?s=/1&page_id=22</a> "openclickread")' 中新增 'oral_test_ready' 字段：
'0' 表示该书不支持口语评测， '1' 表示该书支持口语评测</p>
<p><strong>点读进入页面新增 oral_request_url 字段</strong>
在 'app_action' 的 '[openclickread](<a href="http://bbs.namibox.com:5555/index.php?s=/1&page_id=22">http://bbs.namibox.com:5555/index.php?s=/1&page_id=22</a> "openclickread")' 中新增 'oral_request_url' 字段</p>
<p>进入点读页面，根据传过来的oral_request_url请求获取有口语评测的页面</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>获取所有可以口语评测页码</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>http://namibox.com/api/get_oral_pages?bookid=tape1a_001</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>
<p>GET </p>
<p><strong>返回示例</strong></p>
</li>
</ul>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;error_code&quot;: 0,
    &quot;data&quot;: [
      &quot;page1&quot;,&quot;page3&quot;,&quot;page4&quot;,&quot;page5&quot;
    ]
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">page</td>
<td style="text-align: left;">string</td>
<td>点读图片对应的page名称</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong>
（1）每次进入课本点读页面，如果该字段有，则静默请求该接口
（2）该接口返回的数据需要保存在本地，以bookid作为key值保存
（3）进入点读课本时，优先加载本地数据，接口返回数据时，更新本地数据</p>
<p><strong>更新专家模式剩余次数：</strong></p>
<ul>
<li>/api/app/update_exp_count?exp_count=xxx</li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">exp_count</td>
<td style="text-align: left;">int</td>
<td>剩余的口语评测次数</td>
</tr>
</tbody>
</table>
<p><strong>先声评测内核类型</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型(String)</th>
<th style="text-align: left;">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">coreType</td>
<td style="text-align: left;">en.word.score</td>
<td style="text-align: left;">英文单词评测(在线或混合模式)online_xs/mix_xs</td>
</tr>
<tr>
<td style="text-align: left;">coreType</td>
<td style="text-align: left;">en.sent.score</td>
<td style="text-align: left;">英文句子评测(在、离线或混合模式)offline_xs/online_xs/mix_xs</td>
</tr>
<tr>
<td style="text-align: left;">coreType</td>
<td style="text-align: left;">en.pred.exam</td>
<td style="text-align: left;">英文段落评测(在线或混合模式)online_xs/mix_xs</td>
</tr>
<tr>
<td style="text-align: left;">coreType</td>
<td style="text-align: left;">cn.word.score</td>
<td style="text-align: left;">中文单词评测(在线模式)online_xs</td>
</tr>
<tr>
<td style="text-align: left;">coreType</td>
<td style="text-align: left;">cn.sent.score</td>
<td style="text-align: left;">中文句、段落评测(在线模式)online_xs</td>
</tr>
</tbody>
</table>
<p><strong>中文评测 评分参考文本，多发音的汉字可以指定一种发音，在汉字后括号内写上发音，如:数(shu3)
可以指定一种发音，在汉字后括号内写上发</strong></p>
<p><strong>评测错误信息后台静默上传</strong>
-/api/app/oral_reviews_error</p>
<p><strong>错误信息参数：</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">device_brand</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">设备品牌</td>
</tr>
<tr>
<td style="text-align: left;">device_model</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">设备型号</td>
</tr>
<tr>
<td style="text-align: left;">userid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">用户id</td>
</tr>
<tr>
<td style="text-align: left;">network</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">网络类型</td>
</tr>
<tr>
<td style="text-align: left;">os_version</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">操作系统</td>
</tr>
<tr>
<td style="text-align: left;">app_version</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">app版本号</td>
</tr>
<tr>
<td style="text-align: left;">channel</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">渠道名</td>
</tr>
<tr>
<td style="text-align: left;">cache_size</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">缓存大小</td>
</tr>
<tr>
<td style="text-align: left;">storage</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">手机剩余存储空间/总空间</td>
</tr>
<tr>
<td style="text-align: left;">memory</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">剩余内存/总内存</td>
</tr>
<tr>
<td style="text-align: left;">page_no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">书本页数</td>
</tr>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">书本id</td>
</tr>
<tr>
<td style="text-align: left;">errcode</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">错误码</td>
</tr>
<tr>
<td style="text-align: left;">errmsg</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">错误信息</td>
</tr>
<tr>
<td style="text-align: left;">time</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">错误产生时间</td>
</tr>
<tr>
<td style="text-align: left;">enginetype</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">引擎类型</td>
</tr>
<tr>
<td style="text-align: left;">coretype</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">评测内核</td>
</tr>
<tr>
<td style="text-align: left;">switchtonative</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">是否切换成离线</td>
</tr>
<tr>
<td style="text-align: left;">isbuy</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">是否购买</td>
</tr>
<tr>
<td style="text-align: left;">isSingEngineInit</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">先声引擎是否初始化完成</td>
</tr>
</tbody>
</table></div><h3>2.5.3、开启录音</h3><div style="margin-left:30px;"><h2>web指定app开启录音（web->app）</h2>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>startrecord</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">activityid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>活动id</td>
</tr>
<tr>
<td style="text-align: left;">maxduration</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">是</td>
<td>0</td>
<td>时间限制，默认不限制，单位秒</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：如果设置了超时，则app最大只允许maxduration的录音时长，录音的话保存在本地，如果上传成功则删除，否则不删除</li>
</ul>
<hr />
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">errorcode</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">是</td>
<td>0</td>
<td>0正常 1错误</td>
</tr>
<tr>
<td style="text-align: left;">errormsg</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>错误描述（未获到取录音权限）</td>
</tr>
</tbody>
</table>
<p>同步返回：</p>
<hr />
<h2>web指定app结束录音（web->app）</h2>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>endrecord</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">activityid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>活动id</td>
</tr>
</tbody>
</table>
<p>同步返回：</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">localpath</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>本地录音文件地址</td>
</tr>
<tr>
<td style="text-align: left;">duration</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">否</td>
<td></td>
<td>本地录音文件时长 （单位s）</td>
</tr>
<tr>
<td style="text-align: left;">errorcode</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>错误id，有则传</td>
</tr>
<tr>
<td style="text-align: left;">errormsg</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>错误描述</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：如果localpath为空，则表示录音失败，如果web指定了录音最大时长，在最大录音时长之前发送了此命令，此时应该关闭app定时录音功能，即下面一个命令不会再发送</li>
</ul>
<hr />
<h2>app主动上报录音结束（app->web）</h2>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>endrecord</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">activityid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>活动id</td>
</tr>
<tr>
<td style="text-align: left;">localpath</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>本地录音文件地址</td>
</tr>
<tr>
<td style="text-align: left;">duration</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">否</td>
<td></td>
<td>本地录音文件时长 （单位s）</td>
</tr>
<tr>
<td style="text-align: left;">errorcode</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>错误id，有则传</td>
</tr>
<tr>
<td style="text-align: left;">errormsg</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>错误描述</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：如果localpath为空，则表示录音失败</li>
</ul></div></div><h2>2.6、视频播放</h2><div style="margin-left:20px;"><h3>2.6.1、视频、音频播放命令</h3><div style="margin-left:30px;"><ul>
<li>全屏播放视频</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>videoplay</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">mp4</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>播放地址</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>标题</td>
</tr>
<tr>
<td style="text-align: left;">auto_play</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">是</td>
<td></td>
<td>自动播放</td>
</tr>
<tr>
<td style="text-align: left;">duration</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>视频时长</td>
</tr>
<tr>
<td style="text-align: left;">size</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>视频长度</td>
</tr>
<tr>
<td style="text-align: left;">hearts_got</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>获取爱心的个数</td>
</tr>
<tr>
<td style="text-align: left;">notify_url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>播放退出前，通知URL</td>
</tr>
</tbody>
</table>
<p><strong>新增duration和size字段</strong>
<strong>新增hearts_got和notify_url字段</strong></p>
<ul>
<li>退出播放前通知</li>
<li>通知地址由全屏播放视频notify_url 字段</li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>POST </li>
</ul>
<p><strong>请求参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">percent</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>播放百分比，范围【0-100】整数（包含0，100）</td>
</tr>
</tbody>
</table>
<p><strong>请求示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {&quot;percent&quot;: 50}</code></pre></table>
<p><strong> 返回示例 </strong></p>
<table width='100%' class='codestyle'><pre><code>  {&quot;retcode&quot;: 'SUCC'}</code></pre></table>
<ul>
<li>播放控制</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>notify_play_info</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">mediatype</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>video</td>
<td>video或audio</td>
</tr>
<tr>
<td style="text-align: left;">auto_play</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">否</td>
<td></td>
<td>用户名</td>
</tr>
<tr>
<td style="text-align: left;">playurl</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>播放地址</td>
</tr>
<tr>
<td style="text-align: left;">seektime</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">是</td>
<td></td>
<td>播放起始点</td>
</tr>
<tr>
<td style="text-align: left;">thumburl</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>封面</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>标题</td>
</tr>
<tr>
<td style="text-align: left;">interrupt</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">否</td>
<td></td>
<td>video模式下的视频中断</td>
</tr>
<tr>
<td style="text-align: left;">duration</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>视频或音频时长</td>
</tr>
<tr>
<td style="text-align: left;">size</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>视频长度</td>
</tr>
<tr>
<td style="text-align: left;"><code>itemid</code></td>
<td style="text-align: left;"><code>string</code></td>
<td style="text-align: left;">否</td>
<td></td>
<td><code>微课id （4.3+，判断视频是否缓存的依据)</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>parentid</code></td>
<td style="text-align: left;"><code>string</code></td>
<td style="text-align: left;">否</td>
<td></td>
<td><code>微课课程ID（4.3+，判断视频是否缓存的依据)</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>changetime</code></td>
<td style="text-align: left;"><code>string</code></td>
<td style="text-align: left;">否</td>
<td></td>
<td><code>（判断视频是否更新的标志)</code></td>
</tr>
</tbody>
</table>
<p><strong>新增duration和size字段</strong></p></div><h3>2.6.2、视频回调上报</h3><div style="margin-left:30px;"><ul>
<li>视频进度上报 （app->web）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>postvideoplay</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">playurl</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>播放地址</td>
</tr>
<tr>
<td style="text-align: left;">duration</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">否</td>
<td></td>
<td>当前播放时间（单位s），上报周期，每10s上报一次</td>
</tr>
<tr>
<td style="text-align: left;">type</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td>mp4</td>
<td>hls或mp4</td>
</tr>
<tr>
<td style="text-align: left;">result</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">否</td>
<td>true</td>
<td>成功或失败，默认成功</td>
</tr>
</tbody>
</table>
<ul>
<li>视频播放完成上报（app->web）4.3+版本支持</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>videoplayend</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">playurl</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>播放地址</td>
</tr>
<tr>
<td style="text-align: left;">duration</td>
<td style="text-align: left;">float</td>
<td style="text-align: left;">否</td>
<td></td>
<td>播放总时长</td>
</tr>
<tr>
<td style="text-align: left;">type</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td>mp4</td>
<td>hls或mp4</td>
</tr>
</tbody>
</table></div></div><h2>2.7、页面关闭</h2><div style="margin-left:20px;"><h3>2.7.1、多级页面关闭</h3><div style="margin-left:30px;"><ul>
<li>新增页面关闭自身及自身以上的所有视图的命令</li>
</ul>
<p>注：该命令是为了解决ios多级关闭动画问题，android保持closeview命令不变</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">closeall</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">view_name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>viewname</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：viewname默认为空，表示关闭当前页面及当前页面以上的所有页面，viewname指定时，关闭viewname及以上的所有页面</li>
</ul></div><h3>2.7.2、关闭单个页面</h3><div style="margin-left:30px;"><ul>
<li>关闭页面</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>closeview</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">view_name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>无</td>
<td>webview的名称，如果为空，关闭自身</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：可以指定关闭页面，如果有view_name为空，则关闭自身</li>
</ul></div></div><h2>2.8、微课视频缓存</h2><div style="margin-left:20px;"><h3>2.8.1、视频下载</h3><div style="margin-left:30px;"><ul>
<li>点击页面下载视频（音频）按钮触发下载命令（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>mediadownload</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">mediatype</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>video</td>
<td>video/audio</td>
</tr>
<tr>
<td style="text-align: left;">playurl</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>播放地址</td>
</tr>
<tr>
<td style="text-align: left;">thumburl</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>封面</td>
</tr>
<tr>
<td style="text-align: left;">size</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>视频大小</td>
</tr>
<tr>
<td style="text-align: left;">duration</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>视频时长</td>
</tr>
<tr>
<td style="text-align: left;">itemid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>微课id（基于此id可以获取到最新的视频地址，详见下面根据微课id获取视频地址接口）</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>微课名称（eg：加偏旁变新字）</td>
</tr>
<tr>
<td style="text-align: left;">subtitle</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>微课描述（eg：带你学习汉字小魔法，一个字加上偏旁会变成新的字哦！）</td>
</tr>
<tr>
<td style="text-align: left;">parentid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>所属课程id</td>
</tr>
<tr>
<td style="text-align: left;">parenttitle</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>所属课程名称（eg：语文错题精讲（1年级上学期））</td>
</tr>
<tr>
<td style="text-align: left;">parentthumb</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>所属课程封面</td>
</tr>
<tr>
<td style="text-align: left;">token</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>视频有效期20171213</td>
</tr>
<tr>
<td style="text-align: left;">buyurl</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>商品详情页</td>
</tr>
<tr>
<td style="text-align: left;">changetime</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>资源更新时间，用于判断资源是否更新的标记201712130908</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>备注：
（1）视频缓存为旁路缓存，视频管理下载时，每次只允许一个任务进行，其他为等待状态
（2）视频播放的地址为私有地址，断点续传时需要先校验地址是否已经过期，如果过期，需要根据itemid获取最新的下载地址
（3）扩展：[notify_play_info](<a href="http://bbs.namibox.com:5555/index.php?s=/1&page_id=33">http://bbs.namibox.com:5555/index.php?s=/1&page_id=33</a> "notify_play_info") 接口在播放音视频时，需要判断本地是否有缓存好的资源，如果有则播放本地资源
（4）视频缓存时，优先判断所属课程的目录是否创建，没有创建则创建，已创建则直接下载到该目录下
（5）缓存的视频支持手动删除操作，但是不能通过清理缓存被清理
（6）缓存的时候在点击观看时需要校验token，查看是否过期，如果过期则不能打开，提示您购买的微课已过期，请续费（打开buyurl）</p>
</li>
<li><strong>根据itemid获取最新下载地址：</strong>  API</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://namibox.com/api/getdownloadurl?itemid=123456&amp;parentid=123456</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET </li>
</ul>
<p><strong>参数（参数必须有一个，如parentid 返回data为数组结构）：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">itemid</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>微课id</td>
</tr>
<tr>
<td style="text-align: left;">parentid</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>微课id</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  // 0表示成功，
  // -1表示微课资源已下架，此时客户端需要有所提示，；如果传入参数是parent,则资源下架的不在返回数组中
  // -3表示请求需要登陆
  // -4表示请求参数有错
  // -5表示需要购买服务
  {
    &quot;retcode&quot;: 0,  
    &quot;error_msg&quot;:&quot;&quot;,
    &quot;data&quot;: [{
      &quot;itemid&quot;: &quot;1&quot;,
      &quot;playurl&quot;:&quot;&quot;,  //微课视频地址
      &quot;thumburl&quot;:&quot;&quot;,//封面
      ......   //其他参数同上面页面发送参数
    }]
  }</code></pre></table>
<h4>&bull;根据itemid, parentid 向客户端请求，获取是否已下载此资源</h4>
<p><strong>web 请求是否有下载此资源（web->app）</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">check_downloadresoure</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">itemid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>微课节点id</td>
</tr>
<tr>
<td style="text-align: left;">parentid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>微课id</td>
</tr>
<tr>
<td style="text-align: left;">changetime</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>微课更新时间</td>
</tr>
</tbody>
</table>
<p>返回</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">itemid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>资源id</td>
</tr>
<tr>
<td style="text-align: left;">parentid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>微课id</td>
</tr>
<tr>
<td style="text-align: left;">isdownload</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>0 未下载， 1下载中， 2已下载</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>js_app_send({'command': 'check_downloadresoure',
            'itemid': 1111,
            'parentid' : 2222,
            'changetime': '201711061244'}
            ,function(data){
                  var itemid = data.itemid;
                  var isdownload = data.isdownload;
                            //$.toJSON(response);
                        }
            });</code></pre></table>
<h4>&bull; 广播下载状态</h4>
<p>{
“command”: “message”,
“message”: “download_srcnotification”,
“itemid”: “xxxx”
“parentid”： "xxxx",
"status": 2 //2已下载
}
message.itemid, message.parentid, downlad_status[message.status]</p></div><h3>2.8.2、打开微课缓存页面</h3><div style="margin-left:30px;"><ul>
<li>打开微课缓存列表页面（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>opencachedir</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>备注：路径：我->离线缓存</p>
</li>
<li>查询微课资源是否已缓存（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>checklocalsource</td>
</tr>
<tr>
<td style="text-align: left;">itemid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>资源id</td>
</tr>
<tr>
<td style="text-align: left;">changetime</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>资源更新时间</td>
</tr>
</tbody>
</table>
<p>返回</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">itemid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>资源id</td>
</tr>
<tr>
<td style="text-align: left;">isdownload</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">否</td>
<td>false</td>
<td>true已下载</td>
</tr>
</tbody>
</table></div></div><h2>2.9、图片上传</h2><div style="margin-left:20px;"><h3>2.9.1、图片上传</h3><div style="margin-left:30px;"><h2>http方式上传</h2>
<ul>
<li>触发消息</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>imgupload</td>
<td>命令</td>
</tr>
<tr>
<td style="text-align: left;">obj_id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>貌似是盒粉秀用到,不用管透传回去</td>
</tr>
<tr>
<td style="text-align: left;">max_upload</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">否</td>
<td></td>
<td>最大上传图片数</td>
</tr>
<tr>
<td style="text-align: left;">width</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">否</td>
<td></td>
<td>缩略图宽</td>
</tr>
<tr>
<td style="text-align: left;">height</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">否</td>
<td></td>
<td>缩略图高</td>
</tr>
<tr>
<td style="text-align: left;">url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>上传地址</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>示例  </p>
<table width='100%' class='codestyle'><pre><code>{
 &quot;command&quot; : &quot;imgupload&quot;,
 &quot;obj_id&quot; : &quot;imgupload&quot;,
 &quot;max_upload&quot; : &quot;9&quot;,
 &quot;width&quot; : &quot;157&quot;,
 &quot;height&quot; : &quot;117&quot;,
 &quot;url&quot; : &quot;https://w.namibox.com/diary/uploadfile?content_type=diary&quot;
}
</code></pre></table>
</li>
<li>上传url响应  </li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">可为空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">errcode</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">否</td>
<td></td>
<td>错误码</td>
</tr>
<tr>
<td style="text-align: left;">errmsg</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>错误描述</td>
</tr>
<tr>
<td style="text-align: left;">img_name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>上报页面的参数</td>
</tr>
<tr>
<td style="text-align: left;">web_url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>上报页面的参数</td>
</tr>
<tr>
<td style="text-align: left;">filesource</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>图片作者</td>
</tr>
<tr>
<td style="text-align: left;">take_time</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>拍摄时间</td>
</tr>
<tr>
<td style="text-align: left;">gpsinfo</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>拍摄地理位置信息</td>
</tr>
<tr>
<td style="text-align: left;">device</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>拍摄设备</td>
</tr>
</tbody>
</table>
<ul>
<li>生成缩略图通知页面消息  </li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>imguploadret</td>
<td>命令</td>
</tr>
<tr>
<td style="text-align: left;">real_url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>base64编码的缩略图</td>
</tr>
<tr>
<td style="text-align: left;">img_name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>上传图片的响应中返回的</td>
</tr>
<tr>
<td style="text-align: left;">web_url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>上传图片的响应中返回的</td>
</tr>
<tr>
<td style="text-align: left;">obj_id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>透传过来的字段</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code> {
     &quot;obj_id&quot; : &quot;imgupload&quot;,
     &quot;web_url&quot; : &quot;http://wf.namibox.com/user/902477/diary/20171012642632_0.jpg?33x33&quot;,
     &quot;img_name&quot; : &quot;/user/902477/diary/20171012642632_0.jpg?33x33@1540&quot;,
     &quot;real_url&quot; : &quot;data:image/jpg;base64,/9j/4AAQSkZJRgABAQA...&quot;, //base64编码的缩略图
     &quot;command&quot; : &quot;imguploadret&quot;
 }
</code></pre></table>
<h2>oss直传</h2>
<ul>
<li>触发消息</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>imgupload</td>
<td>命令</td>
</tr>
<tr>
<td style="text-align: left;">obj_id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>貌似是盒粉秀用到,不用管透传回去</td>
</tr>
<tr>
<td style="text-align: left;">max_upload</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">否</td>
<td></td>
<td>最大上传图片数</td>
</tr>
<tr>
<td style="text-align: left;">width</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">否</td>
<td></td>
<td>缩略图宽</td>
</tr>
<tr>
<td style="text-align: left;">height</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">否</td>
<td></td>
<td>缩略图高</td>
</tr>
<tr>
<td style="text-align: left;">site</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>图片上传域名（g_cdn_upimg）</td>
</tr>
<tr>
<td style="text-align: left;">oss_token</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">否</td>
<td></td>
<td>oss直传token</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>示例  </p>
<table width='100%' class='codestyle'><pre><code>{
 &quot;command&quot; : &quot;imgupload&quot;,
 &quot;obj_id&quot; : &quot;imgupload&quot;,
 &quot;max_upload&quot; : &quot;9&quot;,
 &quot;width&quot; : &quot;157&quot;,
 &quot;height&quot; : &quot;117&quot;,
 &quot;site&quot; : &quot;http://wf.namibox.com&quot;,
 &quot;oss_token&quot; : {
      &quot;endpoint&quot; : &quot;oss-cn-hangzhou.aliyuncs.com&quot;,
      &quot;AccessKeySecret&quot; : &quot;C2ynyN9pFXgGb6nhnUZ2YEn7ourDxWdzLRm38rq44fNK&quot;,
      &quot;objectKey&quot; : &quot;user/902477/works/1687859&quot;, //只传文件夹路径,文件名由客户端生成
      &quot;Expiration&quot; : &quot;2017-10-12T09:07:46Z&quot;,
      &quot;AccessKeyId&quot; : &quot;STS.KBYbMrJYHk4RebrMtEgPnA6D1&quot;,
      &quot;SecurityToken&quot; : &quot;CAISnQJ1q6Ft5B2yfSjIqoHsKffGp...&quot;,
      &quot;bucketName&quot; : &quot;namibox-w&quot;
 }
}
</code></pre></table>
</li>
<li>
<p>文件名规则</p>
<ul>
<li>objectKey中携带文件夹的路径,包含用户id</li>
<li>客户端生成文件名,规则为:时间戳_图片序号.文件格式(eg: 20171012642632_0.jpg)</li>
</ul>
</li>
<li>生成缩略图通知页面消息  </li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">可为空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>imguploadret</td>
<td>命令</td>
</tr>
<tr>
<td style="text-align: left;">real_url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>base64编码的缩略图</td>
</tr>
<tr>
<td style="text-align: left;">img_name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>包含文件名的oss地址</td>
</tr>
<tr>
<td style="text-align: left;">web_url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>包含域名的图片oss地址</td>
</tr>
<tr>
<td style="text-align: left;">obj_id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>透传过来的字段</td>
</tr>
<tr>
<td style="text-align: left;">filesource</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>图片作者</td>
</tr>
<tr>
<td style="text-align: left;">take_time</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>拍摄时间</td>
</tr>
<tr>
<td style="text-align: left;">gpsinfo</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>拍摄地理位置信息</td>
</tr>
<tr>
<td style="text-align: left;">device</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>拍摄设备</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code> {
     &quot;obj_id&quot; : &quot;imgupload&quot;,
     &quot;web_url&quot; : &quot;http://wf.namibox.com/user/902477/diary/20171012642632_0.jpg?33x33&quot;,
     &quot;img_name&quot; : &quot;/user/902477/diary/20171012642632_0.jpg?33x33@1540&quot;,
     &quot;real_url&quot; : &quot;data:image/jpg;base64,/9j/4AAQSkZJRgABAQA...&quot;, //base64编码的缩略图
     &quot;command&quot; : &quot;imguploadret&quot;
 }
</code></pre></table></div></div><h2>2.10、第三方登录</h2><div style="margin-left:20px;"><h3>2.10.1、微信登录</h3><div style="margin-left:30px;"><ul>
<li>web请求微信联合登录（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>wxoauthReq</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">oauthreq</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">否</td>
<td></td>
<td>微信登录需要的必要参数</td>
</tr>
</tbody>
</table>
<ul>
<li>oauthreq数据描述：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">scope</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>第三方程序要向微信申请认证，并请求某些权限，需要调用WXApi的sendReq成员函数，向微信终端发送一个SendAuthReq消息结构。微信终端处理完后会向第三方程序发送一个处理结果。scope字符串长度不能超过1K</td>
</tr>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>第三方程序本身用来标识其请求的唯一性，最后跳转回第三方程序时，由微信终端回传，state字符串长度不能超过1K</td>
</tr>
</tbody>
</table>
<ul>
<li>微信登录结果回调（app->web）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>wxoauthRsp</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">code</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>如果不为空，则表示登录成功</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：无</li>
</ul></div></div><h2>2.11、用户引导</h2><div style="margin-left:20px;"><h3>2.11.1、用户首次引导</h3><div style="margin-left:30px;"><ul>
<li>App发送给课内页面执行新手引导命令（app->web）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>open_new_user_intro_page</td>
<td>通知页面打开新手引导</td>
</tr>
</tbody>
</table>
<ul>
<li>发送命令条件：（1）当前版本首次打开app （2）本地未下载书籍</li>
<li>
<p>触发时机：原生引导页结束后</p>
</li>
<li>web发送命令将课本加入下载列表，但是不下载（web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>addbookshelf</td>
<td>加入书架</td>
</tr>
<tr>
<td style="text-align: left;">bookitems</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">否</td>
<td></td>
<td>书本结构的数组</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：bookitem描述</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">itemname</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">grade</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">subtitle</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">page</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">downloadurl</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">bookname</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">catalogueurl</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">evaluation</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">app_limit_version</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">charge</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">islogin_experience</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">islogin_download</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">publish_bookid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">sdk_id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">tape_click</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">booktype</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
</tbody>
</table></div><h3>2.11.2、打开原生指定tab</h3><div style="margin-left:30px;"><p>web指定原生跳转到主页指定5大tab（web->app）</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>opentab</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">viewname</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>school/outer/me/world/user</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：如果跳转的tab打开了二级页面，则回到首页；几个场景（例如1：如果当前路径在课内->书本列表->书本详情页面，此时收到切换到Me页面的命令，则当前tab关闭路径上的所有页面回到课内首页，同时切换到Me页面  例如2：当前从Me页面进入到某个商品的详情页，收到切换到Me页面的命令，则直接回到Me页面首页，中间页面全部关闭）</li>
</ul></div></div><h2>2.12、登录检查</h2><div style="margin-left:20px;"><h3>2.12.1、页面登录检查</h3><div style="margin-left:30px;"><p>为了解决部分android机器强制退出APP后，页面的登录状态丢失问题，做以下优化（仅针对android）：
> 在app启动后，APP向首页（pschool页面）发送消息，告知页面app的登录状态，页面收到该消息后，如果判断出与页面状态不一致，需要作出相应的措施，并再次发送<code>logintatus</code>消息更新app登录状态</p>
<ul>
<li>app通知页面登录状态</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">app_login_status</td>
<td>通知登录状态</td>
</tr>
<tr>
<td style="text-align: left;">login_status</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;"></td>
<td>true表示已登录，false表示未登录</td>
</tr>
</tbody>
</table></div></div><h2>2.13、分享</h2><div style="margin-left:20px;"><h3>2.13.1、打开分享渠道</h3><div style="margin-left:30px;"><ul>
<li>一、打开分享渠道进行分享（web->app)</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>context</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">operation</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>share</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<ul>
<li>二、获取分享数据 (app->web)</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>wxshare</td>
<td></td>
</tr>
</tbody>
</table>
<p>-同步返回数据</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>context</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">operation</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>share</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<ul>
<li>三、分享回调 (app->web)</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>nmshareresult</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">success</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">否</td>
<td>false</td>
<td>是否成功</td>
</tr>
<tr>
<td style="text-align: left;">type</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>分享类型：diary、wx_friend、wx_timeline、qq、qzone、weibo、im</td>
</tr>
</tbody>
</table></div><h3>2.13.2、指定渠道直接分享</h3><div style="margin-left:30px;"><ul>
<li>指定渠道直接分享(老接口，分享给微信朋友、朋友圈)</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>context</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">operation</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>sharefriend(微信好友)、sharetimeline（朋友圈）</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">wxshare</td>
<td style="text-align: left;">dic</td>
<td style="text-align: left;">否</td>
<td>null</td>
<td>如果不传则app自动获取，如果有，则以此为准</td>
</tr>
</tbody>
</table>
<h2>--备注：sharefriend、sharetimeline在老版本中就已经支持，4.5版本新增其他类别的qq、qzone、weibo、diary、im</h2></div></div></div><h1>3、API接口</h1><div style="margin-left:20px;"><h2>3.1、Sysconfig接口</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>系统配置接口，提供离线页面更新、升级提示、广告、客服配置、课本增量更新开关，tab主题切换，主题色、web背景色切换，IM关键字动画配置....</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://namibox.com/app/sysconfig</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>POST </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">app_version</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>app版本号（3.0.7）</td>
</tr>
<tr>
<td style="text-align: left;">os_name</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>iOS</td>
</tr>
<tr>
<td style="text-align: left;">os_version</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>系统版本如：ios10.3</td>
</tr>
<tr>
<td style="text-align: left;">app_page</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">json</td>
<td>本地app_page版本号,eg：{"pschool":"1111"}}）</td>
</tr>
<tr>
<td style="text-align: left;">version</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>升级版本小版本号（30007）</td>
</tr>
<tr>
<td style="text-align: left;">screen_width</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>设备宽度</td>
</tr>
<tr>
<td style="text-align: left;">screen_height</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>设备高度</td>
</tr>
<tr>
<td style="text-align: left;">idfa</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>广告标识</td>
</tr>
<tr>
<td style="text-align: left;">province</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>省份</td>
</tr>
<tr>
<td style="text-align: left;">city</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>城市</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;ads&quot;: [{
            &quot;background_time&quot; = 15;                   //后台停留多久弹出广告
            &quot;countdown_time&quot; = 3;                 //广告停留时间（倒计时）
            &quot;end_time&quot; = 23;                          //结束时间（下午11点）
            &quot;expire_time&quot; = 20170902100000;       //过期日期
            img = &quot;https://f.namibox.com/advertise/50/show_small.jpg?ts=1493372272&quot;;
            &quot;video_url&quot;=&quot;https://test.mp4&quot;;     //广页展视视频地址(APP4.3开始支持)
            &quot;monitor_url&quot; = &quot;https://namibox.com/api/app/advertise_stat?id=50&amp;ns=180.173.242.50&amp;ni=__IESID__&amp;v=__LOC__&amp;xa=__ADPLATFORM__&amp;mo=1&amp;m0=__OPENUDID__&amp;m0a=__DUID__&amp;m1=__ANDROIDID1__&amp;m1a=__ANDROIDID__&amp;m2=__IMEI__&amp;m4=__AAID__&amp;m5=FF231329-35BF-4D94-BD25-ADC9883B4781&amp;nn=namibox&amp;m6=__MAC1__&amp;m6a=__MAC__&quot;;
            &quot;start_time&quot; = 0;                             //开始时间（0点）
            url = &quot;https://namibox.com/api/app/advertise_stat?id=50&amp;ns=180.173.242.50&amp;ni=__IESID__&amp;v=__LOC__&amp;xa=__ADPLATFORM__&amp;mo=1&amp;m0=__OPENUDID__&amp;m0a=__DUID__&amp;m1=__ANDROIDID1__&amp;m1a=__ANDROIDID__&amp;m2=__IMEI__&amp;m4=__AAID__&amp;m5=FF231329-35BF-4D94-BD25-ADC9883B4781&amp;nn=namibox&amp;m6=__MAC1__&amp;m6a=__MAC__&amp;adv_url=https://namibox.com/lesson/milesson_detail/506&quot;;
        }],                 //广告数组
&quot;app_cache&quot; =     {
        &quot;app_delete&quot; = [],
        &quot;app_new&quot; =  [{
                domain = &quot;r.namibox.com&quot;;
                force = 0;
                url =  &quot;http://ra.namibox.com/tina/static/applocal/cache/r.namibox.com/v2/r.namibox.com.zip&quot;;
                version = v2;
            }],
        &quot;app_update&quot; =  [],
    },
    &quot;app_cache&quot;:{&quot;app_delete&quot;:[],&quot;app_new&quot;:&quot;&quot;,&quot;app_update&quot;:[]};
    &quot;domain_https&quot; =     (
        &quot;v.namibox.com&quot;,
        &quot;i.namibox.com&quot;,
        &quot;ou.namibox.com&quot;,
        &quot;x.namibox.com&quot;,
        &quot;w.namibox.com&quot;,
        &quot;ra.namibox.com&quot;,
        &quot;r.namibox.com&quot;,
        &quot;owu.namibox.com&quot;,
        &quot;cr.namibox.com&quot;,
        &quot;wu.namibox.com&quot;,
        &quot;f.namibox.com&quot;,
        &quot;vf.namibox.com&quot;,
        &quot;namibox.com&quot;,
        &quot;owf.namibox.com&quot;,
        &quot;c.namibox.com&quot;,
        &quot;wf.namibox.com&quot;,
        &quot;u.namibox.com&quot;,
        &quot;wr.namibox.com&quot;,
        &quot;of.namibox.com&quot;
    );
    &quot;easemob_cs&quot; =     {
        &quot;app_feedback&quot; = 0;
        &quot;cs_group&quot; =         {
            detail = A;
            order = A;
            pay = A;
            product = A;
            user = A;
        };
        &quot;im_serverid&quot; = &quot;namibox_kefu&quot;;
    };
    enginetype = &quot;offline_cs&quot;;
    hotfix =     {
        md5 = &quot;&lt;null&gt;&quot;;
        needrestart = 0;
        url = &quot;&lt;null&gt;&quot;;
    };
    httpdns = 1;
    &quot;not_go_book&quot; =     {
        waiyansdk = 0;
    };
    &quot;safety_check&quot; =     {
        &quot;domain_ck&quot; =         (
        );
        &quot;html_ck&quot; =         (
        );
        &quot;static_ck&quot; =         (
        );
    };
    &quot;support_diff_download&quot; = 1;
    &quot;update_info&quot; =     {
        &quot;diff_size&quot; = 0;
        &quot;diff_url&quot; = &quot;&lt;null&gt;&quot;;
        &quot;force_update&quot; = 0;
        &quot;has_update&quot; = 0;
        log = &quot;&quot;;
        md5 = &quot;&lt;null&gt;&quot;;
        silent = 0;
        size = 0;
        url = &quot;&quot;;
        version = &quot;&quot;;
    };
    &quot;theme&quot;:[{
        &quot;theme_bg&quot;:&quot;https://xxx.com.a.png&quot;,  //可有可无，如果有，则tab有背景色，可像素复制
        &quot;expire_time&quot;:&quot;20170902100000&quot;,   //主题过期时间
        &quot;tabs&quot;:[
            {
                &quot;normal_icon&quot;:&quot;&quot;,           //未选中时的图片
                &quot;select_icon&quot;:&quot;&quot;,           //选中时的图片(支持gif)
                &quot;back_icon&quot;:&quot;&quot;,             //图片背景（可像素复制）
                &quot;select_back_icon&quot;:&quot;&quot;,      //选中时的图片背景（可像素复制）
                &quot;normal_txt&quot;:&quot;课内&quot;,      //未选中时的文字（可有可无）
                &quot;select_txt&quot;:&quot;课内&quot;,       //选中时的文字（可有可无）
                &quot;normal_color&quot;:&quot;&quot;,          //未选中文字的颜色
                &quot;select_color&quot;:&quot;&quot;,          //选中时文字的颜色
                &quot;web_name&quot;:&quot;main_school&quot;,             //webview的名称
                &quot;url&quot;:&quot;https://namibox.com/app/pschool&quot;,    //该tab对应的url
            }]
        }],
    &quot;IM_animationtext&quot;:{&quot;端午&quot;:&quot;https://端午图片.png&quot;,&quot;粽子&quot;:&quot;粽子图片&quot;},
    &quot;apppush&quot;: {
        &quot;start_time&quot;: &quot;20170922150834&quot;,//开始时间
        &quot;push_id&quot;: &quot;1|test|all&quot;,//推送id
        &quot;cid&quot;: 1,
        &quot;url&quot;: &quot;http://w.namibox.com/v/push/d/jct3content/005755?apppush=1&amp;_app_template=video&quot;,//软文
        &quot;title&quot;: &quot;sdfsdfsdfsdf&quot;,//标题
        &quot;content&quot;: &quot;sdfsdfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee&quot;,//内容
        &quot;end_time&quot;: &quot;20170923150845&quot;,//结束时间
        &quot;b_image&quot;: null,//大图模式(宽高比4:5)
        &quot;type&quot;: &quot;notification&quot;,
        &quot;s_image&quot;: &quot;http://wf.namibox.com/image/2017-09-22/QQ图片20160909140405-20170922150528.png&quot;,//小图加文字模式（宽高比1:1）
        &quot;s_image_bg&quot;: &quot;http://wf.namibox.com/image/2017-09-22/QQ图片20160909140405-20170922150528.png&quot;,//小图模式背景图（填充，铺满）
        &quot;view&quot;: &quot;namibox_notify&quot;,
        &quot;showtime&quot;:5,//小图展示时间（默认5s），如果该字段无，默认展示5s，仅针对小图模式生效
    }，
    appnative: {
        appouter: false,
        fanshow: false,
        appschool: false,
        appuc: false,
        appme: false,
        appworld: true,
        book: false
    },
    brand_list_data:[//品牌专区数据
        {
            icon:&quot;xxxxx&quot;,//品牌图标
            name:&quot;培生教材&quot;,//品牌名称
            tips_text:&quot;新朗文小学英语&quot;,//右侧文字
            url:&quot;xxxx&quot;//打开页面地址
        }
    ],
    publisher:{//出版社信息
        New Cambridge剑桥少儿: {
            icon: &quot;https://dev.namibox.com/tina/static/v/publisher/NC/title.jpg?upd=20171019195559&quot;,
            subtitle: &quot;收录了New Cambridge剑桥少儿的电子化教材，支持复读、点读及跟读评测功能&quot;,
            title: &quot;New Cambridge剑桥少儿&quot;,
            tip: &quot;&quot;
        },
        SuperKids少儿英语: {
            icon: &quot;https://dev.namibox.com/tina/static/v/publisher/SK/title.jpg?upd=20171019195559&quot;,
            subtitle: &quot;收录了SuperKids少儿英语的电子化教材，支持复读、点读及跟读评测功能&quot;,
            title: &quot;SuperKids少儿英语&quot;,
            tip: &quot;&quot;
        },
        ...
    }
    grade_list_data:[//年级列表数据
        {
            sectionname: &quot;学前&quot;,
            display:1,//展示：1，不展示：0
            section:[
                {
                    gradename:&quot;幼儿园&quot;,
                    grade：[
                        {
                            itemname:&quot;幼儿园&quot;,
                            path:&quot;/v/menu/1a&quot;,
                            key:&quot;1a&quot;,
                        }
                    ]
                }
            ]
        },
        {
            sectionname: &quot;小学&quot;,
            display:1,
            section:[
                {
                    gradename:&quot;一年级&quot;,
                    grade：[
                        {
                            itemname:&quot;一年级（上）&quot;,
                            path:&quot;/v/menu/1a&quot;,
                            key:&quot;1a&quot;,
                        }，
                        {
                            itemname:&quot;一年级（下）&quot;,
                            path:&quot;/v/menu/1b&quot;,
                            key:&quot;1a&quot;,
                        }
                    ]
                },
                {
                    gradename:&quot;二年级&quot;,
                    grade：[
                        {
                            itemname:&quot;二年级（上）&quot;,
                            path:&quot;/v/menu/2a&quot;,
                            key:&quot;1a&quot;,
                        }，
                        {
                            itemname:&quot;二年级（下）&quot;,
                            path:&quot;/v/menu/2b&quot;,
                            key:&quot;1a&quot;,
                        }
                    ]
                }
            ]
        }
        ...
    ]
}</code></pre></table>
<p><strong>返回参数说明</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">ads</td>
<td style="text-align: left;">array</td>
<td>广告配置</td>
</tr>
<tr>
<td style="text-align: left;">apppush</td>
<td style="text-align: left;">array</td>
<td>应用内推送</td>
</tr>
<tr>
<td style="text-align: left;"><del>app_cache</del></td>
<td style="text-align: left;"><del>json</del></td>
<td><del>web离线资源更新</del></td>
</tr>
<tr>
<td style="text-align: left;">app_page</td>
<td style="text-align: left;">json</td>
<td>web离线页面更新</td>
</tr>
<tr>
<td style="text-align: left;">domain_https</td>
<td style="text-align: left;">array</td>
<td>支持https域名的配置（如果app发现此类域名是http的会自动切换成https）</td>
</tr>
<tr>
<td style="text-align: left;">easemob_cs</td>
<td style="text-align: left;">array</td>
<td>客服配置</td>
</tr>
<tr>
<td style="text-align: left;"><del>enginetype</del></td>
<td style="text-align: left;"><del>array</del></td>
<td><del>口语评测引擎（用于跟读，4.0已失效）</del></td>
</tr>
<tr>
<td style="text-align: left;"><del>hotfix</del></td>
<td style="text-align: left;"><del>json</del></td>
<td><del>热更新配置，ios在3.0.7之后已失效</del></td>
</tr>
<tr>
<td style="text-align: left;">httpdns</td>
<td style="text-align: left;">bool</td>
<td>httpdns开关，仅支持安卓，ios没有httpdns</td>
</tr>
<tr>
<td style="text-align: left;">not_go_book</td>
<td style="text-align: left;">json</td>
<td>配置不经过离线页面直接打开的课本sdk，目前全部都要经过</td>
</tr>
<tr>
<td style="text-align: left;">safety_check</td>
<td style="text-align: left;">json</td>
<td>网络检测</td>
</tr>
<tr>
<td style="text-align: left;">support_diff_download</td>
<td style="text-align: left;">bool</td>
<td>是否支持课本增量更新，默认是支持的，如果增量更新有问题，可控制关闭</td>
</tr>
<tr>
<td style="text-align: left;">update_info</td>
<td style="text-align: left;">json</td>
<td>app升级配置（是否升级，升级提示等）</td>
</tr>
<tr>
<td style="text-align: left;">theme_color</td>
<td style="text-align: left;">string</td>
<td>可有可无，如果有，更改系统的主题色</td>
</tr>
<tr>
<td style="text-align: left;">web_bg_color</td>
<td style="text-align: left;">string</td>
<td>可有可无，如果有，更改web的背景色</td>
</tr>
<tr>
<td style="text-align: left;">theme</td>
<td style="text-align: left;">array</td>
<td>可有可无，如果有，依据过期时间更改tab主题，可能存在多个</td>
</tr>
<tr>
<td style="text-align: left;">IM_animationtext</td>
<td style="text-align: left;">json</td>
<td>可有可无，如果有，IM消息列表依据此关键字做动画，如果未获取到，或该请求接口失败，默认使用上一次保留信息</td>
</tr>
<tr>
<td style="text-align: left;"><del>appnative</del></td>
<td style="text-align: left;"><del>json</del></td>
<td><del>原生页面 true：原生</del></td>
</tr>
</tbody>
</table>
<p><strong>备注</strong> </p>
<ul>
<li>
<p>新增them规则：（1）normal_icon只有一张 ，select_icon可能是一组图片（me也买呢需要，normal_icon的一张就是select_icon数组的一个）(2)普通状态下（非me页面）的tab图标大小为58x58，背景图大小100x100（可拉伸，可像素复制），特殊状态下（me页面）tab图标的大小为110x110，背景图大小164x164,该状态不显示文本，文本配置无效  （3）当前web_name纳米盒：课内（main_school）,课外（main_outer）,Me（main_me）,世界（main_world）,我（main_user）；研习社：课程（main_tab_lesson）,研习圈（main_tab_world）,朋友（main_tab_circle）,我（main_tab_my）</p>
</li>
<li>新增IM_animationtext规则：IM依据sysconfig配置的关键字动画，在聊天时匹配关键字，并做动画，动画图片为传递过来的图片，如果图片下载失败，则不做匹配动画</li>
</ul>
<p>NMS后台管理：
<img src="http://bbs.namibox.com:5555/Public/Uploads/2017-06-28/5953117ca0efc.png" alt="" /></p>
<p>NMS后台管理支持上传gif图片和短视频模式，gif配置和之前的img图片保持一致，短视频的配置新增video_url字段，视频尺寸和之前图片尺寸配置保持一致，图片img字段和video_url字段不可同时存在，app端根据对应url是否存在来做相应的示，视频模式下之前的广告停留时长为该视频的播放时长。(APP4.3开始支持)</p>
<p>主题切换：可以设置几个tab，每个tab的设置层级结构如上描述
IM关键字动画：只要添加问题和上传对应的图片即可</p></div><h2>3.2、获取用IP信息接口</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>获取用IP信息接口</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>http://w.namibox.com/api/app/get_user_ipinfo</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>
<p>GET </p>
<p><strong>返回示例</strong></p>
</li>
</ul>
<table width='100%' class='codestyle'><pre><code> {
    province: &quot;上海市&quot;,
    ip: &quot;180.173.109.0&quot;,
    city: &quot;上海市&quot;
 }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">province</td>
<td style="text-align: left;">string</td>
<td>省份</td>
</tr>
<tr>
<td style="text-align: left;">city</td>
<td style="text-align: left;">string</td>
<td>城市</td>
</tr>
<tr>
<td style="text-align: left;">ip</td>
<td style="text-align: left;">string</td>
<td>IP地址</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong> </p>
<ul>
<li>更多返回错误代码请看首页的错误代码描述</li>
</ul></div><h2>3.1、点读相关</h2><div style="margin-left:20px;"><h3>3.1.1、获取课本年级列表</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>获取课本年级列表</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://w.namibox.com/api/app/tape/gradeList/plus</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">plus</td>
<td style="text-align: left;">string</td>
<td>cidai：磁带 ，click：点读 ， schoolbook ：教材， referencebook：教辅</td>
</tr>
</tbody>
</table>
<p><strong>返回参数说明</strong> </p>
<p><strong>备注</strong> </p>
<ul>
<li>更多返回错误代码请看首页的错误代码描述</li>
</ul>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
  settled: {
    url: &quot;https://w.namibox.com/app/pschool&quot;
    },
  &quot;sections&quot;: [
    {
      &quot;section&quot;: [
        {
          &quot;item&quot;: [
            {
              &quot;readcount&quot;: &quot;236978&quot;,
              &quot;publisher&quot;: [
                &quot;人教版&quot;,
                &quot;外研版&quot;,
                &quot;北师大版&quot;,
                &quot;沪教版&quot;,
                &quot;苏教版&quot;,
                &quot;语文社&quot;,
                &quot;上外社&quot;,
                &quot;北京社&quot;,
                &quot;冀教版&quot;,
                &quot;清华大学版&quot;,
                &quot;辽宁师大版&quot;,
                &quot;粤人社&quot;,
                &quot;粤教社&quot;,
                &quot;新蕾出版社&quot;,
                &quot;香港朗文版&quot;,
                &quot;其他&quot;
              ],
              &quot;subtitle&quot;: &quot;陆续收录教育部审定及地方审定全国各地教材的最新磁带录音，英语支持课本点读哦！&quot;,
              &quot;path&quot;: &quot;/v/menu/1a&quot;,
              &quot;page&quot;: &quot;schoolbook&quot;
              &quot;itemname&quot;: &quot;一年级（上）&quot;,
              &quot;icon&quot;: &quot;https://wr.namibox.com/tina/static/v/menu/1a/title.png?20160331170646&quot;
            }
          ],
          &quot;itemname&quot;: &quot;一上&quot;
        }
  ],
  &quot;recommend&quot;: {
    &quot;publisher&quot;: [
      &quot;沪教版&quot;,
      &quot;苏教版&quot;
    ]
  },
  &quot;banner_image&quot;: {
    &quot;img&quot;: &quot;https://wf.namibox.com/banner/u000262.jpg?ts=1462770267&quot;,
    &quot;url&quot;: &quot;http://www.baidu.com&quot;,
    &quot;text&quot;: &quot;撒打算打算的阿斯顿阿斯顿阿斯顿阿斯顿阿斯顿阿萨打算懂啊的&quot;,
    &quot;video_type&quot;: &quot;&quot;,
    &quot;height&quot;: &quot;0&quot;,
    &quot;extratext&quot;: &quot;&quot;,
    &quot;channel&quot;: &quot;课内学堂_磁带&quot;
  },
  &quot;wxshare&quot;: {
    &quot;groupcontent&quot;: &quot;小学语文、英语等全科课本磁带分段点读，超级体验，关注纳米盒，共同陪伴孩子成长！&quot;,
    &quot;grouptitile&quot;: &quot;甩掉复读机，在手机上点读小学课本磁带录音&quot;,
    &quot;doclink&quot;: &quot;https://w.namibox.com/v/menu&quot;,
    &quot;imgurl&quot;: &quot;https://wr.namibox.com/tina/static/v/menu/title.jpg?20160331170646&quot;,
    &quot;friendtitile&quot;: &quot;甩掉复读机，在手机上点读小学课本磁带录音，关注纳米盒，共同陪伴孩子成长！&quot;
  },
  &quot;publisher&quot;: {
    &quot;New Cambridge剑桥少儿&quot;: {
      &quot;icon&quot;: &quot;https://wr.namibox.com/tina/static/v/publisher/NC/title.jpg?upd=20160302150303&quot;,
      &quot;subtitle&quot;: &quot;收录了New Cambridge剑桥少儿的电子化教材，支持复读、点读及跟读评测功能&quot;,
      &quot;title&quot;: &quot;New Cambridge剑桥少儿&quot;，
      &quot;tip&quot;: &quot;&quot;
    },
    &quot;SuperKids少儿英语&quot;: {
      &quot;icon&quot;: &quot;https://wr.namibox.com/tina/static/v/publisher/SK/title.jpg?upd=20151020092821&quot;,
      &quot;subtitle&quot;: &quot;收录了SuperKids少儿英语的电子化教材，支持复读、点读及跟读评测功能&quot;,
      &quot;title&quot;: &quot;SuperKids少儿英语&quot;
      &quot;tip&quot;: &quot;&quot;
    }
  }
}
</code></pre></table></div><h3>3.1.2、书本列表接口</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>书本列表接口</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://w.namibox.com/api/app/tape/bookList?vdir=/v/menu/1a&amp;page=schoolbook</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>POST </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">vdir</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>年级目录</td>
</tr>
<tr>
<td style="text-align: left;">page</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>访问的页面</td>
</tr>
</tbody>
</table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">readcount</td>
<td style="text-align: left;">int</td>
<td>阅读数</td>
</tr>
<tr>
<td style="text-align: left;">islogin_experience</td>
<td style="text-align: left;">boolean</td>
<td>是否登陆体验 true， false</td>
</tr>
<tr>
<td style="text-align: left;">subtitle</td>
<td style="text-align: left;">string</td>
<td>书本副标题</td>
</tr>
<tr>
<td style="text-align: left;">app_limit_version</td>
<td style="text-align: left;">string</td>
<td>最低要求版本</td>
</tr>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">string</td>
<td>book的ID</td>
</tr>
<tr>
<td style="text-align: left;">hiq</td>
<td style="text-align: left;">boolean</td>
<td>是否高清</td>
</tr>
<tr>
<td style="text-align: left;">grade</td>
<td style="text-align: left;">string</td>
<td>年级信息</td>
</tr>
<tr>
<td style="text-align: left;">modifytime</td>
<td style="text-align: left;">string</td>
<td>书本修改时间</td>
</tr>
<tr>
<td style="text-align: left;">downloadurl</td>
<td style="text-align: left;">string</td>
<td>下载url</td>
</tr>
<tr>
<td style="text-align: left;">publish_bookid</td>
<td style="text-align: left;">string</td>
<td>出版社的bookid</td>
</tr>
<tr>
<td style="text-align: left;">category_lesson</td>
<td style="text-align: left;">string</td>
<td>学科：英语、数学、语文</td>
</tr>
<tr>
<td style="text-align: left;">tape_click</td>
<td style="text-align: left;">string</td>
<td>0: 磁带  1：点读  2：点读磁带</td>
</tr>
<tr>
<td style="text-align: left;">path</td>
<td style="text-align: left;">string</td>
<td>书本路径</td>
</tr>
<tr>
<td style="text-align: left;">catalogueurl</td>
<td style="text-align: left;">string</td>
<td>书本结构json的zip</td>
</tr>
<tr>
<td style="text-align: left;">itemname</td>
<td style="text-align: left;">string</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">string</td>
<td>书本封面</td>
</tr>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">string</td>
<td>书的类型，课本、非标课本、配套肯本教辅、课外教辅、非标课本配套教辅</td>
</tr>
<tr>
<td style="text-align: left;">islogin_download</td>
<td style="text-align: left;">boolean</td>
<td>是否需要登陆后下载</td>
</tr>
<tr>
<td style="text-align: left;">backup</td>
<td style="text-align: left;">boolean</td>
<td>备份书本zip</td>
</tr>
<tr>
<td style="text-align: left;">bookname</td>
<td style="text-align: left;">boolean</td>
<td>书本名称</td>
</tr>
<tr>
<td style="text-align: left;">vdir</td>
<td style="text-align: left;">boolean</td>
<td>书本的所在年级的路径</td>
</tr>
<tr>
<td style="text-align: left;">clickread</td>
<td style="text-align: left;">boolean</td>
<td>是否支持点读</td>
</tr>
<tr>
<td style="text-align: left;">charge</td>
<td style="text-align: left;">boolean</td>
<td>是否收费</td>
</tr>
<tr>
<td style="text-align: left;">updateflag</td>
<td style="text-align: left;">boolean</td>
<td>是否新书</td>
</tr>
<tr>
<td style="text-align: left;">clicktype</td>
<td style="text-align: left;">string</td>
<td>点读类型</td>
</tr>
<tr>
<td style="text-align: left;">sdk_id</td>
<td style="text-align: left;">boolean</td>
<td>sdk的id</td>
</tr>
<tr>
<td style="text-align: left;">evaluation</td>
<td style="text-align: left;">boolean</td>
<td>支持语音评测</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong> </p>
<ul>
<li>更多返回错误代码请看首页的错误代码描述</li>
</ul></div><h3>3.1.3、课本搜索</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>课本搜索</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>http://w.namibox.com/api/app/search_textbooks?key_words=沪&amp;booktype=0</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">key_words</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>查询关键字</td>
</tr>
<tr>
<td style="text-align: left;">booktype</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>查询类型 0课本，1教辅书</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    sections: [
        {
        section: [
            {
            item: [
            {
            readcount: &quot;0&quot;,
            islogin_experience: false,
            subtitle: &quot;四川教育出版社（2015年6月）版&quot;,
            app_limit_version: &quot;30000&quot;,
            bookid: &quot;tape3a_019003&quot;,
            hiq: true,
            grade: &quot;三年级上&quot;,
            modifytime: &quot;20160804135610&quot;,
            downloadurl: &quot;https://wu.namibox.com/static/charge/tape3a/fake_tape3a_019003.zip?20160804135610&quot;,
            publish_bookid: &quot;tape3a_019003&quot;,
            category_lesson: &quot;英语&quot;,
            tape_click: 2,
            path: &quot;tape3a/019003_英语（川教三年级起）&quot;,
            catalogueurl: &quot;https://wr.namibox.com/tina/static/d/tape3a/019003_英语（川教三年级起）/fake_tape3a_019003_json.zip?20160804135609&quot;,
            itemname: &quot;三年级英语（上）&quot;,
            icon: &quot;https://wr.namibox.com/tina/static/d/tape3a/019003_英语（川教三年级起）/fake_title.jpg?20160705150646&quot;,
            category: &quot;课本&quot;,
            islogin_download: false,
            booktype: &quot;0&quot;,
            backup: &quot;https://wu.namibox.com/static/charge/tape3a/fake_tape3a_019003_zip?20160804135610&quot;,
            bookname: &quot;英语（川教三年级起）&quot;,
            vdir: &quot;/v/menu/3a&quot;,
            clickread: true,
            charge: true,
            updateflag: false,
            clicktype: &quot;&quot;,
            sdk_id: &quot;&quot;,
            evaluation: true
            }

            ],
            itemname: &quot;搜索结果&quot;
            }
            ],
            sectionname: &quot;搜索结果&quot;
            }
        ],
        wxshare: {
        groupcontent: &quot;小学语文、英语等全科课本磁带分段点读，超级体验，关注纳米盒，共同陪伴孩子成长！&quot;,
        grouptitile: &quot;甩掉复读机，在手机上点读小学课本磁带录音&quot;,
        doclink: &quot;https://w.namibox.com/v/menu&quot;,
        imgurl: &quot;https://wr.namibox.com/tina/static/v/menu/title.jpg?20160331170646&quot;,
        friendtitile: &quot;甩掉复读机，在手机上点读小学课本磁带录音，关注纳米盒，共同陪伴孩子成长！&quot;
        },
    recommend: {
    publisher: [ ],
    references: [ ]
    }
}</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">readcount</td>
<td style="text-align: left;">int</td>
<td>阅读数</td>
</tr>
<tr>
<td style="text-align: left;">islogin_experience</td>
<td style="text-align: left;">boolean</td>
<td>是否登陆体验 true， false</td>
</tr>
<tr>
<td style="text-align: left;">subtitle</td>
<td style="text-align: left;">string</td>
<td>书本副标题</td>
</tr>
<tr>
<td style="text-align: left;">app_limit_version</td>
<td style="text-align: left;">string</td>
<td>最低要求版本</td>
</tr>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">string</td>
<td>book的ID</td>
</tr>
<tr>
<td style="text-align: left;">hiq</td>
<td style="text-align: left;">boolean</td>
<td>是否高清</td>
</tr>
<tr>
<td style="text-align: left;">grade</td>
<td style="text-align: left;">string</td>
<td>年级信息</td>
</tr>
<tr>
<td style="text-align: left;">modifytime</td>
<td style="text-align: left;">string</td>
<td>书本修改时间</td>
</tr>
<tr>
<td style="text-align: left;">downloadurl</td>
<td style="text-align: left;">string</td>
<td>下载url</td>
</tr>
<tr>
<td style="text-align: left;">publish_bookid</td>
<td style="text-align: left;">string</td>
<td>出版社的bookid</td>
</tr>
<tr>
<td style="text-align: left;">category_lesson</td>
<td style="text-align: left;">string</td>
<td>学科：英语、数学、语文</td>
</tr>
<tr>
<td style="text-align: left;">tape_click</td>
<td style="text-align: left;">string</td>
<td>0: 磁带  1：点读  2：点读磁带</td>
</tr>
<tr>
<td style="text-align: left;">path</td>
<td style="text-align: left;">string</td>
<td>书本路径</td>
</tr>
<tr>
<td style="text-align: left;">catalogueurl</td>
<td style="text-align: left;">string</td>
<td>书本结构json的zip</td>
</tr>
<tr>
<td style="text-align: left;">itemname</td>
<td style="text-align: left;">string</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">string</td>
<td>书本封面</td>
</tr>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">string</td>
<td>书的类型，课本、非标课本、配套肯本教辅、课外教辅、非标课本配套教辅</td>
</tr>
<tr>
<td style="text-align: left;">islogin_download</td>
<td style="text-align: left;">boolean</td>
<td>是否需要登陆后下载</td>
</tr>
<tr>
<td style="text-align: left;">backup</td>
<td style="text-align: left;">boolean</td>
<td>备份书本zip</td>
</tr>
<tr>
<td style="text-align: left;">bookname</td>
<td style="text-align: left;">boolean</td>
<td>书本名称</td>
</tr>
<tr>
<td style="text-align: left;">vdir</td>
<td style="text-align: left;">boolean</td>
<td>书本的所在年级的路径</td>
</tr>
<tr>
<td style="text-align: left;">clickread</td>
<td style="text-align: left;">boolean</td>
<td>是否支持点读</td>
</tr>
<tr>
<td style="text-align: left;">charge</td>
<td style="text-align: left;">boolean</td>
<td>是否收费</td>
</tr>
<tr>
<td style="text-align: left;">updateflag</td>
<td style="text-align: left;">boolean</td>
<td>是否新书</td>
</tr>
<tr>
<td style="text-align: left;">clicktype</td>
<td style="text-align: left;">string</td>
<td>点读类型</td>
</tr>
<tr>
<td style="text-align: left;">sdk_id</td>
<td style="text-align: left;">boolean</td>
<td>sdk的id</td>
</tr>
<tr>
<td style="text-align: left;">evaluation</td>
<td style="text-align: left;">boolean</td>
<td>支持语音评测</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong> </p>
<ul>
<li>更多返回错误代码请看首页的错误代码描述</li>
</ul></div><h3>3.1.4、书本推荐列表</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>用户注册接口</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://w.namibox.com/api/app/book_recom?content_type=referencebook</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">content_type</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>类型，referencebook:教辅、schoolbook：课本</td>
</tr>
</tbody>
</table>
<p><strong>未加入班级圈返回示例</strong>
{
url: "<a href="https://w.namibox.com/classzone/register&quot">https://w.namibox.com/classzone/register&quot</a>;,
message: "没有加入班级圈或未登录"
}</p>
<p><strong>加入班级圈返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>[
    {
        section: [
            {
        item: [
        {
            readcount: &quot;0&quot;,
            islogin_experience: false,
            subtitle: &quot;江苏科学技术出版社&quot;,
            app_limit_version: 0,
            bookid: &quot;tape2a_000101&quot;,
            hiq: false,
            grade: &quot;二年级上&quot;,
            modifytime: &quot;20150331122038&quot;,
            downloadurl: &quot;https://wu.namibox.com/static/d/tape2a/tape2a_000101.zip?20150331122038&quot;,
            publish_bookid: &quot;tape2a_000101&quot;,
            category_lesson: &quot;英语&quot;,
            tape_click: &quot;0&quot;,
            path: &quot;tape2a/000101_英语（好题真卷）&quot;,
            catalogueurl: &quot;https://wr.namibox.com/tina/static/d/tape2a/000101_英语（好题真卷）/tape2a_000101_json.zip?20151010132138&quot;,
            itemname: &quot;二年级英语好题真卷（上）&quot;,
            icon: &quot;https://wr.namibox.com/tina/static/d/tape2a/000101_英语（好题真卷）/title.jpg?20141202131434&quot;,
            category: &quot;课外教辅&quot;,
            islogin_download: false,
            booktype: &quot;1&quot;,
            backup: &quot;https://wu.namibox.com/static/d/tape2a/tape2a_000101_zip?20150331122038&quot;,
            bookname: &quot;英语（好题真卷）&quot;,
            vdir: &quot;/v/menu/2a&quot;,
            clickread: false,
            charge: false,
            updateflag: false,
            clicktype: &quot;&quot;,
            sdk_id: &quot;&quot;,
            evaluation: false
            }
            ],
            itemname: &quot;推荐列表&quot;
            }
],
sectionname: &quot;推荐列表&quot;</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<p><strong>备注</strong> </p>
<ul>
<li>更多返回错误代码请看首页的错误代码描述</li>
</ul></div></div><h2>3.2、贴图秀</h2><div style="margin-left:20px;"><h3>3.2.1、获取帖子信息（评论、点赞、收藏、分享）</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>获取帖子的各项信息</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><a href="https://w.namibox.com/api/app/get_post_info?object_id=1735932">https://w.namibox.com/api/app/get_post_info?object_id=1735932</a></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>
<p>GET </p>
</li>
<li>
<p>object_id 为帖子 id</p>
<p><strong>返回示例</strong></p>
</li>
</ul>
<p>返回类型为 <code>dict</code>, 按照顺序对 <code>status_bar</code> 中的图标进行排列</p>
<table width='100%' class='codestyle'><pre><code>{
&quot;status_bar&quot;: [
{&quot;name&quot;: &quot;quick_reply&quot;},
{&quot;name&quot;: &quot;comments&quot;, &quot;count&quot;: 112, &quot;object_type&quot;: &quot;picshow&quot;},
                {&quot;name&quot;: &quot;likes&quot;, &quot;is_like&quot;: False, &quot;count&quot;: 67, &quot;object_type&quot;: &quot;comment&quot;}, 
                 {&quot;name&quot;: &quot;favs&quot;, &quot;is_fav&quot;: False,&quot;fav_type&quot;: &quot;comment&quot;, &quot;object_type&quot;: &quot;picshow&quot;}, 
                 {&quot;name&quot;: &quot;shares&quot;, &quot;count&quot;: 10, &quot;object_type&quot;: &quot;picshow&quot;}], 
&quot;share_title&quot;: &quot;好图！&quot;, 
&quot;post_content&quot;: &quot;绝世好图！&quot;,
&quot;post_url&quot;: &quot;http://xxxxx&quot;,
&quot;share_friend&quot;: &quot;专属贴图社区，秀美图上热门，海量美图在等你！&quot;,
&quot;share_content&quot;: &quot;专属贴图社区，秀美图上热门，海量美图在等你！&quot;,
&quot;error_code&quot;: 0,
&quot;error_desc&quot;: &quot;成功获取帖子信息&quot;
}</code></pre></table>
<p><strong>名称对应：</strong>
comments: 评论
likes: 点赞
favs: 收藏
shares: 分享</p>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">error_code</td>
<td style="text-align: left;">int</td>
<td>0为成功，-1为失败</td>
</tr>
<tr>
<td style="text-align: left;">error_desc</td>
<td style="text-align: left;">string</td>
<td>返回信息描述</td>
</tr>
</tbody>
</table></div><h3>3.2.2、提交快速评论</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>提交快速评论</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><a href="https://w.namibox.com/api/app/quick_reply">https://w.namibox.com/api/app/quick_reply</a></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>POST </li>
</ul>
<p><strong>请求参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">comment</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>评论内容</td>
</tr>
<tr>
<td style="text-align: left;">object_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>帖子 ID，即为 <a href="http://doc.namibox.com/index.php?s=/1&page_id=19">http://doc.namibox.com/index.php?s=/1&page_id=19</a> 中的 <code>object_id</code></td>
</tr>
<tr>
<td style="text-align: left;">object_subtype</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>帖子子类别，即为 <a href="http://doc.namibox.com/index.php?s=/1&page_id=19">http://doc.namibox.com/index.php?s=/1&page_id=19</a> 中的 <code>quick_comment_object_type</code></td>
</tr>
</tbody>
</table>
<p><strong>请求示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
   &quot;comment&quot;:&quot;第三方斯蒂芬斯蒂芬&quot;, 
   &quot;object_id&quot;:&quot;1735937&quot;, 
   &quot;object_subtype&quot;:&quot;picshow&quot;}</code></pre></table>
<p><strong> 返回示例 </strong></p>
<table width='100%' class='codestyle'><pre><code> {
  &quot;error_code&quot;: 0, 
  &quot;error_desc&quot;: &quot;评论已成功&quot;
 }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">error_code</td>
<td style="text-align: left;">是</td>
<td>string</td>
<td>状态码，成功为 0， 未登录为 1001，其他失败为 -1</td>
</tr>
<tr>
<td style="text-align: left;">error_desc</td>
<td style="text-align: left;">是</td>
<td>string</td>
<td>状态描述</td>
</tr>
</tbody>
</table></div></div><h2>3.3、直播</h2><div style="margin-left:20px;"><h3>3.3.1、获取直播状态</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>用户注册接口</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://w.namibox.com/api/app/get_cast_info</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">cast_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>直播 id</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;error_code&quot;: 0,
    &quot;error_desc&quot;: &quot;成功获取直播状态！&quot;,
    &quot;cast_img&quot;: &quot;xxxx&quot;, 
    &quot;classes&quot;: [
                {&quot;class_name&quot;: &quot;xxx小学xx班&quot;, &quot;is_origin&quot;: true, 
                 &quot;is_in_class&quot;: false}, 
                 ...
                 ]
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">error_code</td>
<td style="text-align: left;">int</td>
<td>0 为成功，-1 为失败</td>
</tr>
<tr>
<td style="text-align: left;">error_desc</td>
<td style="text-align: left;">str</td>
<td>状态描述</td>
</tr>
<tr>
<td style="text-align: left;">classes</td>
<td style="text-align: left;">str</td>
<td>该直播所对应的班级列表，其中 is_origin 为是否为发起班级，is_in_class 为我是否该班级成员</td>
</tr>
</tbody>
</table></div><h3>3.3.2、更新直播封面</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>更新直播封面</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>/api/app/update_cast_banner</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>POST </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">cast_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>cast_id</td>
</tr>
<tr>
<td style="text-align: left;">banner_img_url</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>直播封面</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;error_desc&quot;: &quot;成功更新直播封面！&quot;,
    &quot;error_code&quot;: 0,
    &quot;retcode&quot;: &quot;SUCCESS&quot;,
    &quot;description&quot;: &quot;Banner image updated!&quot;
}</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">error_code</td>
<td style="text-align: left;">int</td>
<td>0 为成功 -1 为失败</td>
</tr>
<tr>
<td style="text-align: left;">error_desc</td>
<td style="text-align: left;">string</td>
<td>结果描述</td>
</tr>
</tbody>
</table></div></div><h2>3.4、盒粉秀</h2><div style="margin-left:20px;"><h3>3.4.1、盒粉秀等原生提交场景的班级圈限制能力</h3><div style="margin-left:30px;"><h2>触发盒粉秀制作命令新增字段</h2>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;command&quot;:  “app_action”,
    &quot;name&quot;:  “createstoryshow/createvideoshow/readbook”,
    ...
    &quot;transmissionparam&quot;:&quot;&quot;//透传字段,这里用来传班级圈id,客户端不做任何处理,直直接透传给上报接口
    &quot;classcheck&quot;:0        //0 表示不显示班级圈勾选框 1 表示显示勾选框默认选中 -1 显示勾选框默认不选中
    'extra': &quot;&quot;  //额外字段(json字符串)
  }</code></pre></table>
<h2>校验作品是否存在</h2>
<p>接口地址: /fanshow/reading/check_work_exits</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书本id</td>
</tr>
<tr>
<td style="text-align: left;">extra</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>触发盒粉秀制作时传给客户端的extra字段。 (json字符串类型)</td>
</tr>
</tbody>
</table>
<h2>触发盒粉秀修改命令新增字段</h2>
<table width='100%' class='codestyle'><pre><code>    {
    &quot;command&quot;:  “modifywork”,
    ...
    &quot;transmissionparam&quot;:&quot;&quot;//透传字段,这里用来传班级圈id,客户端不做任何处理,直直接透传给上报接口
    &quot;classcheck&quot;:0        //0 表示不显示班级圈勾选框 1 表示显示勾选框默认选中 -1 显示勾选框默认不选中
  }</code></pre></table>
<h2>盒粉秀上传提交接口新增字段</h2>
<p>接口地址 : /fanshow/reading/upload_works_by_sftp</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">transmissionparam</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>透传字段,暂时用来传班级圈id</td>
</tr>
<tr>
<td style="text-align: left;">classcheckresult</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>0或不传 表示默认情况 1 表示勾选框选中 -1 勾选框不选中</td>
</tr>
<tr>
<td style="text-align: left;">extra</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>触发盒粉秀制作时传给客户端的extra字段。 (json字符串类型)</td>
</tr>
</tbody>
</table></div><h3>3.4.2、支持配音的盒粉秀接口</h3><div style="margin-left:30px;"><p>接口URL有Webview传递给APP,接口结果示例：</p>
<p>>
主要为了支持绘本评测，在bookpage数组里的每个元素里新增了page_content字段。
不是每个绘本都支持口语评测，不支持口语评测的绘本里可能不会包含这个字段。
support_oral_evaluation 为true的情况下保证每个页面都有page_content字段，但是不保证page_content字段里都有内容。
由于需要支持中文评测，在bookpage里面添加了content_lang字段；
另，为了满足由内容决定评测引擎，将评测引擎作为字段从后端传入；oral_engine。</p>
<pre><code class="language-json">{
    readcount: 772,
    comment: 13,
    obj_type: &quot;jct3userwork&quot;,
    subtitle: &quot;小猪说他今天将会飞起来，它会成功吗？&quot;,
    workuser: [],
    bookid: &quot;ort_004001_000158&quot;,
    author: &quot;禁言七天你们懂得&quot;,
    book
    name: &quot;Today I Will Fly&quot;,
    starank: &quot;4.7&quot;,
    share: 2,
    oral_engine: &quot;mix_xs&quot;,
    wxshare: {
        groupcontent: &quot;小猪说他今天将会飞起来，它会成功吗？&quot;,
        grouptitile: &quot;经典英文绘本推荐《Today I Will Fly》&quot;,
        doclink: &quot;https://namibox.com/v/fanshow/d/ort/004001_小猪小象/000158_Today I Will Fly?r=1&amp;userwork=7849473&quot;,
        imgurl: &quot;https://r.namibox.com/tina/static/d/ort/004001_小猪小象/000158_Today I Will Fly/title.jpg?20160629094105&quot;,
        friendtitile: &quot;经典英文绘本推荐《Today I Will Fly》：小猪说他今天将会飞起来，它会成功吗？&quot;
    },
    praise: 33,
    banner_image: &quot;&quot;,
    content_type: &quot;englishbook&quot;,
    support_oral_evaluation: true,
    bookpage: [{
            page_name: &quot;slide0001.jpg&quot;,
            page_content: &quot;本页要评测的文本内容&quot;,
            coreType: &quot;en.pred.exam&quot;,
            mp3_index: 0,
            page_url: &quot;https://ra.namibox.com/tina/static/d/ort/004001_小猪小象/000158_Today I Will Fly/slide0001.jpg?20160629090721&quot;
        }, {
            page_name: &quot;slide0002.jpg&quot;,
            page_content: &quot;本页要评测的文本内容&quot;,
            coreType: &quot;en.pred.exam&quot;,
            mp3_index: 1,
            page_url: &quot;https://ra.namibox.com/tina/static/d/ort/004001_小猪小象/000158_Today I Will Fly/slide0002.jpg?20160629090721&quot;
        }, {
            page_name: &quot;slide0003.jpg&quot;,
            page_content: &quot;本页要评测的文本内容&quot;,
            coreType: &quot;en.pred.exam&quot;,
            mp3_index: 2,
            page_url: &quot;https://ra.namibox.com/tina/static/d/ort/004001_小猪小象/000158_Today I Will Fly/slide0003.jpg?20160629090721&quot;
        }, {
            page_name: &quot;slide0004.jpg&quot;,
            page_content: &quot;本页要评测的文本内容&quot;,
            coreType: &quot;en.pred.exam&quot;,
            mp3_index: 3,
            page_url: &quot;https://ra.namibox.com/tina/static/d/ort/004001_小猪小象/000158_Today I Will Fly/slide0004.jpg?20160629090725&quot;
        }
    ],
    icon: &quot;https://r.namibox.com/tina/static/d/ort/004001_小猪小象/000158_Today I Will Fly/title.jpg?20160629094105&quot;,
    author_icon: &quot;https://f.namibox.com/user/102836/headimage/20171128468677_0.jpg@1e_160w_160h_1c_0i_1o_90Q_1x.jpg?744x992@68417&quot;,
    bookaudio: [{
            duration: 0,
            mp3_name: &quot;slide0001.mp3&quot;,
            mp3_url: &quot;https://u.namibox.com/user/102836/works/7849473/slide0001.mp3?20171126115750&quot;
        }, {
            duration: 0,
            mp3_name: &quot;slide0002.mp3&quot;,
            mp3_url: &quot;https://u.namibox.com/user/102836/works/7849473/slide0002.mp3?20171126115750&quot;
        }, {
            duration: 0,
            mp3_name: &quot;slide0003.mp3&quot;,
            mp3_url: &quot;https://u.namibox.com/user/102836/works/7849473/slide0003.mp3?20171126115750&quot;
        }, {
            duration: 0,
            mp3_name: &quot;slide0004.mp3&quot;,
            mp3_url: &quot;https://u.namibox.com/user/102836/works/7849473/slide0004.mp3?20171126115750&quot;
        }
    ],
    comment_url: &quot;https://namibox.com/diary/jct3userwork_nc?content=jct3userwork/7849473_Today I Will Fly&amp;type=jct3userwork&amp;redirect=/v/fanshow/d/jct3userwork/7849473_Today I Will Fly&quot;,
    autoplay: false,
    params：{
        endpoint:&quot;oss-cn-hangzhou.aliyuncs.com&quot;,
        AccessKeyId:&quot;STS.CdnCN6kiSaVHdo6Pxsna7NEL7&quot;,
        AccessKeySecret:&quot;3Qkr7G2wpBqtfGkj6T9nwwDvvhXaaib8gyECRLThxKCP&quot;,
        objectKey:&quot;vschool/pic_eval/3127917/ort_009001_000001/&quot;,
        Expiration:&quot;2018-03-19T10:07:29Z&quot;,
        SecurityToken:&quot;CAISngJ1q6Ft5B2yfSjIoqfbCPSChrZy1pSjZkmHtHgmYu4boYDn1Tz2IH5Lf3ZuBuEdsfUwlWxU6P4SlqZ9QpleRUvbWpAptMsGqFz55yxAPgfxv9I+k5SANTW5EnyShb3WAYjQSNfaZY3iCTTtnTNyxr3XbCirW0ffX7SClZ9gaKZwPGy/diEUPMpKAQFgpcQGTymzU8ygKRn3mGHdIVN1sw5n8wNF5L+439eX52io7inzwfRHoJ/qcNr2LZtqNZJ+WdClmfMxa7HMymkSyWATr/oq0vQUoW2X54jNWAYB2XjcbbqIqO8IBRRie603F5RDqPXBjvBisoTR7d+plE0SY74ECHuOG9H8nJWcSPnIMN88dLz8KzHSwlI9k2M5W99OGoABQ/v7bYz2Xypwl1fCBDebG3Ht1xNemEyVqoQoxacEQo9p1BoV4WGn84qgA6+qeT5TdUsvXfxe/iTQOAKDMaJ7Z8D7qyKkyT0nxQbQW14iZ4L7y8/WGwf/AJ/4LrHPZKLWtx7VDZwIMdugzThK4IEfUv7RVgS+Or+vQ9jWN1knOlk=&quot;,
        bucketName:&quot;namibox-w&quot;
    },
</code></pre></table>
<p>>
评测结束后的数据提交接口的数据格式：</p>
<pre><code class="language-json">{
  &quot;content_type&quot; : &quot;englishbook&quot;,
  &quot;recognize_datas&quot; : [
    {
      &quot;score&quot; : &quot;60&quot;,
      &quot;pron&quot; : 61,
      &quot;integrity&quot; : 50,
      &quot;exercise_id&quot; : &quot;0&quot;,
      &quot;text&quot; : &quot;Animal Coats.Written by Claire Llewellyn&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 73,
      &quot;mp3name&quot; : &quot;slide0001.m&quot;
    },
    {
      &quot;score&quot; : &quot;75&quot;,
      &quot;pron&quot; : 72,
      &quot;integrity&quot; : 88,
      &quot;exercise_id&quot; : &quot;11&quot;,
      &quot;text&quot; : &quot;Who has a coat made of skin?&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 86,
      &quot;mp3name&quot; : &quot;slide0012.m&quot;
    },
    {
      &quot;score&quot; : &quot;67&quot;,
      &quot;pron&quot; : 61,
      &quot;integrity&quot; : 63,
      &quot;exercise_id&quot; : &quot;9&quot;,
      &quot;text&quot; : &quot;Who has a coat made of scales?&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 91,
      &quot;mp3name&quot; : &quot;slide0010.m&quot;
    },
    {
      &quot;score&quot; : &quot;76&quot;,
      &quot;pron&quot; : 75,
      &quot;integrity&quot; : 88,
      &quot;exercise_id&quot; : &quot;7&quot;,
      &quot;text&quot; : &quot;Who has a coat made of shell?&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 93,
      &quot;mp3name&quot; : &quot;slide0008.m&quot;
    },
    {
      &quot;score&quot; : &quot;76&quot;,
      &quot;pron&quot; : 77,
      &quot;integrity&quot; : 75,
      &quot;exercise_id&quot; : &quot;5&quot;,
      &quot;text&quot; : &quot;Who has a coat made of fur?&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 85,
      &quot;mp3name&quot; : &quot;slide0006.m&quot;
    },
    {
      &quot;score&quot; : &quot;79&quot;,
      &quot;pron&quot; : 81,
      &quot;integrity&quot; : 100,
      &quot;exercise_id&quot; : &quot;3&quot;,
      &quot;text&quot; : &quot;Who has a coat made of feathers?&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 87,
      &quot;mp3name&quot; : &quot;slide0004.m&quot;
    },
    {
      &quot;score&quot; : &quot;90&quot;,
      &quot;pron&quot; : 91,
      &quot;integrity&quot; : 100,
      &quot;exercise_id&quot; : &quot;1&quot;,
      &quot;text&quot; : &quot;I have a coat.&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 91,
      &quot;mp3name&quot; : &quot;slide0002.m&quot;
    },
    {
      &quot;score&quot; : &quot;95&quot;,
      &quot;pron&quot; : 93,
      &quot;integrity&quot; : 100,
      &quot;exercise_id&quot; : &quot;12&quot;,
      &quot;text&quot; : &quot;me&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 100,
      &quot;mp3name&quot; : &quot;slide0013.m&quot;
    },
    {
      &quot;score&quot; : &quot;92&quot;,
      &quot;pron&quot; : 91,
      &quot;integrity&quot; : 100,
      &quot;exercise_id&quot; : &quot;10&quot;,
      &quot;text&quot; : &quot;snake&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 99,
      &quot;mp3name&quot; : &quot;slide0011.m&quot;
    },
    {
      &quot;score&quot; : &quot;52&quot;,
      &quot;pron&quot; : 50,
      &quot;integrity&quot; : 0,
      &quot;exercise_id&quot; : &quot;8&quot;,
      &quot;text&quot; : &quot;tortoise&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 68,
      &quot;mp3name&quot; : &quot;slide0009.m&quot;
    },
    {
      &quot;score&quot; : &quot;78&quot;,
      &quot;pron&quot; : 76,
      &quot;integrity&quot; : 100,
      &quot;exercise_id&quot; : &quot;6&quot;,
      &quot;text&quot; : &quot;bear&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 91,
      &quot;mp3name&quot; : &quot;slide0007.m&quot;
    },
    {
      &quot;score&quot; : &quot;76&quot;,
      &quot;pron&quot; : 76,
      &quot;integrity&quot; : 100,
      &quot;exercise_id&quot; : &quot;4&quot;,
      &quot;text&quot; : &quot;duck&quot;,
      &quot;engine_used&quot; : &quot;offline_xs&quot;,
      &quot;fluency&quot; : 81,
      &quot;mp3name&quot; : &quot;slide0005.m&quot;
    }
  ],
  &quot;introduce&quot; : &quot;&quot;,
  &quot;transmissionparam&quot; : &quot;vschool_1&quot;,
  &quot;extra&quot; : &quot;{\&quot;match_id\&quot;:\&quot;vschool_1_51456\&quot;}&quot;,
  &quot;bookid&quot; : &quot;ort_009001_000002&quot;
}</code></pre></table>
<p>>
网校绘本评测作业：</p>
<p>为了在提交页面添加评测用时、评测结果分、以及三个维度得分的平均值，需要在请求submit_url的时候，需要添加上以下参数：
<submit_url>&time_cost=14:25&score=90&pron=76&integrity=80&fluency=99</p></div><h3>3.4.3、故事秀直传</h3><div style="margin-left:30px;"><h2>获取OSS上传所需信息</h2>
<table width='100%' class='codestyle'><pre><code>GET /fanshow/get_freeaudio_upload_token</code></pre></table>
<h3>Response</h3>
<table width='100%' class='codestyle'><pre><code>{
    &quot;errcode&quot;:0,
    &quot;endpoint&quot;:&quot;oss-cn-hangzhou.aliyuncs.com&quot;,
    &quot;AccessKeyId&quot;:&quot;Vpj2iZVesJZX69Ir&quot;,
    &quot;AccessKeySecret&quot;:&quot;dZKtHTX7fiZ7HNqRoA9cehRZqUu6Yp&quot;,
    &quot;SecurityToken&quot;: &quot;CAISnwJ1q6Ft5B2yfSjIqrfjHcjsv4ZWhvaKV...&quot;,
    &quot;Expiration&quot;: &quot;2018-04-10T09:44:52Z&quot;,
    &quot;bucketName&quot;:&quot;namibox-ow&quot;,
    &quot;objectKey&quot;:&quot;user/8713640/works/000002/&quot;,
    &quot;oms_cid&quot;:&quot;000002&quot;
}</code></pre></table>
<h3>返回字段说明</h3>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>errcode</td>
<td>int</td>
<td>错误码</td>
</tr>
<tr>
<td>endpoint</td>
<td>string</td>
<td>oss上传所需参数</td>
</tr>
<tr>
<td>AccessKeyId</td>
<td>string</td>
<td>oss上传所需参数</td>
</tr>
<tr>
<td>AccessKeySecret</td>
<td>string</td>
<td>oss上传所需参数</td>
</tr>
<tr>
<td>SecurityToken</td>
<td>string</td>
<td>oss上传所需参数</td>
</tr>
<tr>
<td>Expiration</td>
<td>string</td>
<td>oss上传所需参数</td>
</tr>
<tr>
<td>bucketName</td>
<td>string</td>
<td>oss上传所需参数</td>
</tr>
<tr>
<td>objectKey</td>
<td>string</td>
<td>文件路径，后面需要拼上具体文件名(图片和音频都一样)</td>
</tr>
<tr>
<td>oms_cid</td>
<td>string</td>
<td>该字段在请求上传接口时必须带上</td>
</tr>
</tbody>
</table>
<h2>上传接口请求</h2>
<table width='100%' class='codestyle'><pre><code>POST /fanshow/reading/upload_works_by_sftp/</code></pre></table>
<h3>Request</h3>
<table width='100%' class='codestyle'><pre><code>如果是故事秀直传，则新增如下字段：
{
    &quot;direct_upload&quot;: True, // 一定要为真，具体什么值无所谓
    &quot;oms_cid&quot;: &quot;000002&quot;      // 上面接口返回给你的值
}
其它字段不变</code></pre></table>
<h3>Response</h3>
<table width='100%' class='codestyle'><pre><code>不变</code></pre></table></div></div><h2>3.5、原生化</h2><div style="margin-left:20px;"><h3>3.5.1、tangram_index</h3><div style="margin-left:30px;"><h2>布局对应关系</h2>
<p>banner布局----2000
一行一个----1
两个-----2
三个-----3
四个-----4
五个-----9</p>
<h2>控件对应关系</h2>
<p>banner控件----3000
单文本控件---3001
卡片控件----3002
推荐控件----3003
圆形控件----3004
随机文本控件---3005</p>
<p><a href="https://dev.namibox.com/appnative/pworld">世界页面</a></p></div><h3>3.5.2、tangram_layout_banner</h3><div style="margin-left:30px;"><h2>banner_card</h2>
<p>用在banner和滚动图的布局样式
<a href="http://tangram.pingguohe.net/docs/layout-support/pagescroll-layout">参考文档</a></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;id&quot;: &quot;banner&quot;,
    &quot;type&quot;: &quot;2000&quot;,
    &quot;style&quot;: {
        &quot;indicatorRadius&quot;: &quot;5&quot;,//指示器半径
        &quot;indicatorColor&quot;: &quot;#ffffff&quot;,//指示器选中颜色
        &quot;defaultIndicatorColor&quot;: &quot;#66666666&quot;,//指示器未选中颜色
        &quot;indicatorGravity&quot;: &quot;center&quot;,//指示器位置
        &quot;indicatorPosition&quot;: &quot;inside&quot;,//指示器是否在内部显示
        &quot;indicatorMargin&quot;: 10,
        &quot;indicatorGap&quot;: &quot;5&quot;,
        //以上属性不传则android不显示指示器
        &quot;hasIndicator&quot;: &quot;false&quot;,//ios不显示指示器
        &quot;autoScroll&quot;: &quot;3000&quot;,//自动滚动时间
        &quot;infinite&quot;: &quot;true&quot;,//无限滚动
        &quot;bgColor&quot;: &quot;#ffffff&quot;,
        &quot;aspectRatio&quot;: &quot;1.7&quot;//宽高比
        &quot;scrollMarginLeft&quot;: 10,//滚动内容的左边距
        &quot;scrollMarginRight&quot;: 10,//滚动内容的右边距
        &quot;pageRatio&quot;: &quot;0.34&quot;//一项占据的比例
    },
    &quot;items&quot;: []
}
</code></pre></table>
<h2>注意点</h2>
<table width='100%' class='codestyle'><pre><code>iOS只有一张图片：不传autoScroll  infinite ，否则会看不到图片
</code></pre></table></div><h3>3.5.3、tangram_layout_grid</h3><div style="margin-left:30px;"><h2>流式布局</h2>
<p><a href="http://tangram.pingguohe.net/docs/layout-support/flow-layout">参考文档</a></p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;id&quot; : &quot;成长圈&quot;, 
     &quot;type&quot; : &quot;2&quot;, //1一行一个 2:两个 3:三个 4:四个 9:五个
     &quot;style&quot; : { 
          &quot;bgColor&quot; : &quot;#ffffff&quot;, 
          &quot;padding&quot; : { //上 右 下 左
               &quot;0&quot; : &quot;0&quot;, 
               &quot;1&quot; : &quot;12&quot;, 
               &quot;2&quot; : &quot;15&quot;, 
               &quot;3&quot; : &quot;12&quot;, 
          }, 
          &quot;aspectRatio&quot; : &quot;3.223&quot;, //宽高比
          &quot;hGap&quot; : &quot;5&quot;, //列间隔
          &quot;vGap&quot; : &quot;5&quot; //行间隔
     }, 
     &quot;items&quot; : { 
     } 
 } 
</code></pre></table></div><h3>3.5.4、tangram_item_text</h3><div style="margin-left:30px;"><h2>单文本</h2>
<table width='100%' class='codestyle'><pre><code>
      {
        &quot;type&quot;: &quot;3001&quot;,
        &quot;text&quot;:&quot;盒粉秀&quot;,
        &quot;style&quot;: {
          &quot;bgColor&quot;: &quot;#004588&quot;,//背景颜色
          &quot;text_color&quot;:&quot;#00b9ff&quot;,//文字颜色
          &quot;gravity_h&quot;: 0,//水平方向的gravity 0(默认):左 ,1:居中,2:右
          &quot;text_size&quot;: 10,//文字大小,默认14
          &quot;type_face&quot;: 0,//0:普通,1:加粗,2:斜体,3:斜体加粗

        }
      }
</code></pre></table>
<h2>多文本</h2>
<table width='100%' class='codestyle'><pre><code>{
        &quot;type&quot;: &quot;3005&quot;,
    &quot;text_array&quot;:[&quot;盒粉秀&quot;,&quot;到底了&quot;],
        &quot;style&quot;: {
          &quot;bgColor&quot;: &quot;#004588&quot;,//背景颜色
          &quot;text_color&quot;:&quot;#00b9ff&quot;,//文字颜色
          &quot;gravity_h&quot;: 0,//水平方向的gravity 0(默认):左 ,1:居中,2:右
          &quot;text_size&quot;: 10,//文字大小,默认14
          &quot;type_face&quot;: 0,//0:普通,1:加粗,2:斜体,3:斜体加粗
        }
      }</code></pre></table></div><h3>3.5.5、tangram_item_card</h3><div style="margin-left:30px;"><h2>卡片</h2>
<table width='100%' class='codestyle'><pre><code> {
          &quot;type&quot;: &quot;3002&quot;,
          &quot;image&quot;: &quot;http://pic1.win4000.com/mobile/7/597edaf9682bd.jpg&quot;,
          &quot;text&quot;: &quot;成长圈&quot;,
          &quot;text1&quot;: &quot;写日记&quot;,
          &quot;open_url&quot;: &quot;https://w.namibox.com/lesson/micro_class2?view_type=db_tree&amp;db_tree=2866&quot;
        }</code></pre></table></div><h3>3.5.6、tangram_item_banner</h3><div style="margin-left:30px;"><h2>banner控件样式</h2>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;id&quot; : &quot;banner_cell&quot;, 
     &quot;type&quot; : &quot;3000&quot;, 
     &quot;image&quot; : &quot;https://gw.alicdn.com/tfs/TB1pdJFQpXXXXbUXpXXXXXXXXXX-750-243.png&quot;, 
     &quot;text&quot; : &quot;bannerView&quot;, 
     &quot;style&quot; : { 
          &quot;text_background&quot; : &quot;#324598&quot;, 
          &quot;text_color&quot; : &quot;#142563&quot;, 
          &quot;text_size&quot; : &quot;16&quot; 
     }
 } 
</code></pre></table></div><h3>3.5.7、tangram_item_round</h3><div style="margin-left:30px;"><h2>圆形菜单</h2>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;type&quot; : &quot;3004&quot;, 
     &quot;text&quot; : &quot;时光机&quot;, 
     &quot;image&quot; : &quot;https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1150650405,1345402837&amp;fm=27&amp;gp=0.jpg&quot;, 
     &quot;command&quot; : { 
     } 
 } 
</code></pre></table></div><h3>3.5.8、tangram_item_recommend</h3><div style="margin-left:30px;"><h2>父母圈</h2>
<table width='100%' class='codestyle'><pre><code>        {
          &quot;type&quot;: &quot;3003&quot;,
          &quot;text&quot;: &quot;时光机&quot;,
          &quot;image&quot;: &quot;https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1150650405,1345402837&amp;fm=27&amp;gp=0.jpg&quot;,
          &quot;other_info&quot;: [//下方图标文字组合,最多支持三个
            {
              &quot;text&quot;: &quot;666&quot;,
              &quot;image&quot;: &quot;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1510650622349&amp;di=956fc8fe49c1a53e55e1baabbb1c0651&amp;imgtype=0&amp;src=http%3A%2F%2Fb.hiphotos.baidu.com%2Fimage%2Fpic%2Fitem%2Ff11f3a292df5e0fe50717912566034a85edf72bc.jpg&quot;
            },
            {
              &quot;text&quot;: &quot;666&quot;,
              &quot;image&quot;: &quot;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1510650622349&amp;di=956fc8fe49c1a53e55e1baabbb1c0651&amp;imgtype=0&amp;src=http%3A%2F%2Fb.hiphotos.baidu.com%2Fimage%2Fpic%2Fitem%2Ff11f3a292df5e0fe50717912566034a85edf72bc.jpg&quot;
            }
          ],
          &quot;open_url&quot;: &quot;https://w.namibox.com/lesson/micro_class2?view_type=db_tree&amp;db_tree=2866&quot;,//图片的点击事件
          &quot;command1&quot;: {//右边区域的点击事件
            &quot;command&quot;: &quot;app_action&quot;,
            &quot;region_name&quot;: &quot;popup&quot;,
            &quot;view_name&quot;: &quot;i_click&quot;,
            &quot;url&quot;: &quot;https://w.namibox.com/v/schoolbook&quot;,
            &quot;name&quot;: &quot;tape&quot;,
            &quot;type&quot;: &quot;schoolbook&quot;
          }
        }</code></pre></table></div><h3>3.5.9、tangram_full</h3><div style="margin-left:30px;"><table width='100%' class='codestyle'><pre><code>{
  &quot;error_code&quot;: 200,
  &quot;error_message&quot;: &quot;&quot;,
  &quot;url&quot;: &quot;url&quot;,//下次刷新的url
  &quot;version&quot;: 1,//接口版本号
  &quot;update_time&quot;: 100,//自动刷新间隔
  &quot;can_refresh&quot;: true,//是否可以下拉刷新
  &quot;view_name&quot;: &quot;word&quot;,
  &quot;searchUrl&quot;: &quot;https://gw.alicdn.com/tfs/TB1pdJFQpXXXXbUXpXXXXXXXXXX-750-243.png&quot;,//搜索的跳转url
  &quot;search_hint&quot;: &quot;word&quot;,//搜索框文字
  &quot;title&quot;: &quot;word&quot;,//标题栏文字
  &quot;content_bg_color&quot;: &quot;#00b9ff&quot;,//背景颜色
  &quot;navigation_bar_mode&quot;: 4,//0 默认 1全屏导航栏渐变 2全屏标题隐藏-&gt;显示  3 搜索 4 全屏无返回 5 全屏带返回
  //&quot;navigation_bar_mode&quot;: 3,//0普通模式 1全屏 2 全屏带返回 3全屏带内容渐变
 // &quot;navigation_bar_extra_mode&quot;: 3,//0不指定 1带返回 2渐变标题样式 3显示、隐藏标题样式 4搜索样式
  &quot;menucontrol&quot;: {},//同menucontrol接口
  &quot;data&quot;: [
    {
      &quot;id&quot;: &quot;banner&quot;,//banner布局样式 type为2000,布局参考http://tangram.pingguohe.net/docs/layout-support/inner-support
      &quot;type&quot;: &quot;2000&quot;,
      &quot;style&quot;: {//指定控件样式
        &quot;indicatorRadius&quot;: &quot;5&quot;,//指示器半径
        &quot;indicatorColor&quot;: &quot;#ffffff&quot;,//指示器选中颜色
        &quot;defaultIndicatorColor&quot;: &quot;#66666666&quot;,//指示器未选中颜色
        &quot;indicatorGravity&quot;: &quot;center&quot;,//指示器位置
        &quot;indicatorPosition&quot;: &quot;inside&quot;,//指示器在内部显示还是外部
        &quot;indicatorMargin&quot;: 10,//指示器下边距
        &quot;indicatorGap&quot;: &quot;5&quot;,//指示器间隔
        &quot;infinite&quot;: &quot;true&quot;,//是否循环滚动
        &quot;autoScroll&quot;: &quot;3000&quot;,//自动滚动,单位毫秒
        &quot;bgColor&quot;: &quot;#ffffff&quot;,
        &quot;aspectRatio&quot;: &quot;1.7&quot;//控件宽高比
      },
      &quot;items&quot;: [
        {
          &quot;id&quot;: &quot;banner_cell&quot;,//banner的控件
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;https://gw.alicdn.com/tfs/TB1pdJFQpXXXXbUXpXXXXXXXXXX-750-243.png&quot;,//图片
          &quot;text&quot;: &quot;bannerView&quot;,//文字
          &quot;style&quot;: {//只有banner和文本控件可以设置内部文字的样式
            &quot;text_background&quot;: &quot;#324598&quot;,//文字的背景色
            &quot;text_color&quot;: &quot;#142563&quot;,//文字颜色
            &quot;text_size&quot;: &quot;16&quot;//文字大小
          },
          &quot;command&quot;: {//命令
            &quot;command&quot;: &quot;app_action&quot;,
            &quot;region_name&quot;: &quot;popup&quot;,
            &quot;view_name&quot;: &quot;i_click&quot;,
            &quot;url&quot;: &quot;https://w.namibox.com/v/schoolbook&quot;,
            &quot;name&quot;: &quot;tape&quot;,
            &quot;type&quot;: &quot;schoolbook&quot;
          }
        },
        {
          &quot;id&quot;: &quot;banner_cell&quot;,
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;https://gw.alicdn.com/tfs/TB1pdJFQpXXXXbUXpXXXXXXXXXX-750-243.png&quot;,
          &quot;text&quot;: &quot;bannerView&quot;,
          &quot;style&quot;: {
            &quot;text_background&quot;: &quot;#324598&quot;,
            &quot;text_color&quot;: &quot;#142563&quot;,
            &quot;text_size&quot;: &quot;16&quot;
          }
        },
        {
          &quot;id&quot;: &quot;banner_cell&quot;,
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;https://gw.alicdn.com/tfs/TB1pdJFQpXXXXbUXpXXXXXXXXXX-750-243.png&quot;,
          &quot;text&quot;: &quot;bannerView&quot;,
          &quot;style&quot;: {
            &quot;text_background&quot;: &quot;#324598&quot;,
            &quot;text_color&quot;: &quot;#142563&quot;,
            &quot;text_size&quot;: &quot;16&quot;
          }
        },
        {
          &quot;id&quot;: &quot;banner_cell&quot;,
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;https://gw.alicdn.com/tfs/TB1pdJFQpXXXXbUXpXXXXXXXXXX-750-243.png&quot;,
          &quot;text&quot;: &quot;bannerView&quot;,
          &quot;style&quot;: {
            &quot;text_background&quot;: &quot;#324598&quot;,
            &quot;text_color&quot;: &quot;#142563&quot;,
            &quot;text_size&quot;: &quot;16&quot;
          }
        }
      ]
    },
    {
      &quot;id&quot;: &quot;成长圈标题&quot;,//标题由一行一个的布局包裹文本控件组成
      &quot;type&quot;: &quot;1&quot;,
      &quot;style&quot;: {
        &quot;bgColor&quot;: &quot;#ffffff&quot;,
        &quot;padding&quot;: [//上,右,下,左
          &quot;15&quot;,
          &quot;12&quot;,
          &quot;10&quot;,
          &quot;12&quot;
        ]
      },
      &quot;items&quot;: [
        {
          &quot;type&quot;: &quot;3001&quot;,//3001表示文本控件
          &quot;text&quot;: &quot;成长圈&quot;,
          &quot;style&quot;: {
            &quot;bgColor&quot;: &quot;#ffffff&quot;,
            &quot;gravity_h&quot;: &quot;0&quot;,//0 左对齐 1 居中 2 右对齐
            &quot;text_size&quot;: &quot;14&quot;,//文本大小
            &quot;type_face&quot;: &quot;1&quot;,//0:普通,1:加粗,2:斜体,3:斜体加粗
            &quot;text_color&quot;: &quot;#333333&quot;
          }
        }
      ]
    },
    {
      &quot;id&quot;: &quot;成长圈&quot;,
      &quot;type&quot;: &quot;2&quot;,//一行两个控件的样式
      &quot;style&quot;: {
        &quot;bgColor&quot;: &quot;#ffffff&quot;,
        &quot;padding&quot;: [
          &quot;0&quot;,
          &quot;12&quot;,
          &quot;15&quot;,
          &quot;12&quot;
        ],
        &quot;aspectRatio&quot;: &quot;3.223&quot;,
        &quot;hGap&quot;: &quot;5&quot;,
        &quot;vGap&quot;: &quot;5&quot;
      },
      &quot;items&quot;: [
        {
          &quot;type&quot;: &quot;3002&quot;,//卡片控件
          &quot;image&quot;: &quot;http://pic1.win4000.com/mobile/7/597edaf9682bd.jpg&quot;,
          &quot;text&quot;: &quot;成长圈&quot;,
          &quot;text1&quot;: &quot;写日记&quot;,
          &quot;open_url&quot;: &quot;https://w.namibox.com/lesson/micro_class2?view_type=db_tree&amp;db_tree=2866&quot;
        },
        {
          &quot;type&quot;: &quot;3002&quot;,
          &quot;image&quot;: &quot;http://pic1.win4000.com/mobile/7/597edaf9682bd.jpg&quot;,
          &quot;text&quot;: &quot;艺术秀&quot;,
          &quot;text1&quot;: &quot;秀作品&quot;
        },
        {
          &quot;type&quot;: &quot;3002&quot;,
          &quot;image&quot;: &quot;http://pic1.win4000.com/mobile/7/597edaf9682bd.jpg&quot;,
          &quot;text&quot;: &quot;成长圈&quot;,
          &quot;text1&quot;: &quot;写日记&quot;
        },
        {
          &quot;type&quot;: &quot;3002&quot;,
          &quot;image&quot;: &quot;http://pic1.win4000.com/mobile/7/597edaf9682bd.jpg&quot;,
          &quot;text&quot;: &quot;艺术秀&quot;,
          &quot;text1&quot;: &quot;秀作品&quot;
        }
      ]
    },
    {
      &quot;id&quot;: &quot;活动圈标题&quot;,
      &quot;type&quot;: &quot;2&quot;,
      &quot;style&quot;: {
        &quot;bgColor&quot;: &quot;#ffffff&quot;,
        &quot;margin&quot;: [
          &quot;10&quot;,
          &quot;0&quot;,
          &quot;0&quot;,
          &quot;0&quot;
        ],
        &quot;padding&quot;: [
          &quot;15&quot;,
          &quot;15&quot;,
          &quot;10&quot;,
          &quot;12&quot;
        ]
      },
      &quot;items&quot;: [
        {
          &quot;type&quot;: &quot;3001&quot;,
          &quot;text&quot;: &quot;活动圈&quot;,
          &quot;style&quot;: {
            &quot;bgColor&quot;: &quot;#ffffff&quot;,
            &quot;gravity_h&quot;: &quot;0&quot;,
            &quot;text_size&quot;: &quot;14&quot;,
            &quot;type_face&quot;: &quot;1&quot;,
            &quot;text_color&quot;: &quot;#333333&quot;
          }
        },
        {
          &quot;type&quot;: &quot;3001&quot;,
          &quot;text&quot;: &quot;全部活动&gt;&quot;,
          &quot;style&quot;: {
            &quot;bgColor&quot;: &quot;#ffffff&quot;,
            &quot;gravity_h&quot;: &quot;2&quot;,
            &quot;text_size&quot;: &quot;12&quot;,
            &quot;type_face&quot;: &quot;0&quot;,
            &quot;text_color&quot;: &quot;#00b9ff&quot;
          }
        }
      ]
    },
    {
      &quot;id&quot;: &quot;banner2&quot;,
      &quot;type&quot;: &quot;2000&quot;,
      &quot;style&quot;: {
        &quot;indicatorRadius&quot;: &quot;3&quot;,
        &quot;indicatorColor&quot;: &quot;#ffffff&quot;,
        &quot;defaultIndicatorColor&quot;: &quot;#66666666&quot;,
        &quot;indicatorGravity&quot;: &quot;center&quot;,
        &quot;indicatorPosition&quot;: &quot;inside&quot;,
        &quot;indicatorMargin&quot;: &quot;10&quot;,
        &quot;indicatorGap&quot;: &quot;5&quot;,
        &quot;infinite&quot;: &quot;true&quot;,
        &quot;bgColor&quot;: &quot;#ffffff&quot;,
        &quot;aspectRatio&quot;: &quot;2&quot;,
        &quot;padding&quot;: [
          &quot;0&quot;,
          &quot;12&quot;,
          &quot;15&quot;,
          &quot;12&quot;
        ]
      },
      &quot;items&quot;: [
        {
          &quot;id&quot;: &quot;banner_cell&quot;,
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;https://gw.alicdn.com/tfs/TB1pdJFQpXXXXbUXpXXXXXXXXXX-750-243.png&quot;,
          &quot;text&quot;: &quot;bannerView&quot;,
          &quot;style&quot;: {
            &quot;text_background&quot;: &quot;#324598&quot;,
            &quot;text_color&quot;: &quot;#142563&quot;,
            &quot;text_size&quot;: &quot;16&quot;
          }
        },
        {
          &quot;id&quot;: &quot;banner_cell&quot;,
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;https://gw.alicdn.com/tfs/TB1pdJFQpXXXXbUXpXXXXXXXXXX-750-243.png&quot;,
          &quot;text&quot;: &quot;bannerView&quot;,
          &quot;style&quot;: {
            &quot;text_background&quot;: &quot;#324598&quot;,
            &quot;text_color&quot;: &quot;#142563&quot;,
            &quot;text_size&quot;: &quot;16&quot;
          }
        },
        {
          &quot;id&quot;: &quot;banner_cell&quot;,
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;https://gw.alicdn.com/tfs/TB1pdJFQpXXXXbUXpXXXXXXXXXX-750-243.png&quot;,
          &quot;text&quot;: &quot;bannerView&quot;,
          &quot;style&quot;: {
            &quot;text_background&quot;: &quot;#324598&quot;,
            &quot;text_color&quot;: &quot;#142563&quot;,
            &quot;text_size&quot;: &quot;16&quot;
          }
        },
        {
          &quot;id&quot;: &quot;banner_cell&quot;,
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;https://gw.alicdn.com/tfs/TB1pdJFQpXXXXbUXpXXXXXXXXXX-750-243.png&quot;,
          &quot;text&quot;: &quot;bannerView&quot;,
          &quot;style&quot;: {
            &quot;text_background&quot;: &quot;#324598&quot;,
            &quot;text_color&quot;: &quot;#142563&quot;,
            &quot;text_size&quot;: &quot;16&quot;
          }
        }
      ]
    },
    {
      &quot;id&quot;: &quot;藏宝图标题&quot;,
      &quot;type&quot;: &quot;2&quot;,
      &quot;style&quot;: {
        &quot;bgColor&quot;: &quot;#ffffff&quot;,
        &quot;margin&quot;: [
          &quot;10&quot;,
          &quot;0&quot;,
          &quot;0&quot;,
          &quot;0&quot;
        ],
        &quot;padding&quot;: [
          &quot;15&quot;,
          &quot;15&quot;,
          &quot;10&quot;,
          &quot;12&quot;
        ]
      },
      &quot;items&quot;: [
        {
          &quot;type&quot;: &quot;3001&quot;,
          &quot;text&quot;: &quot;藏宝图&quot;,
          &quot;style&quot;: {
            &quot;bgColor&quot;: &quot;#ffffff&quot;,
            &quot;gravity_h&quot;: &quot;0&quot;,
            &quot;text_size&quot;: &quot;13&quot;,
            &quot;type_face&quot;: &quot;1&quot;,
            &quot;text_color&quot;: &quot;#000000&quot;
          }
        },
        {
          &quot;type&quot;: &quot;3001&quot;,
          &quot;text&quot;: &quot;去寻宝&gt;&quot;,
          &quot;style&quot;: {
            &quot;bgColor&quot;: &quot;#ffffff&quot;,
            &quot;gravity_h&quot;: &quot;2&quot;,
            &quot;text_size&quot;: &quot;12&quot;,
            &quot;type_face&quot;: &quot;0&quot;,
            &quot;text_color&quot;: &quot;#00b9ff&quot;
          }
        }
      ]
    },
    {
      &quot;id&quot;: &quot;藏宝图&quot;,
      &quot;type&quot;: &quot;2000&quot;,//banner样式
      &quot;style&quot;: {
        &quot;pageRatio&quot;: &quot;0.34&quot;,//一页的显示比例
        &quot;bgColor&quot;: &quot;#ffffff&quot;,
        &quot;aspectRatio&quot;: &quot;4&quot;,
        &quot;scrollMarginLeft&quot;: 10,//滚动部分的左边距
        &quot;scrollMarginRight&quot;: 10,//滚动部分的右边距
        &quot;hasIndicator&quot;: &quot;false&quot;,//ios必须指定这个才能隐藏指示器,android不能传indicator开头的参数
        &quot;hGap&quot;: 5,//控件的横向间距
        &quot;padding&quot;: [
          &quot;0&quot;,
          &quot;0&quot;,
          &quot;15&quot;,
          &quot;0&quot;
        ]
      },
      &quot;items&quot;: [
        {
          &quot;id&quot;: &quot;banner_cell&quot;,
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;http://pic1.win4000.com/mobile/7/597edaf9682bd.jpg&quot;
        },
        {
          &quot;id&quot;: &quot;banner_cell&quot;,
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;http://pic1.win4000.com/mobile/7/597edaf9682bd.jpg&quot;
        },
        {
          &quot;id&quot;: &quot;banner_cell&quot;,
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;http://pic1.win4000.com/mobile/7/597edaf9682bd.jpg&quot;
        },
        {
          &quot;id&quot;: &quot;banner_cell&quot;,
          &quot;type&quot;: &quot;3000&quot;,
          &quot;image&quot;: &quot;http://pic1.win4000.com/mobile/7/597edaf9682bd.jpg&quot;
        }
      ]
    },
    {
      &quot;id&quot;: &quot;圆形&quot;,
      &quot;type&quot;: &quot;4&quot;,//一行四个
      &quot;style&quot;: {
        &quot;bgColor&quot;: &quot;#ffffff&quot;,
        &quot;vGap&quot;: 10,
        &quot;padding&quot;: [
          12,
          0,
          12,
          0
        ],
        &quot;margin&quot;: [
          10,
          0,
          10,
          0
        ]
      },
      &quot;items&quot;: [
        {
          &quot;type&quot;: &quot;3004&quot;,//3004是图片加下方居中文字的样式
          &quot;text&quot;: &quot;时光机&quot;,
          &quot;image&quot;: &quot;https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1150650405,1345402837&amp;fm=27&amp;gp=0.jpg&quot;,
          &quot;command&quot;: {
          }
        },
        {
          &quot;type&quot;: &quot;3004&quot;,
          &quot;text&quot;: &quot;惊呆了创意&quot;,
          &quot;image&quot;: &quot;https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1150650405,1345402837&amp;fm=27&amp;gp=0.jpg&quot;
        },
        {
          &quot;type&quot;: &quot;3004&quot;,
          &quot;text&quot;: &quot;历史上的今天&quot;,
          &quot;image&quot;: &quot;https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1150650405,1345402837&amp;fm=27&amp;gp=0.jpg&quot;
        },
        {
          &quot;type&quot;: &quot;3004&quot;,
          &quot;text&quot;: &quot;盒粉总动员&quot;,
          &quot;image&quot;: &quot;https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1150650405,1345402837&amp;fm=27&amp;gp=0.jpg&quot;
        }
      ]
    },
    {
      &quot;id&quot;: &quot;父母圈标题&quot;,
      &quot;type&quot;: &quot;1&quot;,
      &quot;style&quot;: {
        &quot;bgColor&quot;: &quot;#ffffff&quot;,
        &quot;padding&quot;: [
          &quot;15&quot;,
          &quot;12&quot;,
          &quot;10&quot;,
          &quot;12&quot;
        ]
      },
      &quot;items&quot;: [
        {
          &quot;type&quot;: &quot;3001&quot;,
          &quot;text&quot;: &quot;父母圈&quot;,
          &quot;style&quot;: {
            &quot;text_color&quot;: &quot;#333333&quot;,
            &quot;gravity_h&quot;: 0,
            &quot;text_size&quot;: 14,
            &quot;type_face&quot;: 1
          }
        }
      ]
    },
    {
      &quot;id&quot;: &quot;父母圈&quot;,
      &quot;type&quot;: &quot;1&quot;,
      &quot;style&quot;: {
        &quot;vGap&quot;: 5,
        &quot;bgColor&quot;: &quot;#ffffff&quot;,
        &quot;padding&quot;: [
          0,
          12,
          15,
          12
        ]
      },
      &quot;items&quot;: [
        {
          &quot;type&quot;: &quot;3003&quot;,//左边图片,右边是信息的样式
          &quot;text&quot;: &quot;时光机&quot;,
          &quot;image&quot;: &quot;https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1150650405,1345402837&amp;fm=27&amp;gp=0.jpg&quot;,
          &quot;other_info&quot;: [//右边最下面的小图标和文字的组合,最多支持三个
            {
              &quot;text&quot;: &quot;666&quot;,
              &quot;image&quot;: &quot;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1510650622349&amp;di=956fc8fe49c1a53e55e1baabbb1c0651&amp;imgtype=0&amp;src=http%3A%2F%2Fb.hiphotos.baidu.com%2Fimage%2Fpic%2Fitem%2Ff11f3a292df5e0fe50717912566034a85edf72bc.jpg&quot;
            },
            {
              &quot;text&quot;: &quot;666&quot;,
              &quot;image&quot;: &quot;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1510650622349&amp;di=956fc8fe49c1a53e55e1baabbb1c0651&amp;imgtype=0&amp;src=http%3A%2F%2Fb.hiphotos.baidu.com%2Fimage%2Fpic%2Fitem%2Ff11f3a292df5e0fe50717912566034a85edf72bc.jpg&quot;
            }
          ],
          &quot;command&quot;: {
          }
        },
        {
          &quot;type&quot;: &quot;3003&quot;,
          &quot;text&quot;: &quot;时光机&quot;,
          &quot;image&quot;: &quot;https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1150650405,1345402837&amp;fm=27&amp;gp=0.jpg&quot;,
          &quot;other_info&quot;: [
            {
              &quot;text&quot;: &quot;666&quot;,
              &quot;image&quot;: &quot;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1510650622349&amp;di=956fc8fe49c1a53e55e1baabbb1c0651&amp;imgtype=0&amp;src=http%3A%2F%2Fb.hiphotos.baidu.com%2Fimage%2Fpic%2Fitem%2Ff11f3a292df5e0fe50717912566034a85edf72bc.jpg&quot;
            },
            {
              &quot;text&quot;: &quot;666&quot;,
              &quot;image&quot;: &quot;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1510650622349&amp;di=956fc8fe49c1a53e55e1baabbb1c0651&amp;imgtype=0&amp;src=http%3A%2F%2Fb.hiphotos.baidu.com%2Fimage%2Fpic%2Fitem%2Ff11f3a292df5e0fe50717912566034a85edf72bc.jpg&quot;
            }
          ],
          &quot;command&quot;: {
          }
        },
        {
          &quot;type&quot;: &quot;3003&quot;,
          &quot;text&quot;: &quot;时光机&quot;,
          &quot;image&quot;: &quot;https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1150650405,1345402837&amp;fm=27&amp;gp=0.jpg&quot;,
          &quot;other_info&quot;: [
            {
              &quot;text&quot;: &quot;666&quot;,
              &quot;image&quot;: &quot;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1510650622349&amp;di=956fc8fe49c1a53e55e1baabbb1c0651&amp;imgtype=0&amp;src=http%3A%2F%2Fb.hiphotos.baidu.com%2Fimage%2Fpic%2Fitem%2Ff11f3a292df5e0fe50717912566034a85edf72bc.jpg&quot;
            },
            {
              &quot;text&quot;: &quot;666&quot;,
              &quot;image&quot;: &quot;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1510650622349&amp;di=956fc8fe49c1a53e55e1baabbb1c0651&amp;imgtype=0&amp;src=http%3A%2F%2Fb.hiphotos.baidu.com%2Fimage%2Fpic%2Fitem%2Ff11f3a292df5e0fe50717912566034a85edf72bc.jpg&quot;
            }
          ],
          &quot;command&quot;: {
          }
        },
        {
          &quot;type&quot;: &quot;3003&quot;,
          &quot;text&quot;: &quot;时光机&quot;,
          &quot;image&quot;: &quot;https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1150650405,1345402837&amp;fm=27&amp;gp=0.jpg&quot;,
          &quot;other_info&quot;: [
            {
              &quot;text&quot;: &quot;666&quot;,
              &quot;image&quot;: &quot;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1510650622349&amp;di=956fc8fe49c1a53e55e1baabbb1c0651&amp;imgtype=0&amp;src=http%3A%2F%2Fb.hiphotos.baidu.com%2Fimage%2Fpic%2Fitem%2Ff11f3a292df5e0fe50717912566034a85edf72bc.jpg&quot;
            },
            {
              &quot;text&quot;: &quot;666&quot;,
              &quot;image&quot;: &quot;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1510650622349&amp;di=956fc8fe49c1a53e55e1baabbb1c0651&amp;imgtype=0&amp;src=http%3A%2F%2Fb.hiphotos.baidu.com%2Fimage%2Fpic%2Fitem%2Ff11f3a292df5e0fe50717912566034a85edf72bc.jpg&quot;
            }
          ],
          &quot;open_url&quot;: &quot;https://w.namibox.com/lesson/micro_class2?view_type=db_tree&amp;db_tree=2866&quot;,
          &quot;command1&quot;: {
            &quot;command&quot;: &quot;app_action&quot;,
            &quot;region_name&quot;: &quot;popup&quot;,
            &quot;view_name&quot;: &quot;i_click&quot;,
            &quot;url&quot;: &quot;https://w.namibox.com/v/schoolbook&quot;,
            &quot;name&quot;: &quot;tape&quot;,
            &quot;type&quot;: &quot;schoolbook&quot;
          }
        }
      ]
    },
    {
      &quot;id&quot;: &quot;底部文字&quot;,
      &quot;type&quot;: &quot;1&quot;,
      &quot;style&quot;: {
        &quot;bgColor&quot;: &quot;#eeeeee&quot;,
        &quot;padding&quot;: [
          &quot;15&quot;,
          &quot;12&quot;,
          &quot;30&quot;,
          &quot;12&quot;
        ]
      },
      &quot;items&quot;: [
        {
          &quot;type&quot;: &quot;3005&quot;,//3005是特殊的文本控件,从文本数组中随机显示内容
          &quot;text_array&quot;: [
            &quot;能翻到底的都是学霸!&quot;,
            &quot;你已经游到盒底啦!&quot;,
            &quot;坚持到底就是胜利!&quot;,
            &quot;你已经游遍全世界啦!&quot;,
            &quot;这已经是我的底线啦!&quot;
          ],
          &quot;style&quot;: {
            &quot;gravity_h&quot;: &quot;1&quot;,
            &quot;text_size&quot;: &quot;13&quot;,
            &quot;type_face&quot;: &quot;1&quot;,
            &quot;text_color&quot;: &quot;#666666&quot;
          }
        }
      ]
    }
  ]
}
</code></pre></table></div></div></div><h1>4、数据字典</h1><div style="margin-left:20px;"></div><h1>5、产品的游戏性设计</h1><div style="margin-left:20px;"><h2>5.1、产品设计</h2><div style="margin-left:20px;"><h3>5.1.1、天天学单词等产品的游戏性设计</h3><div style="margin-left:30px;"><h1>天天学单词等产品的游戏性设计</h1>
<hr />
<h2>这个产品的目的是什么？ Why should we do this?</h2>
<ol>
<li>纳米盒从工具性产品走向为小学生提供内容服务的产品，<strong>向我们的用户提供优质的内容服务</strong>，是我们的核心价值;</li>
<li>针对小学生阶段用户的特点，让我们的内容服务从填鸭式的灌输知识，转换为用户主动的去学习去完成挑战的过程；</li>
<li>在我们的点读类产品走向付费之后，我们需要新的流量入口，我们需要一个能够吸引并持久留存用户的产品；</li>
</ol>
<h2>怎么才能达到我们的目的呢？ How to achieve the objective?</h2>
<ol>
<li>进一步提高内容质量（要认识到教师团队对产品的质量起着主要作用）
<ul>
<li>同步教材</li>
<li>精选内容</li>
</ul></li>
<li>让学习变成愉快的体验：
<ul>
<li>交互体验： 以用户主动发起交互为主，启发式的引导用户一步步的学习。</li>
<li>认知探索体验： 我们既讨厌一成不变的事情，又厌恶自己完全无法预测掌控的事情；</li>
<li>社交体验： 我们都害怕孤独，害怕被排斥，需要集体认同，想要找到与自己有共同想法的人；我们迫切的想要知道别人的想法，别人对自己的看法，我们甚至会为了融入集体而隐藏自己的真实想法，但是这会是比较危险的事情～</li>
</ul></li>
<li>基础产品免费可玩：
<ul>
<li>为虚拟商品付费的习惯是需要慢慢培养出来的，现阶段肯定是有一部分人不愿意为在线内容付费，也肯定有一部分人愿意为他们喜欢的优质产品付费，我们既要用免费的产品留住潜在的客户，又要为现在的客户提供差异化的服务，以标示他们不同于其他免费用户。</li>
<li>需要逐渐引导用户向客户转化。</li>
</ul></li>
</ol>
<h2>我们的设计方案是什么呢？ What is the proposal design?</h2>
<ol>
<li>内容质量的提高
<ul>
<li>题库平台2.0的建设，进一步提高对内容的管理能力</li>
</ul></li>
<li>产品的游戏性设计
<ul>
<li>使用原生APP设计全新的习题系统</li>
<li>更加鲜明的界面，更加流畅的操作体验，提供更好的交互操作体验。</li>
<li>关卡设计</li>
<li>有易到难，循序渐进</li>
<li>奖励系统 ？   目前貌似缺失</li>
<li>完成关卡获得奖励</li>
<li>达成积分目标奖励</li>
<li>达成积分排名目标奖励</li>
<li>达成成就目标奖励</li>
<li>达成连续登录目标奖励</li>
<li>PK系统</li>
<li>一对一在线实时PK</li>
<li>竞赛抢答</li>
<li>组队PK</li>
</ul></li>
<li>产品的持久留存用户与推广传播设计
<ul>
<li>体力系统</li>
<li>防止过度游戏</li>
<li>区分普通用户与付费客户</li>
<li>礼花卡收集系统</li>
<li>完成目标奖励礼花卡</li>
<li>持久留存用户</li>
<li>荣誉成就系统</li>
<li>积分排名系统</li>
<li>分享系统</li>
</ul></li>
</ol></div><h3>5.1.2、软件需求分析</h3><div style="margin-left:30px;"><h2>目的</h2>
<p>用软件工程师的语言描述游戏类产品第二阶段开发的新增以及变动需求。</p>
<h2>参考</h2>
<p>[天天背单词第一阶段技术文档](<a href="http://172.16.2.24:88/namibox/doc/wikis/daily-vocabulary-exercise">http://172.16.2.24:88/namibox/doc/wikis/daily-vocabulary-exercise</a> "天天背单词第一阶段技术文档")</p>
<h2>产品需求变动</h2>
<ol>
<li>体力是绑定在用户身上的属性，在用户使用的所有产品中共享体力</li>
<li>基础产品全部免费，改用道具包收费</li>
<li>宝箱不再由完成练习后自动触发，而是用户主动打开</li>
<li>打开宝箱可能需要消耗体力</li>
<li>体力奖励不再立即添加到用户当前体力值中，而是保存在用户的体力卡中，用户主动使用后才增加到当前体力值上。</li>
<li>使用体力卡增加的体力不受体力值上线影响</li>
<li>道具包（会员服务？）会影响用户的体力上限，中奖概率，宝箱打开消耗的体力，倒计时，救命星，答案提示</li>
<li>每人每天100个体力，闯每关需要5个体力，每5分钟恢复一个体力</li>
<li>积分改名为经验值, 经验值不会在每赛季开始时候清零，但是赛季排名是只根据当前赛季获得的经验值；</li>
<li>记录每本书的累计练习天数，而不是连续练习天数？</li>
</ol>
<h2>新增产品需求</h2>
<ol>
<li>1对1在线PK系统
<ul>
<li>实时在线PK</li>
<li>根据用户的经验值自动匹配实力相当的对手</li>
<li>如果超过一定的时间找不到对手，则以一条历史PK记录为数据源，模拟PK对手</li>
<li>PK胜利一方会获得经验值，PK失败一方会扣除相应的经验值，模拟对手不会被扣除经验值</li>
<li>PK胜利数据要记录在用户的荣耀/成就中</li>
</ul></li>
<li>我的荣耀/成就
<ul>
<li>PK胜利记录在我的荣耀中</li>
<li>达成某些数据时候触发特定成就</li>
</ul></li>
<li>装备增强/道具包
<ul>
<li>增强版特权</li>
<li>超强版特权</li>
<li>同时购买多个道具包，效果不叠加，以当前有效的最强的特权为</li>
<li>道具包购买后自动生效？还是主动打开后生效？</li>
<li>道具包的最短时间区间？</li>
</ul></li>
</ol>
<h2>对应的软件需求变动</h2>
<ol>
<li><del>建立表user_game_profile扩展用户属性, 包含sp, sp_updated_at字段来管理体力</del></li>
<li><del>原virtualRole 不再是用户-商品关联，而是用户-milession关联；产品是否免费有milession是否包含product来决定；</del></li>
<li>新增打开宝箱的接口，完成一次关卡后返回打开宝箱的接口URL而不是宝箱内容</li>
<li>需要判断用户当前是否有体力开启宝箱；要设置宝箱的有效时间，防止不停尝试打开宝箱</li>
<li>使用礼花卡记录，以及用户拥有的礼花卡关联表来管理用户拥有的体力卡，把体力卡当作一种特殊的礼花卡来对待</li>
<li>使用礼花卡获得体力立即增加到体力值中，但是当用户体力超过体力上限时候，体力是不会继续恢复的</li>
<li>根据用户特权返回不同的系统配置</li>
<li>修改redis配置即可</li>
<li>virtualRole中的score永远是总经验值，当前赛季获得经验值只保存在redis中</li>
<li>为virtualRole新增累计练习天数字段, 暂时保留连续练习天数字段及其相关功能。</li>
<li>其它：
<ul>
<li>未登录用户还是会创建virtualRole, 但是没有user_id的virtualRole不会记录游戏数据，只用做记录用户添加的书本的功能；新用户注册后将用户的id赋值给virualRole； 老用户登录后要查看是否该用户已经有该产品对应的virtualRole, 如果有则切换为原有的virtualRole, 用户在未登录情况下的数据丢失，如果没有，则将这个virtualRole赋值给该用户，他在未登录之前玩的数据不会丢失。</li>
<li>未登录用户的体力值？a: 一直为满; b: 一直为空; c: 不显示； d: ？？</li>
</ul></li>
</ol>
<h3>修改难易程度</h3>
<ul>
<li>容易（按由易到难顺序）： 8, 10, 7，</li>
<li>困难（按有难到易顺序）： 11， </li>
</ul>
<h2>对应的新增软件需求</h2>
<ol>
<li>在线PK系统
<ul>
<li>PK系统的出题机制</li>
<li>PK 双方使用的是同一套题目</li>
<li>不同等级的PK专区出题范围的区别</li>
<li>为一次PK出的题目要保存在数据库中，以便后续根据PK记录来模拟PK</li>
<li>PK系统的匹配机制</li>
<li>为每个产品的每个PK专区设置redis缓存，记录在匹配队列中的人，根据score排名找最接近的玩家进行PK</li>
<li>匹配命中后，自动脱离队列</li>
<li>PK结束后，不会自动重新进入匹配队列</li>
<li>匹配等待时间不能超过【60】（可配置）秒，超时后自动获得一个历史PK记录进行PK</li>
<li>用户点击开始匹配时候，客户端开始与服务器建立websockt连接</li>
<li>服务器端将匹配结果通过websocket发送给客户端</li>
<li>服务器端会根据负载以及超时状况，主动断开websocket连接；但是客户端也要尽量不占用websocket连接，长连接资源比较稀缺，使用完毕后要及时断开，需要的时候再重连。</li>
<li>客户端与服务器建立websocket连接的时候，必须附带上http cookies中的sessions等信息，以方便权限检验；（在http/ws使用相同域名的时候，浏览器貌似可以自动带上cookies信息）</li>
<li>服务器负载过高超过能力上限的时候，会为玩家设计模拟PK，而不是真实的人人对抗。</li>
<li>PK系统的实时通讯机制</li>
<li>当玩家匹配完成后，获得一个"PK房间" ID</li>
<li>每个玩家根据”PK房间" ID 来获取考试题目信息对应的URL</li>
<li>每个玩家下载完资源后，准备好开始PK时候，要通知服务器自己准备好了</li>
<li>当服务器端发现所有参赛玩家都准备好后，发送消息通知玩家可以开始了</li>
<li>玩家每做完一道题目，客户端都要将，做题的详细新发送给服务器</li>
<li>当玩家做完最后一道题目时候，客户端要通知服务器</li>
<li>服务器通知其它玩家PK结束，客户端收到PK结束消息后不允许玩家继续做题</li>
<li>PK总限定时间到达后，如果PK尚没有结束，服务器端不会主动发送消息告诉客户端PK结束，但是限定时间到达后，服务器不会再处理客户端发送的做题进度数据，并根据情况可能主动断开与客户端的连接，正常流程下客户端应该主动通知服务器端PK超时。</li>
<li>PK进行中任何参与PK的一个玩家中途退出（主动断开或者网络中断），PK立即结束(似乎体验不好)？重连(可能造成网络拥堵)？</li>
<li>无论PK是正常结束（分出胜负），还是超时结束，网络中断，客户端可以在PK结束后查询到PK结果：如果任何一个参与PK的玩家所在的客户端主动通知过服务器端PK结束，服务器端会及时生产PK结果；如果没有任何一个参与PK的玩家所在的客户端主动通知服务器端PK结束，服务器端不可能主动为PK生成结果数据，但是当任何人查询这次PK的结果时候，服务器可以租判断PK是否已经结束，并根据情况生成PK结果记录；在生成PK结果之前所有PK信息保存在服务器内存中，服务器重启或者关闭都会造成未保存的PK信息丢失。</li>
<li>服务器在生成PK结果记录的同时会根据PK结果增加或者减少用户的经验值，并为胜利一方创建荣耀记录。</li>
<li>PK结果产生后，服务器会将PK结果发送给每个玩家</li>
<li>PK结束后中任何一个参与PK的玩家离开（主动断开或者网络中断），服务器端都会断开与所有玩家的连接。</li>
<li>模拟PK情况下，客户端与服务器端直接不存在websocket连接，所有数据还是走HTTP方式。</li>
</ul></li>
<li>我的荣耀/成就
<ul>
<li>新增数据库表，记录用户达成的成就，获得的荣誉</li>
<li>成就是用户的跨产品全局属性，但是具体每个成就都是在某个产品中完成的。</li>
<li>完成成就可以给予一定的系统积分奖励。</li>
<li>客户端提交的每次数据都有可能触发新成就达成的事件， 服务器端会将新达成的成就返回给客户端。</li>
<li>用户可以查看自己，以及其它玩家的成就</li>
<li>新增页面“我的成就”</li>
</ul></li>
<li>装备增强/道具包
<ul>
<li>使用系统已有的虚拟商品来管理道具包</li>
<li>新增web页面来展示道具包</li>
</ul></li>
</ol></div></div><h2>5.2、数据模型</h2><div style="margin-left:20px;"><h3>5.2.1、数据模型</h3><div style="margin-left:30px;"><h2>迭代二新增数据模型</h2>
<ul>
<li>
<p>user_game_profile: 用户游戏属性扩展表</p>
<ul>
<li>PK</li>
<li>user_id</li>
<li>sp</li>
<li>sp_updated_at</li>
<li>其它，待扩展</li>
</ul>
</li>
<li>
<p>pvp: 记录一次两个用户之间的PK，第二个用户可能是空</p>
<ul>
<li>PK</li>
<li>milession_id</li>
<li>first_user_id</li>
<li>second_user_id</li>
<li>first_virtual_role_id</li>
<li>second_virtual_role_id</li>
<li>first_user_score： 在开始这次PK时候的经验值</li>
<li>second_user_score</li>
<li>room_level： PK房间的等级</li>
<li>create_at： PK所需要的数据创建的时间</li>
<li>start_at： PK开始的时间，没开始的时候为null</li>
<li>end_at: PK结束的时间, 没结束的时候为null</li>
<li>external_info: 详细数据</li>
<li>exercises_list： 练习题列表，只记录ID</li>
<li>results: 双方的答题详细数据</li>
</ul>
</li>
<li>user_glory： 个人荣耀/成就
<ul>
<li>PK</li>
<li>user_id</li>
<li>virtual_role_id</li>
<li>achieved_at</li>
<li>name</li>
<li>description</li>
</ul></li>
</ul>
<h2>迭代二修改的数据模型</h2>
<ul>
<li>
<p>jct4_vritual_character:</p>
<ul>
<li>删除 sp, sp_update_at字段</li>
<li>product_id ==> milession_id, 关联于milession，而不是product, 大部分产品是免费产品，不会建立对应的product</li>
<li>添加score_current_season: 当前赛季得分</li>
<li>添加total_plaied_days: 累计练习天数</li>
</ul>
</li>
<li>
</li>
</ul></div></div><h2>5.3、接口定义</h2><div style="margin-left:20px;"><h3>5.3.1、PK相关接口</h3><div style="margin-left:30px;"><h2>模拟PK</h2>
<h3>WEB  ===> APP 接口</h3>
<p><strong>进入pk房间列表</strong></p>
<table width='100%' class='codestyle'><pre><code>js_app_send({
            command:&quot;open_vocab_pk&quot;,
            id:&quot;1234&quot;,                                 // vocab ID
            url: &quot;ws://wss.namibox.com/vocab/{vocab_id}/pvp/require/&quot;,           // vocab URL
            status: &quot;免费&quot;      // “已购买”， “未购买“， “免费”
        });</code></pre></table>
<h3>获取指定产品的pvp房间列表</h3>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>/vocab/{vocab_id}/pvp_room/list/</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>
<p>GET </p>
<p><strong>返回示例（大概格式）</strong></p>
</li>
</ul>
<table width='100%' class='codestyle'><pre><code>  {
    error_code: 0,
    message: &quot;success&quot;,
    limit_time: 300,    // 倒计时，单位秒
    rooms: [
        {
            name: &quot;新手房间&quot;,  // 房间名称
            level: 1,   // 房间级别
            min_score: 100,  // 进入房间的最低经验值
            max_score: 1000, // 进入房间的最高经验值
        },
    ]
  }</code></pre></table>
<h3>创建PK</h3>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>/vocab/{vocab_id}/pvp/require/</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>POST </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
<th style="text-align: left;">默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">room_level</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>房间等级</td>
<td style="text-align: left;">1</td>
</tr>
<tr>
<td style="text-align: left;">simulate</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">boolean</td>
<td>是否是模拟PK</td>
<td style="text-align: left;">True</td>
</tr>
<tr>
<td style="text-align: left;">virutal_role_1</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">ID</td>
<td>虚拟角色1的ID</td>
<td style="text-align: left;">None</td>
</tr>
<tr>
<td style="text-align: left;">virutal_role_2</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">ID</td>
<td>虚拟角色2的ID</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>这个API有两种调用模式：</p>
<ul>
<li>已经登录用户通过APP/web 调用，创建一条模拟PK，所有参数都可以不提供，服务器自动判断。</li>
<li>匹配服务器调用，为匹配的两个用户创建记录, 所有参数都是必须的</li>
</ul>
<p><strong>返回示例 - 模拟PK （大概格式）</strong></p>
</li>
</ul>
<table width='100%' class='codestyle'><pre><code>  {
    error_code: 0,
    message: &quot;success&quot;,
    id: 111, 
    exercises: [{},{},...], // 练习题列表
    opponent: {
        user_id: 12321， // 用户ID
        nickname: &quot;盒子小宝&quot;,  // 昵称
        head_image: &quot;http://...head.img&quot;, // 头像
        score: 500, // 对方经验值
    },
    opponent_results: [
    {
        correct: true,
        speed: 1.123,
        exercise_id: 123,
        index: 0,
        user_answer: &quot;&quot;
    }，
    ] // 每一道题目的耗时及正确与否
  }</code></pre></table>
<h3>获取PK的练习题数据</h3>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>/vocab/{vocab_id}/pvp/{pvp_id}/get/</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>
<p>GET</p>
<p><strong>返回示例（大概格式）</strong></p>
</li>
</ul>
<table width='100%' class='codestyle'><pre><code>  {
    error_code: 0,
    message: &quot;success&quot;,
    id: 111, 
    exercises: [{},{},...], // 练习题列表
  }</code></pre></table>
<h3>提交PK结果</h3>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>/vocab/{vocab_id}/pvp/{pvp_id}/submit/</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>POST </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">result</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">object</td>
<td>结果详细信息</td>
</tr>
</tbody>
</table>
<p><strong>用户提交的PK结果示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    results: [
    {
        correct: true,
        speed: 1.123,
        exercise_id: 123,
        index: 0,
        user_answer: &quot;&quot;
    }，
    ] // 每一道题目的耗时及正确与否
  }</code></pre></table>
<p><strong>返回示例 - 用户提交场景下</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    error_code: 0,
    message: &quot;success&quot;,
    win: true/false,
    earned_score: 10, // 赢得的积分，已经加到总积分；失败时候是负值，代表扣除积分。
  }</code></pre></table>
<h2>实时PK</h2>
<h3>开始匹配， 即建立websocket连接</h3>
<p><strong> URL: </strong></p>
<ul>
<li><code>ws(s)://wss.namibox.com/vocab/{vocab_id}/pvp/require/</code></li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
<th style="text-align: left;">默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">room_level</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>房间等级</td>
<td style="text-align: left;">自动匹配</td>
</tr>
<tr>
<td style="text-align: left;">vocab_id</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>产品ID</td>
<td style="text-align: left;">从url里获取</td>
</tr>
<tr>
<td style="text-align: left;">session_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>当前HTTP请求中记录在cookie里的session</td>
<td style="text-align: left;">浏览器会自动添加在header里</td>
</tr>
</tbody>
</table>
<p><strong>结果</strong></p>
<ol>
<li>成功建立连接</li>
<li>服务器拒绝建立连接，可能由于权限验证没通过，数据不合法，等其它原因拒绝建立连接。</li>
<li>无法连接到服务器</li>
</ol>
<h3>成功建立起websockets 连接后</h3>
<p><strong> 状态迁移图 </strong></p>
<p>![pvp-state-machine](<a href="http://doc.namibox.com/Public/Uploads/2017-04-14/58f06c357b951.png">http://doc.namibox.com/Public/Uploads/2017-04-14/58f06c357b951.png</a> "pvp-state-machine")</p>
<p><strong> 消息 统一格式 </strong></p>
<ul>
<li>纯文本，utf8编码，JSON格式
<table width='100%' class='codestyle'><pre><code>{
type: &quot;mesage_name&quot;， // 消息名称
data: {}, // 消息详细数据
}</code></pre></table></li>
</ul>
<p><strong>消息名称 以及 发送方向, 及其详细数据包含的字段</strong></p>
<ol>
<li>entered/<del>new_user_enter</del>: 服务器 ==> 客户端：
<ul>
<li>user_id:</li>
<li>virtual_role_id: （目前只有自己会收到）</li>
<li>nick_name: （目前只有自己会收到）</li>
<li>head_iamge: （目前只有自己会收到）</li>
<li>新用户进入时候，该用户收到entered消息，该房间内的其它所有用户收到new_user_enter消息</li>
</ul></li>
<li>start_match: 客户端 ==> 服务器
<ul>
<li>room_level:  要匹配的房间等级</li>
</ul></li>
<li>matched：  服务器 ==> 客户端
<ul>
<li>opponent_virtual_role_id: 112  对手ID</li>
</ul></li>
<li><del>match_timeout</del>：  客户端 <==> 服务器
<ul>
<li>没有内容, 服务器将客户端踢出匹配队列，客户端如果不处理的话会一直匹配不到</li>
</ul></li>
<li>force_quit_match:  服务器 ==> 客户端
<ul>
<li>reason:  “在其它终端登录并进行PVP匹配”
服务器将客户端踢出匹配队列，客户端如果不处理的话会一直匹配不到</li>
</ul></li>
<li>created_pvp_record:   服务器 ==> 客户端
<ul>
<li>pvp_id: 222,  客户端根据这个ID可以获取PK的练习题数据</li>
</ul></li>
<li>create_pvp_record_failed:   服务器 ==> 客户端
<ul>
<li>debug_info: "", // 一些调试信息，线上环境不会包含这些信息</li>
<li>服务器会主动断开与客户端的连接</li>
</ul></li>
<li><del>downloaded_game_data</del>：   客户端 ==> 服务器
<ul>
<li>没有内容</li>
</ul></li>
<li>ready_to_play:   客户端 ==> 服务器
<ul>
<li>没有内容</li>
</ul></li>
<li>start_game:   服务器 ==> 客户端
<ul>
<li>没有内容</li>
</ul></li>
<li>game_step：   客户端 ==> 服务器
<ul>
<li>exercise_id: 312312,</li>
<li>index: 0,  第几题</li>
<li>correct: true, 是否正确</li>
<li>speeds: 1.339, 耗时，单位秒</li>
</ul></li>
<li>opponent_game_step: 服务器 ==> 客户端
<ul>
<li>exercise_id: 312312,</li>
<li>index: 0,  第几题</li>
<li>correct: true, 是否正确</li>
<li>speeds: 1.339, 耗时，单位秒</li>
</ul></li>
<li>game_over：  客户端 ==> 服务器
<ul>
<li>total_seconds: 39.323, 总耗时， 单位：秒</li>
<li>total_correct: 8, 总正确题目数目</li>
<li>correct_rate: 80%, 正确比率</li>
</ul></li>
<li><del>game_timeout</del>:  客户端  <==> 服务器
<ul>
<li>timeout_seconds: 150,  设定的比赛时长, 也是当前已使用的时间</li>
</ul></li>
<li>game_finished:  服务器 ==> 客户端
<ul>
<li>win: true/false,  接受者是否赢得了比赛， 超时情况下大家都没有赢。</li>
<li>earned_score: 10, 赢得经验</li>
<li>result_id: 222, 等同于pvp_id,</li>
</ul></li>
<li>game_saved：  服务器 ==> 客户端
<ul>
<li>result_id: 222, 等同于pvp_id,</li>
</ul></li>
<li>game_save_failed：  服务器 ==> 客户端
<ul>
<li>debug_info: "", // 一些调试信息，线上环境不会包含这些信息</li>
<li>服务器会主动断开与客户端的连接</li>
</ul></li>
<li>leave_game: 客户端 ==> 服务器
<ul>
<li>当用户离开一次pk时候客户端要发送这个消息给服务器，否则还会收到来着这个pk频道的消息</li>
</ul></li>
<li>opponent_leave_game: 服务器 ==> 客户端
<ul>
<li>当对手离开房间时候，服务器会转发此消息给PK的另一方</li>
</ul></li>
<li>challenge:  客户端 ==> 服务器
<ul>
<li>challenge_to  挑战对象的virtual_role_id</li>
</ul></li>
<li>be_challenged: 服务器 ==》客户端
<ul>
<li>challenge_from: 挑战发起者的 vritual_role_id</li>
<li>challenge_to: 被挑战者的 virtual_role_id</li>
<li>服务器会转发挑战给指定的被挑战者</li>
</ul></li>
<li>accept_challenge:  客户端 ==》 服务器
<ul>
<li>challenge_from: 挑战发起者的 vritual_role_id</li>
<li>challenge_to: 被挑战者的 virtual_role_id</li>
<li>当用户决定接受来自某人的挑战时候，客户端将消息发送给服务器</li>
</ul></li>
<li>refuse_challenge:  客户端 ==》 服务器
<ul>
<li>challenge_from: 挑战发起者的 vritual_role_id</li>
<li>challenge_to: 被挑战者的 virtual_role_id</li>
<li>当用户拒绝来自某人的挑战时候，客户端将消息发送给服务器</li>
</ul></li>
<li>challenge_accepted:  服务器 ==》 客户端
<ul>
<li>challenge_from: 挑战发起者的 vritual_role_id</li>
<li>challenge_to: 被挑战者的 virtual_role_id</li>
<li>当我发起的挑战被对手接受时候，服务器将消息发送给客户端</li>
</ul></li>
<li>challenge_refused:  服务器 ==》 客户端
<ul>
<li>challenge_from: 挑战发起者的 vritual_role_id</li>
<li>challenge_to: 被挑战者的 virtual_role_id</li>
<li>当我发起的挑战被对手拒绝时候，服务器将消息发送给客户端</li>
</ul></li>
<li>play_again:  客户端 ==》 服务器
<ul>
<li>play_again是一种特殊的挑战；当用户想与当前正在比赛的玩家再玩一把时候，客户端发送这个消息给服务器，服务器会将这个消息翻译为"challenge"并自动填上"challenge_to"信息，此后流程同挑战流程；</li>
</ul></li>
<li>user_leave: 服务器 ==》 客户端
<ul>
<li>user_id:</li>
<li>当一个用户端口连接时候，其它用户会收到user_leave消息。</li>
</ul></li>
<li>login_on_other_device:  服务器 ==》 客户端
<ul>
<li>当一个用户登录到服务器上时候，会向其它所有自己已经登录的设备发送这个消息，服务器会主动断开在其它设备上的连接。在断开前，服务器会处理必要的收尾工作，包括结束正在进行的游戏，退出匹配队列，发送离开消息等。</li>
</ul></li>
<li>exception： 客户端 <==> 服务器
<ul>
<li>发送异常的端要主动断开连接</li>
</ul></li>
<li>badmsg: 服务器 ==》客户端
<ul>
<li>错误的信息类型</li>
</ul></li>
</ol></div><h3>5.3.2、新增其它接口列表</h3><div style="margin-left:30px;"><ul>
<li><del>/vocab/get_current_sp/      获得当前体力</del></li>
<li><del>/vocab/{vocab_id}/increase_sp/{value}/      增加体力值</del></li>
<li><del>/vocab/{vocab_id}/reduce_sp/{value}/            扣除体力值</del></li>
<li>/vocab/{vocab_id}/lottery/?lottery_id=1                   抽奖</li>
</ul></div><h3>5.3.3、数学口算填空题 接口定义</h3><div style="margin-left:30px;"><h2>打开数学口算原生入口接口</h2>
<ul>
<li>
<p>打开速算游戏闯关</p>
<pre><code class="language-json">{
command: &quot;open_game_normal_mode&quot;,
id: &quot;{{ vocab_id }}&quot;,
category: &quot;小学数学口算&quot;,
url: &quot;https://www.namibox.com/vocab/{{ vocab_id }}/get/&quot;,
}</code></pre></table>
<ul>
<li>其中url为获得关卡列表的url。</li>
</ul>
</li>
<li>打开速算游戏PK
<pre><code class="language-json">{
command: &quot;open_game_pvp_mode&quot;,
id: &quot;{{ vocab_id }}&quot;,
category: &quot;小学数学口算&quot;,
url: &quot;https://www.namibox.com/vocab/{{ vocab_id }}/pvp_room/list/&quot;,
}</code></pre></table>
<ul>
<li>其中 url为获得pvp房间列表的url, websocket服务器的url由房间列表url返回的内容中包括。</li>
</ul></li>
</ul>
<h2>数学口算填空题 题型接口</h2>
<p>为支持口算类产品的游戏性设计，在原有的数学口算模板题基础上，新增 “数学口算填空题” 题型接口， 其格式如下：</p>
<pre><code class="language-json">{
      &quot;difficulty_level&quot;: &quot;普通&quot;,
      &quot;question&quot;: {
        &quot;content&quot;: &quot;请给出正确答案&quot;,
        &quot;prompt&quot;: &quot;请给出正确答案（不约分）&quot;,
        &quot;content_type&quot;: &quot;文字&quot;
      },
      &quot;choices&quot;: null,
      &quot;answer&quot;: &quot;1/12＋5/12＝[6/12]&quot;,
      &quot;type&quot;: &quot;数学视算模板题&quot;,
      &quot;id&quot;: 184252
},</code></pre></table>
<p>“数学口算填空题” 与原来的 “英文单词默写题” 大致相同，内容有字母改为数字以及数学符号。
其中 "answer" 字段中：</p>
<ul>
<li>'/' 代表分子分母分割线</li>
<li>'[]' 中的内容为要用户填写的答案</li>
</ul></div></div></div><h1>6、APPIM相关</h1><div style="margin-left:20px;"><h2>6.1、自定义消息：分享信息1</h2><div style="margin-left:20px;"><p>`</p>
<p><strong>简要描述：</strong> </p>
<ul>
<li>IM自定义消息：分享信息 </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>customeType</strong></td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>自定义消息类型：1:分享信息</td>
</tr>
<tr>
<td style="text-align: left;">url_link</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>链接地址</td>
</tr>
<tr>
<td style="text-align: left;">share_title</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>标题</td>
</tr>
<tr>
<td style="text-align: left;">url_image</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>图片</td>
</tr>
<tr>
<td style="text-align: left;">share_content</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>内容描述</td>
</tr>
<tr>
<td style="text-align: left;"><strong>remind_message</strong></td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>提示信息</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong>
分享和抖一抖的返回示例（历史遗留问题，暂不修改）</p>
<table width='100%' class='codestyle'><pre><code> {&quot;customeType&quot;:&quot;1&quot;,
    &quot;remind_message&quot;:&quot;你收到一条成长圈消息，请升级APP查看！&quot;,
   &quot;url_link&quot;:@&quot;https://w.namibox.com/diary/comment/1736828?x=zLovgAAAAABs&quot;,
  &quot;share_title&quot;:@&quot;这是成长圈&quot;,
   &quot;url_image&quot;:&quot;&quot;,
    &quot;share_content&quot;:&quot;这是成长圈,欢迎查看，更多内容等你！&quot;}</code></pre></table>
<p><strong>离线推送信息</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">desc</td>
<td style="text-align: left;">string</td>
<td>离线推送消息：分享的为"[链接]share_title",抖一抖为"对方抖了你一下" ,无法识别的类型为：remind的信息</td>
</tr>
<tr>
<td style="text-align: left;">ext</td>
<td style="text-align: left;">string</td>
<td>扩展信息：chat_id:聊天室ID    chat_type:聊天类型 1：单聊 2：群聊，需要转成json字符串</td>
</tr>
</tbody>
</table>
<p><strong>离线推送文档参考</strong></p>
<p>[iOS](<a href="https://cloud.tencent.com/document/product/269/1577#4.3-.E6.AF.8F.E6.9D.A1.E7.A6.BB.E7.BA.BF.E6.8E.A8.E9.80.81.E5.B1.9E.E6.80.A7">https://cloud.tencent.com/document/product/269/1577#4.3-.E6.AF.8F.E6.9D.A1.E7.A6.BB.E7.BA.BF.E6.8E.A8.E9.80.81.E5.B1.9E.E6.80.A7</a> "iOS")</p>
<p>[Android](<a href="https://cloud.tencent.com/document/product/269/3899#3.3-.E7.A6.BB.E7.BA.BF.E6.8E.A8.E9.80.81.E5.86.85.E5.AE.B9.E8.AF.B4.E6.98.8E10">https://cloud.tencent.com/document/product/269/3899#3.3-.E7.A6.BB.E7.BA.BF.E6.8E.A8.E9.80.81.E5.86.85.E5.AE.B9.E8.AF.B4.E6.98.8E10</a> "Android")</p>
<p>ext 内容示例：</p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;chat_id&quot; = &quot;yxs_3128019&quot;;
    &quot;chat_type&quot; = 1;
}</code></pre></table>
<p><strong>备注</strong> </p>
<ul>
<li>更多返回错误代码请看首页的错误代码描述</li>
</ul>
<p>`</p></div><h2>6.2、自定义消息：气泡</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>自定义消息：IM气泡:待定</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">customeType</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>自定义消息类型：999、设置</td>
</tr>
<tr>
<td style="text-align: left;">content</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">list</td>
<td>bubble :气泡</td>
</tr>
<tr>
<td style="text-align: left;">remind_message</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>提示信息</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>
{ &quot;customeType&quot;:999,
    &quot;remind_message&quot;:&quot;你的版本过低请升级后查看&quot;,
    &quot;content&quot;:{&quot;bubble&quot;:0}

}</code></pre></table>
<p><strong>返回说明</strong></p>
<table width='100%' class='codestyle'><pre><code>bubble:
0;默认
1：浪花朵朵
2：粉色梦幻
3：快乐柠檬</code></pre></table></div><h2>6.3、自定义消息：名片3</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>自定义消息：名片</li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">customeType</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>自定义消息类型： 3、好友名片</td>
</tr>
<tr>
<td style="text-align: left;">friend_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>好友id</td>
</tr>
<tr>
<td style="text-align: left;">face</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>头像</td>
</tr>
<tr>
<td style="text-align: left;">nickname</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>昵称</td>
</tr>
<tr>
<td style="text-align: left;">background</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>0:无(绿色) 1:V(黄色) 2:班级圈(紫色) 3:认证教师(蓝色)</td>
</tr>
<tr>
<td style="text-align: left;">remind_message</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>提示信息</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong>
分享和抖一抖的返回示例</p>
<table width='100%' class='codestyle'><pre><code> {&quot;customeType&quot;:&quot;3&quot;,
    &quot;remind_message&quot;:&quot;[对方向你推荐了一位好友,请升级后查看]&quot;,
  &quot;nickname&quot;:&quot;大锤&quot;,
   &quot;face&quot;:&quot;https://www.jikg.com/dachui.png&quot;,
   &quot;background&quot;:&quot;1&quot;,
   &quot;friend_id&quot;:&quot;nb6666666&quot;}</code></pre></table>
<p><strong>备注</strong> </p>
<ul>
<li>更多返回错误代码请看首页的错误代码描述</li>
</ul>
<p>`</p></div><h2>6.4、自定义消息：群消息@某人4</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>IM自定义消息：群消息@某人</li>
</ul>
<p><strong>参数：</strong> </p>
<ul>
<li>用户表，储存用户信息</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">customeType</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>4</td>
<td>自定义消息类型：群消息@某人</td>
</tr>
<tr>
<td style="text-align: left;">remind_message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>提示信息</td>
</tr>
</tbody>
</table>
<p>remind_message的显示规则为文本内容 "@XXXX 你妈喊你回家吃饭!"
客户端在收到该自定消息时，如果是老版本，则不做任何处理，直接显示
在新版本中，如果自己是被@到的人，则需要特殊显示（类似有新消息一样，会出现特殊的特使）</p>
<hr />
<table width='100%' class='codestyle'><pre><code> {  
    &quot;customeType&quot;:&quot;4&quot;,
    &quot;remind_message&quot;:&quot;@昵称1 @昵称2 你妈喊你回家吃饭!&quot;,
    &quot;at_content&quot;:[
    {
        &quot;type&quot;: &quot;1&quot;,
        &quot;userId&quot;: &quot;nmb_12345&quot;,
        &quot;nickName&quot;: &quot;n我呢否&quot;
    },
    {
        &quot;type&quot;: &quot;0&quot;,
        &quot;content&quot;: &quot;你妈喊你回家吃饭!&quot;
    }
]
 }</code></pre></table>
<p>客户端在输入显示时，@某个人时，指定消息类型为4，在收到显示时，根据userid显示备注或昵称，比如帐号12345的备注在A客户端是小A，则显示 @小A @昵称2 你妈喊你回家吃饭!，在B客户端备注是小B，则显示 @小B @昵称2 你妈喊你回家吃饭!，在低版本中则直接显示remind_message，即：@昵称1 @昵称2 你妈喊你回家吃饭!</p></div><h2>6.5、自定义消息：抖一抖2</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>IM自定义消息：抖一抖</li>
</ul>
<p><strong>参数：</strong> </p>
<ul>
<li>用户表，储存用户信息</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">customeType</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>2</td>
<td>自定义消息类型：单聊抖一抖</td>
</tr>
<tr>
<td style="text-align: left;">remind_message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>提示信息</td>
</tr>
</tbody>
</table>
<p><strong>示例：</strong></p>
<table width='100%' class='codestyle'><pre><code> {  
    &quot;customeType&quot;:&quot;2&quot;,
    &quot;remind_message&quot;:&quot;该版本不支持此类型消息，请升级App&quot;,
 }</code></pre></table></div><h2>6.6、自定义消息：删除消息5</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>IM自定义消息：删除群消息5</li>
</ul>
<p><strong>参数：</strong> </p>
<ul>
<li>用户表，储存用户信息</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">customeType</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>5</td>
<td>自定义消息类型：删除指定的消息</td>
</tr>
<tr>
<td style="text-align: left;">remind_message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>提示信息：不支持的消息类型</td>
</tr>
<tr>
<td style="text-align: left;">chatid</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>聊天窗口id，（单聊为用户id，群聊为群id）</td>
</tr>
<tr>
<td style="text-align: left;">tim_type</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">否</td>
<td></td>
<td><del>1、单聊</del> 2、群聊 3、系统消息</td>
</tr>
<tr>
<td style="text-align: left;">message_seq</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>消息 id</td>
</tr>
</tbody>
</table>
<hr />
<table width='100%' class='codestyle'><pre><code> {  
    &quot;customeType&quot;:&quot;5&quot;,
    &quot;remind_message&quot;:&quot;不支持的消息类型&quot;,
    &quot;tim_type&quot;:2,   //群聊删除类型
    &quot;chatid&quot;:2,      //群聊的id
    &quot;message_seq&quot;: &quot;23&quot; // 消息 id
 }</code></pre></table>
<p>该消息不显示在群聊中，仅做删除操作，目前仅支持群里删除能力，发送者为管理员</p></div><h2>6.7、自定义群信息-直播课程开课提醒</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>自定义群公告-直播课程开课提醒</li>
</ul>
<p><strong>参数：</strong> </p>
<ul>
<li>群公告为纯字符串，长度为 300 字节，为满足需求，需改为json字符串的形式</li>
</ul>
<table width='100%' class='codestyle'><pre><code> {  
    &quot;msg&quot;:&quot;这是一条群公告信息&quot;, 
    &quot;type&quot;:&quot;1&quot;,     //1表示课程尚未开始，2表示课程已开始
    &quot;start_time&quot;:&quot;201712211938&quot;,  //yyyyMMddHHmm 精确到分钟即可
    &quot;end_time&quot;: &quot;201712211938&quot;, //yyyyMMddHHmm 精确到分钟即可
    &quot;url&quot;:&quot;https://namibox.com/aaa&quot; //课程链接地址
 }</code></pre></table>
<p>该内容为群公告，即 <code>Notification</code>，当该字段变更时群聊收到系统回调，即完成开课提醒/场景切换</p>
<p><strong>注： "end_time" 在课程未结束时该字段不存在，当课程结束时会被置为准确的结束时间</strong></p></div><h2>6.8、IM自定义消息举报</h2><div style="margin-left:20px;"><p>IM举报</p>
<p>消息内容：</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">customeType</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>6</td>
<td>举报</td>
</tr>
<tr>
<td style="text-align: left;">target_user_id</td>
<td style="text-align: left;">long</td>
<td style="text-align: left;">否</td>
<td>目标用户ID</td>
</tr>
<tr>
<td style="text-align: left;">from_user_id</td>
<td style="text-align: left;">long</td>
<td style="text-align: left;">否</td>
<td>来自用户ID</td>
</tr>
<tr>
<td style="text-align: left;">msg_seq</td>
<td style="text-align: left;">long</td>
<td style="text-align: left;">否</td>
<td></td>
<td>被举报消息ID</td>
</tr>
<tr>
<td style="text-align: left;">msg_content</td>
<td style="text-align: left;">str</td>
<td style="text-align: left;">否</td>
<td></td>
<td>被举报消息内容</td>
</tr>
<tr>
<td style="text-align: left;">grp_id</td>
<td style="text-align: left;">str</td>
<td style="text-align: left;">否</td>
<td></td>
<td>IM 群ID, 注：当为私聊时，该字段不存在</td>
</tr>
<tr>
<td style="text-align: left;">reason</td>
<td style="text-align: left;">str</td>
<td style="text-align: left;">否</td>
<td></td>
<td>举报原因:"涉黄","骂人","刷屏","无意义文字","其他"</td>
</tr>
</tbody>
</table>
<p>{
"customeType" : "6",
"target_user_id": "{user_id}",
"msg_seq": "{msg_seq}",
"msg_content": {msg_content},
"grp_id": {im_group_id},
"from_user_id": {user_id}
"reason": {reason}
}</p></div><h2>6.9、管理员文本消息</h2><div style="margin-left:20px;"><table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">customeType</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>7</td>
<td>自定义消息类型</td>
</tr>
<tr>
<td style="text-align: left;">remind_message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>和msg一致</td>
</tr>
<tr>
<td style="text-align: left;">msg</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>消息内容</td>
</tr>
</tbody>
</table>
<hr /></div></div><h1>7、IM 交互相关</h1><div style="margin-left:20px;"><h2>7.1、用户个人身份状态字段</h2><div style="margin-left:20px;"><p><strong>字段名：</strong> </p>
<p>Tag_Profile_Custom_CZone</p>
<p><strong>类型:</strong></p>
<p>以英文逗号 (,) 分隔开的字符串, 例： 纳米盒,班级圈</p>
<p><strong>当前存的身份类型：</strong>纳米盒，认证教师，班级圈</p></div><h2>7.1、API 接口</h2><div style="margin-left:20px;"><h3>7.1.1、获取UserSig</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>获取UserSig</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><a href="https://w.namibox.com/api/app/get_im_usersign?uuid=xxxx&timestamp=20170324035701&sign=xxxx">https://w.namibox.com/api/app/get_im_usersign?uuid=xxxx&timestamp=20170324035701&sign=xxxx</a></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uuid</td>
<td style="text-align: left;">string</td>
<td>设备编码</td>
</tr>
<tr>
<td style="text-align: left;">timestamp</td>
<td style="text-align: left;">datetime</td>
<td>14位时间戳</td>
</tr>
<tr>
<td style="text-align: left;">sign</td>
<td style="text-align: left;">string</td>
<td>设备校验所用 signature</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
   &quot;error_code&quot;: 0,
   &quot;error_desc&quot;: &quot;\u6210\u529f&quot;, 
   &quot;usersign&quot;: &quot;eJw9j11vgjAYhf*K4dZltHwU2R3TuTAw2*qI6E2DtMrLBnS1I*qy-z7B4O15knOe82t8xMv7LM*bn1ozfZLCeBgZyLgb9aAV6gBN3WUWwi62kDOgA-9kmZTAO4gdhJDlYZ-cMOw7sHhaT8P3GV-wzXFfqaIYr5TwzDKGZIbT2NNJTun6MYmC53MJNuFBWATRPI3aTV5OvujJzsMqaVcvqDFTGrlvzpm*Tr-nYzcw5dYqhzngotawA6G61braMjxxyO1HL8oyzWzV*w65hkpc-X1kOy7x3YGIowQlWLbT10ps*eTyERl--xj2WNQ_&quot;, 
   &quot;expire&quot;: &quot;20170821165400&quot;,
   &quot;im_user_id&quot;: &quot;nmb_18460&quot;
   }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">error_code</td>
<td style="text-align: left;">int</td>
<td>错误码，0：成功，-1：失败</td>
</tr>
<tr>
<td style="text-align: left;">error_desc</td>
<td style="text-align: left;">string</td>
<td>错误码描述</td>
</tr>
<tr>
<td style="text-align: left;">usersign</td>
<td style="text-align: left;">string</td>
<td>IM 的 UserSign</td>
</tr>
<tr>
<td style="text-align: left;">expire</td>
<td style="text-align: left;">string</td>
<td>过期时间14位</td>
</tr>
<tr>
<td style="text-align: left;">im_user_id</td>
<td style="text-align: left;">string</td>
<td>IM 用户 id</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong> </p>
<ul>
<li>后台自动判定用户会话是否超时，如若超时自动生成新的 <code>usersign</code> 返回</li>
<li>传入参数应采用 [uuid,timestamp,key] 升序排序后进行sha1加密。使用的 key 为 <code>e70d520b8ea1d667e3ad6c3399600ca1</code></li>
</ul></div><h3>7.1.2、删除好友接口</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>删除好友接口</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><a href="https://w.namibox.com/zone/friend?uid=xxx&opt=del">https://w.namibox.com/zone/friend?uid=xxx&opt=del</a></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>被删除好友的用户 id，注此 id 为纯数字（无 nmb 前缀）</td>
</tr>
<tr>
<td style="text-align: left;">opt</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>常量值 del</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code> {
  &quot;msg&quot;:&quot;Friend Deleted&quot;, 
  &quot;retcode&quot;:&quot;SUCC&quot;, 
  &quot;description&quot;:&quot;好友已删除&quot;
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">retcode</td>
<td style="text-align: left;">string</td>
<td>SUCC 为成功，FAIL 为失败</td>
</tr>
<tr>
<td style="text-align: left;">msg</td>
<td style="text-align: left;">string</td>
<td>任务描述</td>
</tr>
<tr>
<td style="text-align: left;">description</td>
<td style="text-align: left;">string</td>
<td>任务描述</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong> </p>
<ul>
<li>如所提供的需删除好友本身并非好友关系，返回值仍会为成功</li>
</ul></div><h3>7.1.3、获取群组资料</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>获取群组信息</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><a href="http://w.namibox.com/api/app/get_grp_info?id=xxx">http://w.namibox.com/api/app/get_grp_info?id=xxx</a></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET</li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>群组的 id</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;error_code&quot;: 0,
    &quot;error_desc&quot;: &quot;成功获取群组信息&quot;,
    &quot;group_name&quot;: &quot;xxx小学xxx年级xxx班&quot;, 
    &quot;group_id&quot;: &quot;xx&quot;,
    &quot;group_type&quot;: &quot;class_zone&quot;,
    &quot;group_url&quot;: &quot;xxx&quot;
  }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">error_code</td>
<td style="text-align: left;">int</td>
<td>0 为成功</td>
</tr>
<tr>
<td style="text-align: left;">error_desc</td>
<td style="text-align: left;">string</td>
<td>错误（成功）信息</td>
</tr>
<tr>
<td style="text-align: left;">grp_name</td>
<td style="text-align: left;">string</td>
<td>群组名称</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong> </p>
<ul>
<li>更多返回错误代码请看首页的错误代码描述</li>
</ul></div><h3>7.1.4、发送好友请求</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>发送好友请求</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>http://xx.com/zone/friend?uid={user_id}&amp;opt=req&amp;msg={请求信息}</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">uid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户 id</td>
</tr>
<tr>
<td style="text-align: left;">msg</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户的请求信息（例：请加我为好友吧！）</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
   &quot;msg&quot;:&quot;Friends Already&quot;,
   &quot;retcode&quot;:&quot;SUCC&quot;,
   &quot;description&quot;:&quot;好友请求已发送&quot;
   }</code></pre></table>
<p><strong>返回参数说明</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">retcode</td>
<td style="text-align: left;">string</td>
<td>“SUCC”为成功，“FAIL”为失败</td>
</tr>
<tr>
<td style="text-align: left;">msg</td>
<td style="text-align: left;">string</td>
<td>结果描述英文</td>
</tr>
<tr>
<td style="text-align: left;">description</td>
<td style="text-align: left;">string</td>
<td>结果描述中文，如：本是好友、好友请求已发送、已经超过最大好友数量啦、参数错误、请登录等</td>
</tr>
</tbody>
</table></div></div><h2>7.2、WEB &lt;==&gt; APP 原生</h2><div style="margin-left:20px;"><h3>7.2.1、进入聊天</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>聊天界面进入接口</li>
</ul>
<p><strong>请求示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;command&quot; : &quot;app_action&quot;, 
     &quot;name&quot; : &quot;openim&quot;, 
     &quot;identifier&quot; : &quot;nmb_xxxx&quot;, 
     &quot;toidentifier&quot; : &quot;nmb_xxxx&quot;,
     &quot;msgdot&quot;: 0,
     &quot;his_nick&quot;: &quot;xxxx&quot;, 
     &quot;his_headimg&quot;: &quot;http://xxxx.png&quot;
 } 
</code></pre></table>
<p><strong>请求方式：</strong></p>
<ul>
<li>json 传参</li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 "app_action"</td>
</tr>
<tr>
<td style="text-align: left;">name</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令名，常量值 "openim"</td>
</tr>
<tr>
<td style="text-align: left;">identifier</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户自己的 id，"nmb_"前缀</td>
</tr>
<tr>
<td style="text-align: left;">toidentifier</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>对方的 id，为空时触发进入我的好友，提供 id 时直接进入与该好友聊天的界面</td>
</tr>
<tr>
<td style="text-align: left;">msgdot</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>1表示有用户请求信息，0表示没有</td>
</tr>
<tr>
<td style="text-align: left;">his_nick</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>在 “TA的空间” 进入直接聊天时所提供的对方昵称</td>
</tr>
<tr>
<td style="text-align: left;">his_headimg</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>在 “TA的空间” 进入直接聊天时所提供的对方头像</td>
</tr>
</tbody>
</table></div><h3>7.2.2、删除好友</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>发送消息给 APP 端告知好友删除成功</li>
</ul>
<p><strong>请求示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;command&quot; : &quot;del_imfriend&quot;, 
     &quot;identifier&quot; : &quot;nmb_xxxx&quot;, 
 } 
</code></pre></table>
<p><strong>请求方式：</strong></p>
<ul>
<li>json 传参 </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 "del_imfriend"</td>
</tr>
<tr>
<td style="text-align: left;">identifier</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>所删用户的 id</td>
</tr>
</tbody>
</table></div><h3>7.2.3、好友资料页面</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>显示好友资料的 WebView，由 APP 来触发</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><a href="https://w.namibox.com/zone/friend_profile?im_user_id=nmb_3127962">https://w.namibox.com/zone/friend_profile?im_user_id=nmb_3127962</a></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">im_user_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>好友的 id</td>
</tr>
</tbody>
</table>
<p><strong>备注</strong> </p>
<ul>
<li>用户自己的 id 于 session/cookie 中获得；</li>
<li>由 APP 打开该 WebView 界面后，用户如果确认删除该用户，则会按照 "[IM 删除好友接口](<a href="http://doc.namibox.com/index.php?s=/1&page_id=7">http://doc.namibox.com/index.php?s=/1&page_id=7</a> "IM 删除好友接口")" 的标准发送指令到 APP，然后关闭自身窗口</li>
</ul></div><h3>7.2.4、好友请求页面</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>好友请求消息的 WebView，由 APP 来触发 （打开时请将 <code>view_name</code> 设置为 <code>u_mine</code>, 后续会有刷新该页面的请求）</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><a href="https://w.namibox.com/diary/friend_req">https://w.namibox.com/diary/friend_req</a></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET </li>
</ul>
<p><strong>参数：</strong> </p>
<ul>
<li>无</li>
</ul></div><h3>7.2.5、查找好友页面</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>查找好友（通过手机号）的 WebView, 由 APP 来触发</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><a href="https://w.namibox.com/zone/friend_find">https://w.namibox.com/zone/friend_find</a></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>GET</li>
</ul>
<p><strong>参数：</strong> </p>
<ul>
<li>无</li>
</ul>
<p><strong>备注</strong> </p>
<ul>
<li>暂只提供通过手机号查询好友</li>
</ul></div><h3>7.2.6、请求登录</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>
<p>当用户发送好友请求或者同意好友请求时提示 APP 端进行 IM 登录</p>
<p><strong>请求示例</strong></p>
</li>
</ul>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;command&quot;: &quot;login_im&quot;,
  }</code></pre></table>
<p><strong>请求方式：</strong></p>
<ul>
<li>json 传参 </li>
</ul>
<p><strong>参数</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 "login_im"</td>
</tr>
</tbody>
</table></div><h3>7.2.7、进入群聊</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>群聊进入接口</li>
</ul>
<p><strong>请求示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;command&quot; : &quot;app_action&quot;, 
     &quot;name&quot; : &quot;openim_grp&quot;, 
     &quot;group_id&quot; : &quot;xxxx&quot;, 
     &quot;group_name&quot; : &quot;海桐小学三年级2班&quot;,
     &quot;group_type&quot;: &quot;class_zone&quot;, 
     &quot;my_im_id&quot;: &quot;nmb_xxxx&quot;,
     &quot;source&quot;: &quot;xxx&quot;, 
     &quot;members_url&quot;: &quot;http://xxxx&quot;
 } 
</code></pre></table>
<p><strong> UI 可参考 QQ 类似风格：</strong> </p>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-05-23/592390a1f36e7.png" alt="" /></p>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 "app_action"</td>
</tr>
<tr>
<td style="text-align: left;">name</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令名，常量值 "openim_grp"</td>
</tr>
<tr>
<td style="text-align: left;">group_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>该群组的 id</td>
</tr>
<tr>
<td style="text-align: left;">group_name</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>该群组的名称，显示于标题栏</td>
</tr>
<tr>
<td style="text-align: left;">group_type</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>群组类型，如 "class_zone"</td>
</tr>
<tr>
<td style="text-align: left;">my_im_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>参与群聊的用户 id，典型值为 "nmb_" 前缀</td>
</tr>
<tr>
<td style="text-align: left;">source</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>打开群聊的 url</td>
</tr>
<tr>
<td style="text-align: left;">members_url</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>成员管理的 url 地址，点击右上角的成员图标所需加载的页面</td>
</tr>
</tbody>
</table>
<p><strong>注意：</strong></p>
<p>腾讯云中的对应群组中的 "AppDefinedData" 字段中的
"GroupName" 字段保存有该群组的名称；
"GroupType" 字段保存有该群组的类型，班级圈所创建的群类型为 "class_zone"
"GroupUrl" 字段保存群组成员管理的相对路径，例如 "/classzone/managemanage?uid=xxxx</p></div><h3>7.2.8、退出群聊</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>退出群聊后通知 APP</li>
</ul>
<p><strong>请求示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;command&quot; : &quot;app_action&quot;, 
     &quot;name&quot; : &quot;quit_im_grp&quot;, 
     &quot;group_id&quot; : &quot;xxxx&quot;, 
     &quot;my_im_id&quot;: &quot;nmb_xxxx&quot;,
 } 
</code></pre></table>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 "app_action"</td>
</tr>
<tr>
<td style="text-align: left;">name</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令名，常量值 "quit_im_grp"</td>
</tr>
<tr>
<td style="text-align: left;">group_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>该群组的 id</td>
</tr>
<tr>
<td style="text-align: left;">my_im_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>参与群聊的用户 id，典型值为 "nmb_" 前缀</td>
</tr>
</tbody>
</table></div><h3>7.2.9、查询未读群聊消息数</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>查询未读群聊消息</li>
</ul>
<p><strong>请求示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;command&quot; : &quot;get_grp_unread&quot;, 
     &quot;group_id&quot; : &quot;xxxx&quot;, 
 } </code></pre></table>
<p><strong> 请求参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令，常量值 "get_grp_unread"</td>
</tr>
<tr>
<td style="text-align: left;">group_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>该群组的 id</td>
</tr>
</tbody>
</table>
<p><strong> 返回示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;group_id&quot; : &quot;xxxx&quot;, 
     &quot;unread&quot;: 15,
 } </code></pre></table>
<p><strong> 返回参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">group_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>该群组的 id</td>
</tr>
<tr>
<td style="text-align: left;">unread</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>该群组的未读消息的数量</td>
</tr>
</tbody>
</table></div><h3>7.2.10、推送未读群聊消息数</h3><div style="margin-left:30px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>APP 广播消息发送未读消息数</li>
</ul>
<p><strong>请求示例：</strong> </p>
<table width='100%' class='codestyle'><pre><code> { 
     &quot;command&quot; : &quot;broadcast_grp_unread&quot;, 
     &quot;group_id&quot; : &quot;xxxx&quot;, 
     &quot;unread&quot; : 12
 } 
</code></pre></table>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>指令名，常量值 "broadcast_grp_unread"</td>
</tr>
<tr>
<td style="text-align: left;">group_id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>该群组的 id</td>
</tr>
<tr>
<td style="text-align: left;">unread</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>未读消息数</td>
</tr>
</tbody>
</table></div></div></div><h1>8、客服</h1><div style="margin-left:20px;"><h2>8.1、错误上报</h2><div style="margin-left:20px;"><h2>说明</h2>
<p>启动客服时可以传递一个String类型参数errorMessage作为错误信息上报客服(可以是json格式,可以是普通字符串)</p>
<h3>客户端操作</h3>
<ul>
<li>发现errorMessage不为空,进入客服界面时就直接发送转人工消息</li>
<li>转人工成功将errorMessage静默发送给客服</li>
<li>转人工失败(下班时段/发送失败)构造留言消息发送给客服平台</li>
<li>留言消息发送失败不需重试</li>
<li>留言消息发送成功需要提示用户</li>
</ul>
<h2>视频播放出错errorMessage格式</h2>
<table width='100%' class='codestyle'><pre><code>{
“uploadtype”:”videoplayfailed”,
“url”:”视频地址”,
“pageurl”:”页面地址”, 
“errormsg”:”错误信息”,
“errorcode”:”服务器返回的错误信息”,特殊code值 -101，视频token过期或无效
“ip”:””,//外网ip，需要后端给出接口支持
&quot;area&quot;:&quot;&quot;.//所在区域（华东），需要后端给出接口支持
“time”:””,//上报时间
“speed”:””,本次下载速度（从开始下载到下载结束的时间内）
“userid:””,
“phonenum”:””,
“dns”:””,
“model”:””,//设备型号
“resolution”:””//分辨率
“storage”:””,
“memory”:””,
“cache_size”:””,
“app_version”:”,”
“os_version”:””,
“network”:””,
“channel”:””，
&quot;host&quot;:dns //url的域名解析结果
}
</code></pre></table>
<h2>书本下载出错errorMessage格式</h2>
<table width='100%' class='codestyle'><pre><code>{
“uploadtype”:”downloadbookfailed”
“url”:””,//书本zip地址
“bookid”:””,
“bookname”:””,
“filesize”:””,
“timetxt”:””,//已下载的课本时间戳，非必传
“checksum”:””,//非必传
“ip”:””,//外网ip，需要后端给出接口支持
“errormsg”:””,//下载出错的描述
“errorcode”:””,//返回错误码，特殊code：1204解压失败 1205书本不是最新
“time”:””,//上报时间
“speed”:””,本次下载速度（从开始下载到下载结束的一次时间内）
“userid:””,
“phonenum”:””,
“dns”:””,
“model”:””,//设备型号
“resolution”:””//分辨率
“storage”:””,
“memory”:””,
“cache_size”:””,
“app_version”:”,”
“os_version”:””,
“network”:””,
“channel”:””,
&quot;host&quot;:dns //url的域名解析结果
}
</code></pre></table>
<h2>口语评测出错errorMessage格式</h2>
<table width='100%' class='codestyle'><pre><code>{
“uploadtype”:”recognize_failed”
“url”:””,//拉取评测数据的地址
“bookid”:””,
“page_no”:””,
“isbuy”:””, //是否购买
“recognize_content” ：“” //评测文本
“experience_count”:””,//进入评测初始体验次数
“remain_count”:””,//剩余体验次数
“ip”:””,//外网ip，需要后端给出接口支持
“errormsg”:””,//下载出错的描述
“errorcode”:””,//返回错误码，16386, 语音评测超时
“time”:””,//上报时间
“enginetype”:””,//使用引擎类型
“coreType” ：//使用评测模式,单词、句子
“userid:””,
“phonenum”:””,
“dns”:””,
“model”:””,//设备型号
“resolution”:””//分辨率
“storage”:””,
“memory”:””,
“cache_size”:””,
“app_version”:”,”
“os_version”:””,
“network”:””,
“channel”:””,
&quot;host&quot;:dns //url的域名解析结果
}
</code></pre></table>
<h2>游戏错题回顾页面错题上报</h2>
<p>为避免用户上报的频繁性，只在错题回顾页面增加上报入口
<img src="http://bbs.namibox.com:5555/Public/Uploads/2017-10-24/59ee9ce704736.png" alt="" /></p>
<p>errorMessage格式如下：</p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;app_version&quot; = &quot;4.3.0&quot;;
    &quot;cache_size&quot; = &quot;26.4 M&quot;;
    channel = appstore;
    city = &quot;\U4e0a\U6d77\U5e02&quot;;
    dns = &quot;180.168.255.118,116.228.111.18&quot;;
    exercise =     {
        choices =         (
                        {
                content = have;
                &quot;content_type&quot; = &quot;\U6587\U5b57&quot;;
                correct = 0;
                index = 0;
            },
                        {
                content = hi;
                &quot;content_type&quot; = &quot;\U6587\U5b57&quot;;
                correct = 1;
                index = 0;
            }
        );
        id = 672342;
        &quot;punish_score&quot; = 4;
        question =         {
            content = &quot;http://u.namibox.com/audio/resource_lib/box_0000004919.mp3?ts=20170314183635&quot;;
            prompt = &quot;\U542c\U5f55\U97f3\Uff0c\U9009\U51fa\U542c\U5230\U5355\U8bcd\U7684\U540c\U7c7b\U8bcd&quot;;
        };
        score = 4;
        type = &quot;\U8bed\U97f3\U9009\U62e9\U6587\U5b57\U9898&quot;;
        useranswer = &quot;&quot;;  //用户选择的答案
    };
    ip = &quot;101.81.135.46&quot;;
    ispk = 0;       //是否是pk产生的错题回顾（0：pk，1：闯关）
    memory = &quot;7006.7 MB&quot;;
    model = &quot;iPhone 5&quot;;
    network = WIFI;
    &quot;os_version&quot; = &quot;8.3&quot;;
    phonenum = 15000786062;
    province = &quot;\U4e0a\U6d77\U5e02&quot;;
    resolution = &quot;640*1136&quot;;
    storage = &quot;12863.6 MB&quot;;
    uploadtype = gameupload;
    userid = 8566960;
    uuid = &quot;22CF346E-98F5-4331-9851-C8FF13D21869&quot;;
}</code></pre></table>
<ul>
<li>客服上报错误码</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">错误码</th>
<th style="text-align: left;">场景</th>
<th style="text-align: left;">说明</th>
<th>crm处理方式</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1205</td>
<td style="text-align: left;">downloadbookfailed</td>
<td style="text-align: left;">不是最新书本</td>
<td>生成修复链接</td>
</tr>
<tr>
<td style="text-align: left;">1204</td>
<td style="text-align: left;">downloadbookfailed</td>
<td style="text-align: left;">http416错误</td>
<td>生成修复链接(删除重新下载)</td>
</tr>
<tr>
<td style="text-align: left;">416</td>
<td style="text-align: left;">downloadbookfailed</td>
<td style="text-align: left;">书本解压失败</td>
<td>生成修复链接</td>
</tr>
<tr>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">downloadbookfailed</td>
<td style="text-align: left;">android默认错误</td>
<td>提示用户重试</td>
</tr>
<tr>
<td style="text-align: left;">-101</td>
<td style="text-align: left;">videoplayfailed</td>
<td style="text-align: left;">token过期等(不是有效文件格式)</td>
<td>--</td>
</tr>
<tr>
<td style="text-align: left;">-1001</td>
<td style="text-align: left;">videoplayfailed</td>
<td style="text-align: left;">下载超时</td>
<td>--</td>
</tr>
<tr>
<td style="text-align: left;">404等http错误</td>
<td style="text-align: left;">videoplayfailed</td>
<td style="text-align: left;">--</td>
<td>--</td>
</tr>
<tr>
<td style="text-align: left;">0</td>
<td style="text-align: left;">videoplayfailed</td>
<td style="text-align: left;">android默认错误</td>
<td>提示用户重试</td>
</tr>
<tr>
<td style="text-align: left;">16386</td>
<td style="text-align: left;">recognize_failed</td>
<td style="text-align: left;">语音评测超时</td>
<td>提示用户检查网络</td>
</tr>
<tr>
<td style="text-align: left;">20000</td>
<td style="text-align: left;">recognize_failed</td>
<td style="text-align: left;">引擎初始化失败</td>
<td>--</td>
</tr>
<tr>
<td style="text-align: left;">60010</td>
<td style="text-align: left;">recognize_failed</td>
<td style="text-align: left;">网络异常</td>
<td>提示用户连接网络</td>
</tr>
<tr>
<td style="text-align: left;">60011</td>
<td style="text-align: left;">recognize_failed</td>
<td style="text-align: left;">SDK 接口调用序错误</td>
<td>--</td>
</tr>
<tr>
<td style="text-align: left;">60014</td>
<td style="text-align: left;">recognize_failed</td>
<td style="text-align: left;">使用云服务，服务响应超时 (即在 stop 后 60s 内无结果 返回)</td>
<td>提示用户检查网络</td>
</tr>
<tr>
<td style="text-align: left;">60015</td>
<td style="text-align: left;">recognize_failed</td>
<td style="text-align: left;">授权认证失败</td>
<td>--</td>
</tr>
</tbody>
</table></div><h2>8.2、客服回复特殊的样式</h2><div style="margin-left:20px;"><p>对收到的包含subtype字段的json格式视作特殊的样式<br />
其他文本类型消息正常处理</p>
<h2>修复链接</h2>
<table width='100%' class='codestyle'><pre><code>{
&quot;repairurl&quot;:&quot;https://u.namibox.com/static/d/oe/oe_005003.zip?20151221164031&quot;,
&quot;title&quot;:&quot;点我立即修复&quot;,
&quot;subtitle&quot;: &quot;看听学第三册&quot;,
&quot;icon&quot;:&quot;https://ra.namibox.com/tina/static/d/oe/005003_%E7%9C%8B%E5%90%AC%E5%AD%A6%E7%AC%AC%E4%B8%89%E5%86%8C/title.jpg?20151214135812&quot;,
&quot;bookid&quot;:&quot;oe_005003&quot;,
&quot;type&quot;:&quot;1&quot;,
&quot;subtype&quot;:&quot;bookrepair&quot;
}</code></pre></table></div></div><h1>9、网校</h1><div style="margin-left:20px;"><h2>9.1、网校直播 后台服务器技术分析</h2><div style="margin-left:20px;"><p><strong> 后端课程服务器技术关键点分析 </strong></p>
<ul>
<li>
<p>从学生入场直到课程结束，需要保证，各个学生客户端之间时间必须协调同步, 精确度至少在1秒之内</p>
<ul>
<li>技术上可以通过长连接里加入心跳包来同步时间与服务器时间一致（同步的是关于课程的时间戳，而不是系统时间）</li>
<li><strong>要解决长连接的重连问题，而且重连后数据自动恢复</strong>
<ul>
<li>大部分数据时要在服务器端保存的，而不能简单在前端保存</li>
</ul></li>
<li>服务器端要将进入同一个课堂的学生连接到同一台后端服务器的同一个服务，以降低延迟。</li>
<li>通过打开课堂时候使用的URL参数来按照一定规则分配到不同的课程服务器</li>
<li>限制同一个用户多终端登录吗？</li>
<li>限制一个用户多终端登录，也应该用户切换登录终端，（例如从手机切换到平板/PC）</li>
</ul>
</li>
<li>
<p>需要保证用户看到的课程视频画面基本同步，精确度在3秒之内</p>
<ul>
<li>采用hls格式视频，是否能解决视频同步问题？</li>
<li>HLS 在非苹果设备上的支持问题， Flash? 插件？</li>
<li>是否有其它可靠简单的方法来实现直播实现录制好的视频？</li>
<li>最好预先在课程预习阶段缓存视频</li>
<li>网页端无法预先缓存视频</li>
<li>中途进入的学生也无法预先缓存视频</li>
<li>授课过程中学生进入，如何将视频定位到当前应该的时间？</li>
<li>根据心跳包来调整视频播放位置</li>
<li><strong>关键帧不高的情况下，视频定位不准确，所有视频的关键帧要保证1秒5帧左右，视频文件会变大 </strong></li>
</ul>
</li>
<li>
<p>PC上网页端进入课程</p>
<ul>
<li>界面的实现需要全部实现吗？</li>
<li>只考虑投射屏幕？视频如何同步？</li>
<li>摄像头检测用户头像及姿势方案</li>
<li>很可能不可行，前端有限的技术很难动态监测视频内容，建议改用其它手段来判断用户是否在专心听课</li>
<li>页面刷新后数据保持与恢复会更难</li>
</ul>
</li>
<li>
<p>聊天内容的动态过滤与限制</p>
<ul>
<li>如果使用腾讯的服务，对应的接口是否可实现? 在网页端是否可行？</li>
<li>如果直接使用websocket来实现聊天室功能，与班级圈IM聊天内容要同步吗？</li>
<li>如果要同步需要后端websockt服务器代理用户转发消息，可行吗？</li>
<li>如果不同步课程中的聊天消息要长期保存吗？如何长期保存呢？</li>
<li>课后聊天讨论呢？这时候有长达三个小时甚至更长，此时的聊天还可以采用websocket吗？</li>
<li>聊天内容的智能过滤，网页云盾接口的延时不足以支撑直播下的实时聊天交流</li>
<li>发言频率限制以及禁言限制，腾讯IM服务是否可以提供，还是简单的前端入口限制？</li>
<li>聊天的时序同步</li>
</ul>
</li>
<li>
<p>当前课堂的学生动态分组</p>
<ul>
<li>如何分组使得两组同学的实力相差不大？</li>
</ul>
</li>
<li>
<p>授课中的答题与分组PK</p>
<ul>
<li>
</li>
</ul>
</li>
<li>课后红包</li>
</ul></div><h2>9.2、网校课程服务器设计</h2><div style="margin-left:20px;"><h1>网校课程服务器设计</h1>
<h2>术语定义及简写说明</h2>
<ul>
<li>网校： 纳米盒网校产品，目前计划采用伪直播，同步播放实现录制好的视频的方式进行</li>
<li>课程服务器： 学生在上网校课程时候连接到的后端服务器，包含HTTP服务器和Websocket服务器两部分, 主要指websocket服务器</li>
<li>S: Server 服务器端</li>
<li>C: Client 客户端</li>
</ul>
<h2>子系统划分</h2>
<ul>
<li>HTTP服务</li>
<li>Websocket服务</li>
<li>AI 机器人服务</li>
<li>Andriod 客户端APP</li>
<li>IOS 客户端APP</li>
<li>PC网页APP</li>
</ul>
<p>本文档主要关注 WebSocket 服务器部分。</p>
<h2>后端服务器设计</h2>
<h3>物理部署分割</h3>
<ul>
<li>MySQL数据库：数据持久保持</li>
<li>redis： 高速缓存兼PUB/SUB事务中心</li>
<li>HTTP服务器集: 被动为各客户端提供 <strong> 不随当前课堂进度改变的数据及资源查询；登录校验，权限校验； </strong></li>
<li>WebSocket 服务器集： 上课过程中为各客户端主要提供 <strong>时序及事件同步；消息转发； 过程状态数据暂存，持久化；仲裁；</strong></li>
<li>AI机器人服务器： <strong> 系统与用户之间的消息通道 </strong></li>
<li>IM实时消息服务器：聊天服务器，由腾讯提供服务</li>
<li>负载服务器： 使用4层和7层负载，由阿里云提供服务</li>
</ul>
<h3>HTTP服务器职责详解</h3>
<p>特点： HTTP服务器只能被动的提供服务，及只有在客户端主动发起请求后被动返回信息或者执行操作，但是HTTP服务器是非常成熟的技术，可以通过负载均衡提供高并发的服务。</p>
<ul>
<li>登录及权限校验： 
<ul>
<li>通过已有的登录功能，校验用户账号密码，将登录信息写入session, 并将session_id写入cookie</li>
<li>为每节课堂生成token, 并将token返回给有权限的客户端</li>
</ul></li>
<li>不随当前课堂进度改变的数据及资源获取
<ul>
<li>Websocket服务器的入口地址以及进入权限token</li>
<li>课堂结束后的数据查询</li>
</ul></li>
<li>通知Websocket服务器初始化课堂数据</li>
<li>分配不同的课堂到不同的websocket服务器</li>
</ul>
<h3>Websocket服务器职责详解</h3>
<p>特点： 可以主动推送消息给每个连接的客户端；在高并发支持方面技术相对不成熟； 不太适合一直与客户端建立保持连接。</p>
<ul>
<li>时序同步</li>
<li>数据
<ul>
<li>保存课程进行过程中产生的状态数据</li>
<li>将课堂进行中产生的状态及过程数据存入数据库做持久化保存</li>
</ul></li>
<li>裁决
<ul>
<li>PK 结果</li>
<li>红包</li>
<li>分组</li>
</ul></li>
<li>消息转发
<ul>
<li>事件转发给AI机器人</li>
<li>AI机器人消息转发给用户</li>
</ul></li>
<li>缓存课堂的静态数据到内存，直接发送给各个客户端</li>
<li>开始服务
第一个进入课堂的用户通过HTTP请求触发websocket关于课程的初始化；
在课堂开始时候开发服务</li>
<li>结束服务
当课堂结束时候，websocket服务将课堂进行中的数据存入数据库或者redis后，之后就不再提供关于本课堂的任何服务了。</li>
</ul>
<h3>AI机器人服务器职责详解</h3>
<ul>
<li>课前
<ul>
<li>通知提醒用户</li>
<li>在班级群里广播课程即将开始消息</li>
<li>在课程开始时候在班级群里发送特定消息强制进入课堂</li>
</ul></li>
<li>IM 消息过滤与管控
<ul>
<li>过滤消息</li>
<li>管控发言频率</li>
<li>课程进行中禁止部分类型消息的发言</li>
</ul></li>
<li>课堂中事件的广播：
<ul>
<li>送花</li>
<li>用户进入/离开</li>
<li>红包信息</li>
<li>PK结果信息等</li>
</ul></li>
</ul>
<h3>Websocket服务器软件需求分解</h3>
<h4>功能性需求</h4>
<ul>
<li>课程过程的状态分解
<strong>这里的状态名称对应schedule消息里的stage名称</strong>
<ul>
<li>课前， 最长时间 15分</li>
<li>课前预习， 固定时间14分30秒</li>
<li>学员分组， 最长时间 30秒， 可能会少于30秒
<ul>
<li>学员翻牌中， 最长时间22秒，每个人的实际时间不一样</li>
<li>学员翻牌结果， 固定时间3秒，</li>
<li>分组结果公示， 固定时间5秒</li>
</ul></li>
<li>课中， 时间与每节课的视频和中断相关，最长时间可确定</li>
<li>视频授课，被中断分割成若干段落，视频确定时即可确定各个段落的时长</li>
<li>中断答题， 每个中断时长不一样
<ul>
<li>中断答题中， 每个中断最长时长不一样，根据所有学生的实际答题时间可能会降低</li>
<li>中断答题结果公示， 固定时长2秒</li>
</ul></li>
<li>课间休息，固定时长大概3分钟</li>
<li>布置作业， 固定时长15秒</li>
<li>抢红包，固定时长48秒
<ul>
<li>抢红包准备，固定时长10秒</li>
<li>抢红包中，固定时长30秒</li>
<li>抢红包结果公示，固定时长8秒</li>
</ul></li>
<li>课后</li>
<li>数据保存中， 时长不定，在红包公示界面后台服务器已经在处理数据保存了，所以这个过程正常情况下用户不会看到，但是异常情况下保存数据失败，用户无法通过后续课后静态页面到效果，会显示数据保存中。</li>
</ul></li>
</ul>
<p>数据保存之后websocket服务器对本节课堂的服务终止，由HTTP服务器提供后续内容。</p>
<ul>
<li>时序同步：
<ul>
<li>使连接到同一个课程中的客户端同时（1秒延时之内）进入各个状态</li>
<li>使中途进入（包括重连）的客户端直接进入现在的状态</li>
<li>客户端的连接状态检查</li>
</ul></li>
<li>消息转发
<ul>
<li>转发学生/助教 进入/离开 消息</li>
<li>转发分组信息</li>
<li>在特定时间点广播状态切换事件</li>
<li>转发AI机器人系统消息：
<ul>
<li>禁言</li>
<li>送花</li>
<li>打开红包</li>
</ul></li>
<li>广播每个学生的做题结果</li>
<li>广播两队PK结果</li>
<li>转发消息给AI助教机器人服务，并将AI助教机器人消息转发给用户</li>
</ul></li>
<li>状态保持
<ul>
<li>保存当前课堂的实际时间进度</li>
<li>各个中间状态信息
<ul>
<li>进入时间</li>
<li>是否已经过去</li>
<li>该中间状态的结果数据</li>
</ul></li>
<li>保存当前进入课堂的学生及助教信息
<ul>
<li>user_id</li>
<li>名称</li>
<li>头像</li>
<li>登录终端</li>
<li>IM ID</li>
<li>学分</li>
<li>课堂内做题积分</li>
<li>做题正确率</li>
</ul></li>
</ul></li>
</ul>
<h4>非功能性需求</h4>
<ul>
<li>并发性：
<ul>
<li>一个课堂36学生+1助教直接所有消息转发，</li>
<li>单台服务器可支撑多个课堂，</li>
<li>同一个课堂连接到同一个后端服务器</li>
</ul></li>
<li>延迟要求：
<ul>
<li>时间同步1秒之内，服务器主动每秒发送心跳包同步时间</li>
<li>客户端网络断开连接后10秒内服务器可感知到并广播用户非正常断开消息</li>
</ul></li>
<li>鲁棒性
<ul>
<li>客户端网络重连时数据可恢复</li>
<li>用户切换客户端时数据可重新加载</li>
<li>服务器故障重启时数据可恢复</li>
</ul></li>
<li>数据可靠性
<ul>
<li>数据最终要写入数据库持久化保存，过程中可以在内存里暂时缓存</li>
</ul></li>
<li>接口测试能力支持
<ul>
<li>只在系统层面测试这么复杂的系统，会是件困难的事情，要分步骤对接口进行集成测试</li>
</ul></li>
</ul>
<h2>websocket服务器系统设计</h2>
<h3>系统构架</h3>
<p><strong> 部件及其交互图 </strong>
<img src="http://doc.namibox.com/Public/Uploads/2017-11-24/5a17d95ec6d99.png" alt="" />
<strong> 解释 </strong></p>
<ul>
<li>HTTPs请求走负载均衡</li>
<li>websockt请求不走负载均衡，根据HTTP请求里返回的课程服务器地址直接连接到websocket服务器，HTTP请求里会将同一个课堂的学生发送一个相同的websockt服务器地址，以保证一堂课的学生连接到同一个后台服务器</li>
<li>HTTP服务器主要操作的数据库里的数据，可以把redis当缓存使用</li>
<li>websocket服务器主要操作的是内存里的数据，在特定时间才将内存里需要持久化保存数据保存到数据库</li>
<li>websocket服务器基本上不需要使用redis做pub/sub事件转发，大部分事件消息在websocket服务器内存里处理</li>
<li>websocket服务器将大部分课堂中的状态信息存在内存里，要设置异常和定时dump数据</li>
<li>websocket服务器可以通过加载保存的课堂状态dump数据初始化课堂基本信息</li>
<li>AI 机器人服务器主要承担消息监控与主动发送通知给用户</li>
</ul>
<p><strong> 主要时序图 </strong>
![时序图](<a href="http://doc.namibox.com/Public/Uploads/2017-11-24/5a1800c1ace18.png">http://doc.namibox.com/Public/Uploads/2017-11-24/5a1800c1ace18.png</a> "时序图")</p>
<h4>时序同步机制设计</h4>
<p>> timestamp 是指本节课堂从开始到现在的持续时间，单位毫秒</p>
<ul>
<li>
<p>时间同步的ping-pong机制
客户端或者服务端都可以主动向对方发送一个ping包，另一方必须立即返回一个pong包。
ping包里带上发送ping包时候自己本地记录的timestamp
pong包里也带上发送pong包时候发送方本地记录的timestamp，以及收到的ping包里的timestamp与本地的timestamp之间的差值。
客户端可以主动发送ping包来同步自己本地时间戳与服务器基本一致（网络有误差）
服务端也可以主动发送ping包来校验客户端的连接状态。</p>
</li>
<li>
<p>timesamp实现方法
服务器和客户端都能拿到的是课程开始时间，假设是这节课开始时间 <strong>t0</strong> 是2018-01-01 18:00, 当前时间是 <strong>t</strong>, 那么每次发送的timestamp是 t - t0</p>
</li>
<li>校准客户端时间的原理
<img src="http://doc.namibox.com/Public/Uploads/2017-12-01/5a20c612cba1f.png" alt="" /></li>
</ul>
<p>>1: 客户端发ping命令时候带上自己的时间戳 timestamp_c = T1 + T2
2: 服务器返回pong包时候，带上自己的时间戳 timestamp_s = T1 +Dt 和delay =  -T2 + Dt
3:  客户端收到pong包时候的时间戳timestamp_c_2是  T1 + T2 + 2 <em> Dt
4: 客户端将自己的时间戳进行两部修复：
4.1 修复客户端与服务器之间的时钟差T2
timestamp_c_2 = timestamp_c_2 + delay = (T1 + T2 + 2 </em> Dt) + ( - T2 + Dt) = T1 + 3 <em> Dt
4.2 修复网络延迟造成的Dt
timestamp_c_2 - timestamp_s = T1 + 3 </em> Dt - (T1 + Dt) = 2 <em> Dt
可得  Dt = (timestamp_c_2 - timestamp_s) / 2
timestamp_c_2 = timestamp_c_2 - 3 </em> Dt
5: 之后 客户端和服务器端时钟完全同步
注意： 我们的推论假设前提是： 从客户端到服务器的网络延迟与从服务器端到客户端的网络延迟基本一样； 且服务器返回pong所需要的时间几乎可以忽略不计</p>
<hr />
<ul>
<li>
<p>场景：一节网校(伪)直播课预订的各个步骤，在课程设计时候就固定了，在课程进行中各个场景的进入顺序保持不变，部分场景持续时间不确定，但是有最长持续时间限制。
> 场景的概念有点像一场晚会的节目清单，每个节目及其表演顺序是预先确定的，甚至可以大概估算出每个节目的时长，不过在晚会的实际表演过程中，时长会有或多或少的误差。</p>
</li>
<li>
<p>每个场景有三种状态：已过去，进行中，未发生。</p>
<ul>
<li>对于<strong>已发生</strong>的场景，其开始时间和持续时间是固定的</li>
<li>对于<strong>进行中</strong>的场景，开始时间是确定的，持续时间可能是不确定的，但是可以有最长时间限制的</li>
<li>对于<strong>未发生</strong>的场景，其开始时间和持续时间都可能是不确定的</li>
</ul>
</li>
<li>
<p>一节网校直播课的时间表 schedule 的主要内容是场景清单，包含本节课堂的所有场景。 我们主要关心的是进行中的场景和未发生的场景，我们尤其关心的是当前场景的结束时间，同时也是下个场景的开始时间。</p>
</li>
<li>一节网校直播课的时间表 schedule 是会根据实际进行情况，不断更新的。当时间表有更新时服务器将最新的时间表下发给各个客户端。</li>
</ul>
<h4>时间表schedule的结构示例：</h4>
<pre><code class="language-json">{
 &quot;total_stage&quot;:  20,
  &quot;stages&quot;: [
    {
      &quot;index&quot;: 0,
      &quot;name&quot;: &quot;课前预习&quot;,
      &quot;content&quot;: null,
      &quot;state&quot;: &quot;已过去&quot;,
      &quot;start_at&quot;: 0,
      &quot;duration&quot;: 870000,
      &quot;max_duration&quot;: 870000
    },
    {
      &quot;index&quot;: 1,
      &quot;name&quot;: &quot;学员翻牌中&quot;,
      &quot;content&quot;: {
      },
      &quot;state&quot;: &quot;已过去&quot;,
      &quot;start_at&quot;: 870000,
      &quot;duration&quot;: 10000,
      &quot;max_duration&quot;: 22000
    },
    {
      &quot;index&quot;: 2,
      &quot;name&quot;: &quot;学员翻牌结果&quot;,
      &quot;content&quot;: null,
      &quot;state&quot;: &quot;已过去&quot;,
      &quot;start_at&quot;: 880000,
      &quot;duration&quot;: 3000,
      &quot;max_duration&quot;: 3000
    },
    {
      &quot;index&quot;: 3,
      &quot;name&quot;: &quot;分组结果公示&quot;,
      &quot;content&quot;: {
      },
      &quot;state&quot;: &quot;已过去&quot;,
      &quot;start_at&quot;: 883000,
      &quot;duration&quot;: 5000,
      &quot;max_duration&quot;: 5000
    },{
      &quot;index&quot;: 4,
      &quot;name&quot;: &quot;视频授课&quot;,
      &quot;content&quot;: null,
      &quot;state&quot;: &quot;已过去&quot;,
      &quot;start_at&quot;: 888000,
      &quot;duration&quot;: 300000,
      &quot;max_duration&quot;: 300000
    },
    {
      &quot;index&quot;: 5,
      &quot;name&quot;: &quot;中断答题中&quot;,
      &quot;content&quot;: {
        &quot;exercises&quot;: [
        ]
      },
      &quot;state&quot;: &quot;已过去&quot;,
      &quot;start_at&quot;: 1188000,
      &quot;duration&quot;: 10000,
      &quot;max_duration&quot;: 15000
    },
    {
      &quot;index&quot;: 6,
      &quot;name&quot;: &quot;中断答题结果公示&quot;,
      &quot;content&quot;: {
        &quot;results&quot;: [
        ]
      },
      &quot;state&quot;: &quot;进行中&quot;,
      &quot;start_at&quot;: 1198000,
      &quot;duration&quot;: 2000,
      &quot;max_duration&quot;: 2000
    },
    {
      &quot;index&quot;: 7,
      &quot;name&quot;: &quot;视频授课&quot;,
      &quot;content&quot;: null,
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 1200000,
      &quot;duration&quot;: 300000,
      &quot;max_duration&quot;: 300000
    },
    {
      &quot;index&quot;: 8,
      &quot;name&quot;: &quot;中断答题中&quot;,
      &quot;content&quot;: {
        &quot;exercises&quot;: [
        ]
      },
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 1500000,
      &quot;duration&quot;: 0,
      &quot;max_duration&quot;: 15000
    },
    {
      &quot;index&quot;: 9,
      &quot;name&quot;: &quot;中断答题结果公示&quot;,
      &quot;content&quot;: {
        &quot;results&quot;: [
        ]
      },
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 1650000,
      &quot;duration&quot;: 2000,
      &quot;max_duration&quot;: 2000
    },
    {
      &quot;index&quot;: 10,
      &quot;name&quot;: &quot;视频授课&quot;,
      &quot;content&quot;: null,
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 1652000,
      &quot;duration&quot;: 300000
    },
    {
      &quot;index&quot;: 11,
      &quot;name&quot;: &quot;课间休息&quot;,
      &quot;content&quot;: null,
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 1652000,
      &quot;duration&quot;: 180000,
      &quot;max_duration&quot;: 180000
    },
    {
      &quot;index&quot;: 12,
      &quot;name&quot;: &quot;视频授课&quot;,
      &quot;content&quot;: null,
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 1832000,
      &quot;duration&quot;: 300000,
      &quot;max_duration&quot;: 300000
    },
    {
      &quot;index&quot;: 13,
      &quot;name&quot;: &quot;中断答题中&quot;,
      &quot;content&quot;: {
        &quot;exercises&quot;: [
        ]
      },
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 2132000,
      &quot;duration&quot;: 15000,
      &quot;max_duration&quot;: 15000
    },
    {
      &quot;index&quot;: 14,
      &quot;name&quot;: &quot;中断答题结果公示&quot;,
      &quot;content&quot;: {
        &quot;results&quot;: [
        ]
      },
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 2147000,
      &quot;duration&quot;: 2000,
      &quot;max_duration&quot;: 2000
    },
    {
      &quot;index&quot;: 15,
      &quot;name&quot;: &quot;视频授课&quot;,
      &quot;content&quot;: null,
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 2149000,
      &quot;duration&quot;: 300000,
      &quot;max_duration&quot;: 300000
    },
    {
      &quot;index&quot;: 16,
      &quot;name&quot;: &quot;布置作业&quot;,
      &quot;content&quot;: {},
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 2449000,
      &quot;duration&quot;: 15000,
      &quot;max_duration&quot;: 15000
    },
    {
      &quot;index&quot;: 17,
      &quot;name&quot;: &quot;抢红包准备&quot;,
      &quot;content&quot;: null,
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 2464000,
      &quot;duration&quot;: 10000,
      &quot;max_duration&quot;: 10000
    },
    {
      &quot;index&quot;: 18,
      &quot;name&quot;: &quot;抢红包中&quot;,
      &quot;content&quot;: {},
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 2474000,
      &quot;duration&quot;: 30000,
      &quot;max_duration&quot;: 30000
    },
    {
      &quot;index&quot;: 19,
      &quot;name&quot;: &quot;抢红包结果&quot;,
      &quot;content&quot;: {},
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 2504000,
      &quot;duration&quot;: 8000,
      &quot;max_duration&quot;: 8000
    },
    {
      &quot;index&quot;: 20,
      &quot;name&quot;: &quot;数据保存中&quot;,
      &quot;content&quot;: null,
      &quot;state&quot;: &quot;未开始&quot;,
      &quot;start_at&quot;: 2512000,
      &quot;duration&quot;: 0,
      &quot;max_duration&quot;: 10800000
    }
  ]
}</code></pre></table>
<h3>场景切换的状态机模型</h3>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-11-29/5a1e19b28b69c.png" alt="" /></p>
<ul>
<li>客户端方面状态切换主要是根据timeout，设置该场景的timeout时间，到期自动切换到下个场景。</li>
<li>服务器端会根据实际进度动态调整未发生场景的时间表，例如最后一个学生答完题目之后，答题中场景的持续时间可能发生改变了，这时候服务器就要更新当前答题中场景，及其之后所有场景的时间编排。</li>
<li>客户端要监听时间表的更新事件：
<ul>
<li>如果时间表的更新时间中将部分场景的状态进行了切换，要切换场景</li>
<li>如果当前场景或者后续还未发生场景的时间发生改变，要根据自己的实现改变timer的触发时间。</li>
</ul></li>
</ul>
<h3>分组过程时序图</h3>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-12-01/5a20a9998da3a.png" alt="" /></p>
<h3>中断答题过程时序图</h3>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-12-01/5a20a9b54a08b.png" alt="" /></p>
<h3>抢红包过程时序图</h3>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-12-01/5a20cb016c9e6.png" alt="" /></p>
<h2>参考</h2>
<ul>
<li>[技术调查](<a href="http://doc.namibox.com/index.php?s=/1&page_id=82">http://doc.namibox.com/index.php?s=/1&page_id=82</a> "技术调查")</li>
<li>
</li>
</ul></div><h2>9.3、网校PC网页APP设计</h2><div style="margin-left:20px;"><h1>网校PC网页APP设计</h1>
<h2>术语定义及简写说明</h2>
<p>本文档主要关注PC网页APP部分。</p>
<h2>需求软件分析</h2>
<h3>功能性需求分析</h3>
<ul>
<li>websocket连接服务器
<ul>
<li>重连恢复</li>
</ul></li>
<li>与服务器时序同步</li>
<li>视频缓存与定位</li>
<li>IM 通讯</li>
<li>视频输入，坐姿检测</li>
<li>界面显示与布局
<ul>
<li>各种动画</li>
<li>自定义视频控件</li>
<li>全屏视频播放</li>
<li>弹幕</li>
<li>中断练习题显示</li>
</ul></li>
</ul>
<h3>非功能性需求分析</h3>
<h2>软件设计</h2>
<h3>模块设计</h3>
<h3></h3></div><h2>9.4、绘本的口语评测支持</h2><div style="margin-left:20px;"><h1>在原有的口语评测功能基础上新增口语评测能力</h1>
<h2>需求描述</h2>
<ol>
<li>从完整的点读课本（包含课本上的英文文本、中文翻译等信息）按需（如选择2-5页）生成支持口语测评的配音秀绘本，</li>
<li>
<p>绘本对象的数据格式保持和之前一样（每页一个音频，因此可能要对原点读音频文件进行按页分割）</p>
<p>步骤1使用工具自动生成
步骤2约定数据格式</p>
</li>
</ol>
<h2>支持口语评测的配音秀绘本数据格式定义</h2>
<p>d目录下的绘本目录下增加 slide000N.txt文件，保存每个配音页面对应的文本信息
book.ini文件增加属性</p>
<h2>从点读自动生成支持口语评测的配音秀绘本</h2></div><h2>9.5、网校课程服务器接口设计</h2><div style="margin-left:20px;"><h1>网校课程服务器接口</h1>
<h2>术语定义及简写说明</h2>
<ul>
<li>网校： 纳米盒网校产品，目前计划采用伪直播，同步播放实现录制好的视频的方式进行</li>
<li>课程服务器： 学生在上网校课程时候连接到的后端服务器，包含HTTP服务器和Websocket服务器两部分, 主要指websocket服务器</li>
<li>S: Server 服务器端</li>
<li>C: Clietn 客户端</li>
</ul>
<h3>接口设计</h3>
<h4>练习题JSON格式定义</h4>
<p>在中断答题及错题回顾等场景服务器返回的练习题格式保持一致。
练习题安装类别分为：</p>
<ul>
<li>选择题</li>
<li>朗读题</li>
<li>填空题
<ul>
<li>字母输入题</li>
<li>数字输入题</li>
<li>文字输入题</li>
</ul></li>
<li>排序题
练习题基本格式为：
<pre><code class="language-json">{
id: 123,
type: &quot;选择题&quot;,
sub_type: &quot;&quot;， // 可能为空字符串
correct_answer: &quot;&quot;,       // 在排序题里为空，
answer_analyse: &quot;&quot;        // 可能为空
nonautomaticPlay:false   //音频是否自动播放，默认false，即默认自动播放
}</code></pre></table>
<p>不同的练习题会添加额外的字段，但是都会包含以上基本字段。
各类型练习题JSON格式例子：</p></li>
<li>选择题
<pre><code class="language-json">{
id: 123,
type: &quot;选择题&quot;,
sub_type: &quot;&quot;， // 为空字符串
question: {
    text: &quot;请选择一个正确的答案&quot;，
    text_type: &quot;文字&quot;,      // 目前只支持文字类型
    attach: &quot;&quot;,
    attach_type: &quot;图片&quot;,        // 可能为 图片， 文字，语音
    input: &quot;&quot;,
    input_type: &quot;文字&quot;,     // 目前只支持  文字类型
    reference: &quot;&quot;,
    reference_type: &quot;语音&quot;  // 目前支持 语音类型
}，
options: [      // 目前保证所有选项的content_type一致
    {
        content: &quot;选项A&quot;,
        content_type: &quot;图片&quot;,       // 可能为 图片， 文字，语音
        is_correct: true
    }，
    {
        content: &quot;选项B&quot;,
        content_type: &quot;图片&quot;        // 可能为 图片， 文字，语音
        is_correct: false
    }，
    {
        content: &quot;选项C&quot;,
        content_type: &quot;图片&quot;        // 可能为 图片， 文字，语音
        is_correct: false
    }，
    {
        content: &quot;选项D&quot;,
        content_type: &quot;图片&quot;        // 可能为 图片， 文字，语音
        is_correct: false
    }
],
answer_analyse: &quot;&quot;        // 可能为空
}</code></pre></table></li>
<li>朗读题
<pre><code class="language-json">{
id: 123,
type: &quot;朗读题&quot;,
sub_type: &quot;&quot;，    // 为空字符串
question: {
  text: &quot;根据提示，说句子&quot;，
  text_type: &quot;文字&quot;,        // 目前只支持文字类型
  attach: &quot;&quot;,
  attach_type: &quot;图片&quot;,        // 可能为 图片， 文字，语音
  input: &quot;&quot;,
  input_type: &quot;文字&quot;,        // 目前只支持  文字类型
  reference: &quot;&quot;,
  reference_type: &quot;语音&quot;    // 目前支持 语音类型
},
correct_answer: &quot;&quot;,        // 朗读内容
answer_analyse: &quot;&quot;        // 可能为空
}</code></pre></table></li>
<li>填空题
<ul>
<li>字母输入题</li>
<li>数字输入题</li>
<li>文字输入题</li>
</ul></li>
</ul>
<pre><code class="language-json">{
id: 123,
type: &quot;填空题&quot;,
sub_type: &quot;数字&quot;，    // 可能为 字母，文字，数字；如果为字母，一个空只能填写一个字母，如果为文字，一个空可以填写一个单词
question: {
    text: &quot;听录音，填入所缺单词&quot;，
    text_type: &quot;文字&quot;,        // 目前只支持文字类型
    attach: &quot;&quot;,  // 可能包含待填入内容，以 n[] 标记带填入内容
    attach_type: &quot;图片&quot;,        // 可能为 图片， 文字，语音
    input: &quot;&quot;,  // 可能包含待填入内容，以 n[] 标记带填入内容
    input_type: &quot;文字&quot;,        // 目前只支持  文字类型
    reference: &quot;&quot;,
    reference_type: &quot;语音&quot;    // 目前支持 语音类型
},
answer_analyse: &quot;&quot;        // 可能为空
}</code></pre></table>
<ul>
<li>排序题</li>
</ul>
<pre><code class="language-json">{
id: 123,
type: &quot;排序题&quot;,
sub_type: &quot;&quot;，    // 为空
question: {
    text: &quot;听录音，填入所缺单词&quot;，
    text_type: &quot;文字&quot;,        // 目前只支持文字类型
    attach: &quot;&quot;,
    attach_type: &quot;&quot;,        // 无
    input: &quot;&quot;,
    input_type: &quot;&quot;,        // 无
},
//源序列
source_sequence：[{
    content: &quot;&quot;,
    content_type: &quot;&quot;,       // 可能为 图片， 文字，语音
    index: 2
    },
    content: &quot;&quot;,
    content_type: &quot;&quot;,       // 可能为 图片， 文字，语音
    index: 1
    },
],
//正确序列
destination_sequence：[{
    content: &quot;&quot;,
    content_type: &quot;&quot;,       // 可能为 图片， 文字，语音
    index: 1
    },
    content: &quot;&quot;,
    content_type: &quot;&quot;,       // 可能为 图片， 文字，语音
    index: 2
    },
]
answer_analyse: &quot;&quot;        // 可能为空
}</code></pre></table>
<h4>HTTP服务器提供的接口</h4>
<p><a href="http://doc.namibox.com/index.php?s=/1&amp;page_id=109">文档入口</a></p>
<h4>HTTP服务器发布的消息</h4>
<ul>
<li>redis 频道： vschool
消息名称type: initialize_class_room
消息内容data:</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>redis_key</td>
<td>string</td>
<td>在redis2中的key，课程服务器用来初始化数据</td>
</tr>
<tr>
<td>wss_service</td>
<td>string</td>
<td>指定哪个课程服务器来负责这节课堂的服务</td>
</tr>
</tbody>
</table>
<p>当用户点击进入课堂接口时候，HTTP服务器负责初始化课堂的数据并放入redise2的  class_room:{lesson_id} 键里，并广播 initialize_class_room消息。
class_room:{lesson_id} redis键是一个hash类型的数据结构，设置过期时间为7x24小时, 其内容用json格式表达为：</p>
<pre><code class="language-json">{
    class_info: {
        id: &quot;-1&quot;,
        name: &quot;&quot;,
        suplier_name: &quot;&quot;
    },
    lesson_info: {

    },
    pre_lesson: {

    },
    lesson_video: {

    },
}</code></pre></table>
<h4>Websocket服务器与客户端之间的消息定义</h4>
<ul>
<li>基本格式：
<ul>
<li>JSON格式</li>
</ul></li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>string</td>
<td>消息类型</td>
</tr>
<tr>
<td>data</td>
<td>dict</td>
<td>消息内容, 不同消息类型内容都可能不同</td>
</tr>
</tbody>
</table>
<ul>
<li>消息总览
> S 代表服务器， C 代表客户端</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>消息类型</th>
<th>消息方向</th>
<th>客户端场景</th>
<th>服务端场景</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>ping</td>
<td>S <--> C</td>
<td>*</td>
<td>*</td>
<td>客户端用来同步时间戳</td>
</tr>
<tr>
<td>pong</td>
<td>C <--> S</td>
<td>*</td>
<td>*</td>
<td>测算延迟; 使服务器知道客户端是否在线；使客户端知道自己是否已经掉线</td>
</tr>
<tr>
<td>get_schedule</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>查询时间表</td>
</tr>
<tr>
<td>schedule</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>时间表, 包含各个场景的当前状态，开始时间，持续时间,  最长持续时间等信息;</td>
</tr>
<tr>
<td>enter_stage</td>
<td>S <--> C</td>
<td>*</td>
<td>*</td>
<td>客户端或者服务端通知对方开始进入某个场景</td>
</tr>
<tr>
<td>get_room</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>查询"教室"信息</td>
</tr>
<tr>
<td>get_groups</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>查询"分组"信息</td>
</tr>
<tr>
<td>get_users</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>查询"所有课堂参与者信息"信息</td>
</tr>
<tr>
<td>get_class</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>查询"班级信息"信息</td>
</tr>
<tr>
<td>get_lesson</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>查询"这节课的"信息</td>
</tr>
<tr>
<td>room</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>"教室"信息, 包含人员列表，分组，及每个人的信息；更新分组信息，更新组PK得分等</td>
</tr>
<tr>
<td>groups</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>"分组"信息</td>
</tr>
<tr>
<td>users</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>"所有课堂参与者信息"信息</td>
</tr>
<tr>
<td>class</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>"班级信息"信息</td>
</tr>
<tr>
<td>lesson</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>"这节课的"信息</td>
</tr>
<tr>
<td>new_user_enter</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>新用户进入</td>
</tr>
<tr>
<td>user_leave</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>用户断开</td>
</tr>
<tr>
<td>login_on_other_device</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>通过其它终端登陆，服务器强制断开连接</td>
</tr>
<tr>
<td>choose_group</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>学员完成翻牌动作。</td>
</tr>
<tr>
<td>assign_group</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>服务器给指定用户分配了一个组。</td>
</tr>
<tr>
<td>finished_group</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>所有学员都完成了翻牌动作时候，或者服务器端学员翻牌场景超时，服务器广播finished_group给所有连接中的学员。客户端本地的分组场景结束时候，如果还没有收到服务器端的finished_group消息，需要首先校验自己的时间戳是否比服务器快了，如果客户端本地时间比服务器端快了，要继续等待分组结果消息，如果自己的本地时间不比服务器端快，可以主动通过get_room更新分组信息。</td>
</tr>
<tr>
<td>submit_exercise</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>客户端提交自己的答题结果，一次只提交一个中断点一个练习题的答题结果</td>
</tr>
<tr>
<td>finished_exercise</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>服务器转发其它用户本中断点所有练习题的答题结果</td>
</tr>
<tr>
<td>get_pk_summary</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>客户端主动请求一个中断点的PK结果汇总；当客户端主动发送请求get_pk_summary时，服务器端记录该中断答题场景尚且没有结束时候，服务器端不会返回pk_summary消息给客户端，如果服务器端记录的该中断答题场景已经结束了，服务器端要重新发送pk_summary消息给客户端。</td>
</tr>
<tr>
<td>pk_summary</td>
<td>S --> C</td>
<td>*</td>
<td>中断答题结果展示</td>
<td>所有用户完成了本中断点的所有练习题，或者服务器上本中断点答题场景超时，服务器主动广播本中断点PK结果；客户端本地的答题倒计时超时后如果还没有收到服务器发送的本中断点的pk_summary消息，可以主动去向服务器请求。</td>
</tr>
<tr>
<td>prepare_hong_bao_falling</td>
<td>S --> C</td>
<td>*</td>
<td>抢红包准备中</td>
<td>不同用户根据自己的表现收到的结果不一样</td>
</tr>
<tr>
<td>get_hong_bao_access</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>用户主动查询自己的抢红包权限</td>
</tr>
<tr>
<td>hong_bao_access</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>服务器返回用户的抢红包权限</td>
</tr>
<tr>
<td>open_hong_bao</td>
<td>C --> S</td>
<td>抢红包中</td>
<td>抢红包中</td>
<td>用户打开红包</td>
</tr>
<tr>
<td>hong_bao_content</td>
<td>S --> C</td>
<td>抢红包中</td>
<td>抢红包中</td>
<td>服务器告知客户端红包内容</td>
</tr>
<tr>
<td>send_hong_bao</td>
<td>S --> C</td>
<td>抢红包中</td>
<td>抢红包中</td>
<td>服务器广播红包消息</td>
</tr>
<tr>
<td>hong_bao_stop_falling</td>
<td>S --> C</td>
<td>抢红包中</td>
<td>红包结果展示</td>
<td>服务器广播抢红包结果，客户端停止下红包雨，并进入红包结果展示页面</td>
</tr>
<tr>
<td>message_to_robot</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>发消息给AI助教</td>
</tr>
<tr>
<td>message_to_user</td>
<td>C <--> S</td>
<td>*</td>
<td>*</td>
<td>发消息给用户</td>
</tr>
<tr>
<td>flower_to_user</td>
<td>C <--> S</td>
<td>*</td>
<td>*</td>
<td>给用户送花</td>
</tr>
<tr>
<td>report_abuse</td>
<td>C <--> S</td>
<td>*</td>
<td>*</td>
<td>举报用户</td>
</tr>
<tr>
<td>forbid_user_talk</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>禁止用户发言</td>
</tr>
<tr>
<td>unblock_user_talk</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>解除用户禁言</td>
</tr>
<tr>
<td>query_user_state</td>
<td>S --> C</td>
<td>*</td>
<td>*</td>
<td>查询用户状态（face++检测）</td>
</tr>
<tr>
<td>upload_user_state</td>
<td>C --> S</td>
<td>*</td>
<td>*</td>
<td>上传用户状态（face++检测），app定期主动上报或在接收到query_user_state命令后</td>
</tr>
<tr>
<td>video_loading</td>
<td>c --> S</td>
<td>*</td>
<td>*</td>
<td>视频加载中</td>
</tr>
<tr>
<td>video_buffered</td>
<td>c --> S</td>
<td>*</td>
<td>*</td>
<td>视频缓存完成</td>
</tr>
<tr>
<td>dian_zan</td>
<td>c <--> S</td>
<td>*</td>
<td>*</td>
<td>点赞</td>
</tr>
<tr>
<td>cancel_dian_zan</td>
<td>c <--> S</td>
<td>*</td>
<td>*</td>
<td>取消点赞</td>
</tr>
</tbody>
</table>
<ul>
<li>错误编码 和拒绝链接编码</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>code</th>
<th>value</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ERROR_CODE_LESSON_NOT_EXIST</td>
<td>3001</td>
<td># 课不存在</td>
</tr>
<tr>
<td>ERROR_CODE_LESSON_NOT_START</td>
<td>3002</td>
<td># 课没有开始</td>
</tr>
<tr>
<td>ERROR_CODE_LESSON_HAS_FINISHED</td>
<td>3003</td>
<td># 课已经结束了</td>
</tr>
<tr>
<td>ERROR_CODE_LESSON_NO_ACCESS</td>
<td>3004</td>
<td># 没权限进入教室</td>
</tr>
<tr>
<td>ERROR_CODE_NEED_LOGIN</td>
<td>3005</td>
<td># 需要登录</td>
</tr>
<tr>
<td>ERROR_CODE_LOGIN_ON_OTHER_DEVICE</td>
<td>3006</td>
<td># 其它设备登录</td>
</tr>
<tr>
<td>ERROR_CODE_LESSON_RESTART</td>
<td>3007</td>
<td># 重置了课程，仅供开发测试阶段</td>
</tr>
<tr>
<td>ERROR_CODE_INVALID_MESSAGE</td>
<td>3008</td>
<td># 错误的消息格式</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>FORBIDDEN</td>
<td>403</td>
<td>登录校验错误，需要重新登录</td>
</tr>
<tr>
<td>NOT_ACCEPTABLE</td>
<td>406</td>
<td>课程没开始或者不存在</td>
</tr>
<tr>
<td>INTERNAL_SERVER_ERROR</td>
<td>500</td>
<td>其它服务器错误</td>
</tr>
</tbody>
</table>
<p><strong> 各个消息详细内容格式约定 </strong></p>
<ul>
<li>ping</li>
</ul>
<p>消息内容:</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>timestamp</td>
<td>long</td>
<td>时间戳，单位毫秒</td>
</tr>
</tbody>
</table>
<ul>
<li>pong
消息内容:</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>timestamp</td>
<td>long</td>
<td>将收到的ping包里的timestamp再立即用pong消息发还回去</td>
</tr>
<tr>
<td>delay</td>
<td>long</td>
<td>自己本地的timestamp 减去 ping包里的timestap; 客户端可根据pong包返回的delay修复自己时间轴偏差。</td>
</tr>
</tbody>
</table>
<ul>
<li>get_schedule
消息内容:</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>default</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>first_stage</td>
<td>int</td>
<td>0</td>
<td>第一个场景的index, 以0开始计数，包括第一个场景</td>
</tr>
<tr>
<td>last_stage</td>
<td>int</td>
<td>-1</td>
<td>最后一个场景的index, 以0开始计数，包括最后一个场景</td>
</tr>
<tr>
<td>no_content</td>
<td>bool</td>
<td>是否包含场景详细内容</td>
</tr>
</tbody>
</table>
<ul>
<li>schedule
> 注意：schedule消息中不一定包含所有的场景；服务器端主动发送的schedule消息中一般只包含变更的stages部分；客户端如果要获得全部的场景，需要自己发送get_schedule命令给服务器；</li>
</ul>
<p>消息内容:</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>stages</td>
<td>list</td>
<td>场景列表</td>
</tr>
<tr>
<td>current_stage</td>
<td>int</td>
<td>当前场景index</td>
</tr>
<tr>
<td>total_stage</td>
<td>int</td>
<td>场景总数</td>
</tr>
</tbody>
</table>
<p>stage:</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>index</td>
<td>int</td>
<td>第几个场景，以0开始；</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>场景名称</td>
</tr>
<tr>
<td>content</td>
<td>dict</td>
<td>场景内容和结果数据，部分场景下需要，每个场景内容不一样。 可能是null, 代表不更新原因的场景内容。</td>
</tr>
<tr>
<td>state</td>
<td>string</td>
<td>已过去，进行中，未开始</td>
</tr>
<tr>
<td>start_at</td>
<td>long</td>
<td>开始时间（或者预计开始时间），单位毫秒</td>
</tr>
<tr>
<td>duration</td>
<td>long</td>
<td>实际持续时间，单位毫秒；已过去场景保证有duration, 进行中和未开始场景如果有duration, 代表固定时长，如果不能事先确定持续时间，服务器要设置将duration设置为-1；</td>
</tr>
<tr>
<td>max_duration</td>
<td>long</td>
<td>最长持续时间，单位毫秒；所有场景都有max_duration, 无论该场景的状态如何。</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>get_room
消息内容: 空字典</p>
</li>
<li>room
消息内容:</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>groups</td>
<td>list</td>
<td>分组信息，数组元素是group</td>
</tr>
<tr>
<td>users</td>
<td>list</td>
<td>所有用户信息，数组元素是user</td>
</tr>
<tr>
<td>class</td>
<td>dict</td>
<td>班级信息</td>
</tr>
<tr>
<td>lesson</td>
<td>dict</td>
<td>当前的这节课的信息</td>
</tr>
</tbody>
</table>
<p>group：</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>ID</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>组名</td>
</tr>
<tr>
<td>img</td>
<td>string</td>
<td>队旗</td>
</tr>
<tr>
<td>slogan</td>
<td>string</td>
<td>口号</td>
</tr>
<tr>
<td>total_score</td>
<td>long</td>
<td>本组内所有成员当前课堂内答题总计得分</td>
</tr>
<tr>
<td>score</td>
<td>long</td>
<td>本组内所有成员当前课堂内答题平均得分</td>
</tr>
<tr>
<td>user_id_list</td>
<td>list</td>
<td>本组内所有用户的id列表</td>
</tr>
</tbody>
</table>
<p>user：</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>ID</td>
</tr>
<tr>
<td>role</td>
<td>string</td>
<td>角色：学生，讲师，人工助教，AI助教</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>姓名/昵称</td>
</tr>
<tr>
<td>head_img</td>
<td>string</td>
<td>头像URL地址</td>
</tr>
<tr>
<td>group</td>
<td>int</td>
<td>所属组id</td>
</tr>
<tr>
<td>current_score</td>
<td>int</td>
<td>当前课堂内答题得分</td>
</tr>
<tr>
<td>correct_rate</td>
<td>float</td>
<td>当前课堂内答题正确率</td>
</tr>
<tr>
<td>rank_in_group</td>
<td>int</td>
<td>当前课堂内答题得分组内排名</td>
</tr>
<tr>
<td>rank_in_class</td>
<td>int</td>
<td>当前课堂内答题得分班级内排名</td>
</tr>
<tr>
<td>total_exercises_count</td>
<td>int</td>
<td>到目前场景为止，该课堂已经做了多少题目（不包括热身环节的题目）</td>
</tr>
<tr>
<td>correct_exercises_count</td>
<td>int</td>
<td>到目前场景为止，该用户在该课堂一共作正确了多少题目（不包括热身环节的题目）</td>
</tr>
<tr>
<td>finished_exercises_count</td>
<td>int</td>
<td>到目前场景为止，该用户在该课堂一共作了多少题目（不包括热身环节的题目）</td>
</tr>
<tr>
<td>allowed_to_hong_bao</td>
<td>bool</td>
<td>该用户是否可以去抢红包</td>
</tr>
<tr>
<td>is_later</td>
<td>int</td>
<td>迟到的毫秒数</td>
</tr>
<tr>
<td>is_leave_earlier</td>
<td>int</td>
<td>早退的毫秒数</td>
</tr>
<tr>
<td>is_break</td>
<td>bool</td>
<td>中途离开时间是否超过上线（5分钟）</td>
</tr>
<tr>
<td>total_hong_bao_count</td>
<td>int</td>
<td>在该班级累计抢到的红包数目，单位分</td>
</tr>
<tr>
<td>hong_bao_count</td>
<td>int</td>
<td>在该节课上抢到的红包数目，单位分</td>
</tr>
<tr>
<td>hong_bao_title</td>
<td>int</td>
<td>红包称号</td>
</tr>
<tr>
<td>flower_count</td>
<td>int</td>
<td>拥有的鲜花数目，学生可用来送花，讲师和助教收到的鲜花数（累计，包括在外面和其它课堂获得的）</td>
</tr>
<tr>
<td>living</td>
<td>bool</td>
<td>是否在线</td>
</tr>
<tr>
<td>forbid_talk</td>
<td>（int,int）</td>
<td>被禁言开始，结束时间</td>
</tr>
<tr>
<td>face_detect_state</td>
<td>dict</td>
<td>缓存的客户端上报的面部检测数据</td>
</tr>
<tr>
<td>contacts</td>
<td>list</td>
<td>联系人列表</td>
</tr>
<tr>
<td>absenteeism_lesson_count</td>
<td>int</td>
<td>历史缺席课数目,不包括当前课</td>
</tr>
<tr>
<td>achieve_count</td>
<td>int</td>
<td>历史获得的成就个数</td>
</tr>
<tr>
<td>full_attendance_rate</td>
<td>int</td>
<td>历史全勤次数</td>
</tr>
<tr>
<td>pk_win_rate</td>
<td>int</td>
<td>历史团队PK胜利次数</td>
</tr>
<tr>
<td>exercises_correct_rate</td>
<td>float</td>
<td>答题正确率（包括历史和当前课堂的中断答题，不包括非课堂中的练习题）</td>
</tr>
<tr>
<td>exercises_results</td>
<td>list</td>
<td>当前课堂中的练习题得分记录数组，-1代表回答错误，-2代表该题目还没开始</td>
</tr>
<tr>
<td>banned_end</td>
<td>long</td>
<td>禁言结束时间，毫秒（相对于课程开始时间）.</td>
</tr>
<tr>
<td>praise_count</td>
<td>int</td>
<td>获取的点赞数</td>
</tr>
<tr>
<td>praise_list</td>
<td>list</td>
<td>[userid1,userid2] 该用户的点赞列表</td>
</tr>
</tbody>
</table>
<p>class:</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>班级ID</td>
</tr>
<tr>
<td>school_name</td>
<td>string</td>
<td>学校名称，纳米盒网校</td>
</tr>
<tr>
<td>class_name</td>
<td>string</td>
<td>班级名称</td>
</tr>
</tbody>
</table>
<p>lesson:</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>lesson_name</td>
<td>string</td>
<td>当前课的名称</td>
</tr>
<tr>
<td>lesson_instroduction</td>
<td>string</td>
<td>当前课的简介</td>
</tr>
<tr>
<td>teacher_name</td>
<td>string</td>
<td>授课老师姓名</td>
</tr>
<tr>
<td>teacher_head_img</td>
<td>string</td>
<td>授课老师头像的url地址</td>
</tr>
<tr>
<td>teacher_flower_count</td>
<td>long</td>
<td>授课老师鲜花数量</td>
</tr>
<tr>
<td>teacher_id</td>
<td>long</td>
<td>授课老师的ID，唯一标志一个老师</td>
</tr>
<tr>
<td>teacher_introduction</td>
<td>string</td>
<td>授课老师简介</td>
</tr>
<tr>
<td>teacher_full_body_shot</td>
<td>string</td>
<td>授课老师全身照</td>
</tr>
<tr>
<td>teacher_favorable_good_rate</td>
<td>float</td>
<td>授课老师好评率</td>
</tr>
<tr>
<td>teacher_sign</td>
<td>string</td>
<td>授课老师签名</td>
</tr>
<tr>
<td>instructor_id</td>
<td>long</td>
<td>助教的ID</td>
</tr>
<tr>
<td>instructor_name</td>
<td>string</td>
<td>助教的姓名</td>
</tr>
<tr>
<td>instructor_head_img</td>
<td>string</td>
<td>助教的头像的URL</td>
</tr>
<tr>
<td>instructor_flower_count</td>
<td>long</td>
<td>助教的鲜花数量</td>
</tr>
<tr>
<td>instructor_introduction</td>
<td>string</td>
<td>助教老师简介</td>
</tr>
<tr>
<td>instructor_full_body_shot</td>
<td>string</td>
<td>助教老师全身照</td>
</tr>
<tr>
<td>instructor_favorable_good_rate</td>
<td>float</td>
<td>助教老师好评率</td>
</tr>
<tr>
<td>instructor_sign</td>
<td>string</td>
<td>助教老师签名</td>
</tr>
<tr>
<td>AI_instructor_id</td>
<td>long</td>
<td>智能机器人助教ID</td>
</tr>
<tr>
<td>AI_instructor_name</td>
<td>string</td>
<td>智能机器人助教的姓名</td>
</tr>
<tr>
<td>AI_instructor_head_img</td>
<td>string</td>
<td>智能机器人助教的头像的URL</td>
</tr>
<tr>
<td>AI_instructor_flower_count</td>
<td>long</td>
<td>智能机器人助教的鲜花数量</td>
</tr>
<tr>
<td>AI_instructor_introduction</td>
<td>string</td>
<td>智能机器人助教简介</td>
</tr>
<tr>
<td>AI_instructor_full_body_shot</td>
<td>string</td>
<td>智能机器人助教全身照</td>
</tr>
<tr>
<td>AI_instructor_favorable_good_rate</td>
<td>float</td>
<td>智能机器人助教好评率</td>
</tr>
<tr>
<td>AI_instructor_sign</td>
<td>string</td>
<td>智能机器人助教签名</td>
</tr>
</tbody>
</table>
<ul>
<li>enter_stage
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>stage_index</td>
<td>int</td>
<td>进入的starge index.</td>
</tr>
<tr>
<td>timestamp</td>
<td>long</td>
<td>进入这个场景的本地时间戳.</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>new_user_enter
消息内容：user</p>
</li>
<li>
<p>user_leave
消息内容：user</p>
</li>
<li>
<p>login_on_other_device
消息内容：空字典</p>
</li>
<li>
<p>choose_group
消息内容：空字典</p>
</li>
<li>assign_group
消息内容：user</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>long</td>
<td>用户</td>
</tr>
<tr>
<td>group_id</td>
<td>long</td>
<td>组</td>
</tr>
</tbody>
</table>
<ul>
<li>finished_group
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>users</td>
<td>list</td>
<td>所有用户列表</td>
</tr>
<tr>
<td>groups</td>
<td>list</td>
<td>所有组列表</td>
</tr>
</tbody>
</table>
<ul>
<li>submit_exercise
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>exercise_id</td>
<td>long</td>
<td>练习题ID</td>
</tr>
<tr>
<td>stage_index</td>
<td>int</td>
<td>对应的练习题结果展示场景index</td>
</tr>
<tr>
<td>is_correct</td>
<td>bool</td>
<td>是否正确</td>
</tr>
<tr>
<td>user_answer</td>
<td>string</td>
<td>用户答案</td>
</tr>
<tr>
<td>score</td>
<td>long</td>
<td>得分</td>
</tr>
<tr>
<td>speed</td>
<td>long</td>
<td>耗时，单位毫秒</td>
</tr>
</tbody>
</table>
<ul>
<li>finished_exercise
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>long</td>
<td>用户ID</td>
</tr>
<tr>
<td>stage_index</td>
<td>int</td>
<td>对应的练习题结果展示场景index</td>
</tr>
<tr>
<td>score</td>
<td>long</td>
<td>本中断点答题得分汇总</td>
</tr>
<tr>
<td>time_consume</td>
<td>long</td>
<td>本中断点答题用时</td>
</tr>
<tr>
<td>correct_rate</td>
<td>float</td>
<td>正确率</td>
</tr>
</tbody>
</table>
<ul>
<li>pk_summary
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>stage_index</td>
<td>int</td>
<td>对应的练习题结果展示场景index</td>
</tr>
<tr>
<td>groups_results</td>
<td>list</td>
<td>各小组及其得分信息</td>
</tr>
</tbody>
</table>
<p>group_results 内容：</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>group_id</td>
<td>long</td>
<td>小组id</td>
</tr>
<tr>
<td>score</td>
<td>long</td>
<td>本中断点所有组员答题得分汇总</td>
</tr>
<tr>
<td>total_score</td>
<td>long</td>
<td>所有组员所有答题得分汇总</td>
</tr>
<tr>
<td>average_time_consume</td>
<td>long</td>
<td>本中断点所有组员答题用时的平均值</td>
</tr>
<tr>
<td>average_correct_rate</td>
<td>float</td>
<td>本中断点所有组员答题的正确率</td>
</tr>
<tr>
<td>rank</td>
<td>list</td>
<td>组内排名，每个元素是(user_id, score, speed)</td>
</tr>
</tbody>
</table>
<ul>
<li>get_pk_summary
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>stage_index</td>
<td>int</td>
<td>对应的练习题结果展示场景index</td>
</tr>
</tbody>
</table>
<ul>
<li>prepare_hong_bao_falling
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>timestamp</td>
<td>long</td>
<td>红包雨开始时间戳，大概在10秒后。</td>
</tr>
<tr>
<td>access</td>
<td>string</td>
<td>YES/NO, 收到这个消息的用户是否有权限抢红包</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>get_hong_bao_access
消息内容：空字典</p>
</li>
<li>hong_bao_access
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>access</td>
<td>string</td>
<td>YES/NO, 收到这个消息的用户是否有权限抢红包</td>
</tr>
</tbody>
</table>
<ul>
<li>open_hong_bao
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>客户端自己标记的红包唯一标志。</td>
</tr>
</tbody>
</table>
<ul>
<li>hong_bao_content
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>long</td>
<td>客户端自己标记的红包唯一标志。</td>
</tr>
<tr>
<td>content_type</td>
<td>string</td>
<td>人民币，学分，积分等</td>
</tr>
<tr>
<td>count</td>
<td>long</td>
<td>数量，人民币情况下单位是 分。</td>
</tr>
</tbody>
</table>
<ul>
<li>send_hong_bao
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_id</td>
<td>long</td>
<td>用户ID</td>
</tr>
<tr>
<td>content_type</td>
<td>string</td>
<td>人民币，学分，积分等</td>
</tr>
<tr>
<td>count</td>
<td>long</td>
<td>数量，人民币情况下单位是 分。</td>
</tr>
</tbody>
</table>
<ul>
<li>hong_bao_stop_falling
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>stage_index</td>
<td>int</td>
<td>对应的练习题结果展示场景index</td>
</tr>
<tr>
<td>users</td>
<td>list</td>
<td>用户信息，红包数据包含在用户信息里</td>
</tr>
</tbody>
</table>
<ul>
<li>message_to_robot
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>message</td>
<td>string</td>
<td>发送给当前课程的AI机器人消息</td>
</tr>
</tbody>
</table>
<ul>
<li>message_to_user
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_user_id</td>
<td>long</td>
<td>目标用户ID</td>
</tr>
<tr>
<td>from_user_id</td>
<td>long</td>
<td>来自用户ID</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>消息内容</td>
</tr>
</tbody>
</table>
<ul>
<li>flower_to_user
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_user_id</td>
<td>long</td>
<td>目标用户ID</td>
</tr>
<tr>
<td>from_user_id</td>
<td>long</td>
<td>来自用户ID</td>
</tr>
<tr>
<td>count</td>
<td>int</td>
<td>消耗的鲜花数量</td>
</tr>
<tr>
<td>remaincount</td>
<td>int</td>
<td>剩余的鲜花数量</td>
</tr>
</tbody>
</table>
<ul>
<li>report_abuse
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_user_id</td>
<td>long</td>
<td>目标用户ID</td>
</tr>
<tr>
<td>from_user_id</td>
<td>long</td>
<td>来自用户ID</td>
</tr>
<tr>
<td>msg_seq</td>
<td>long</td>
<td>被举报消息ID</td>
</tr>
<tr>
<td>msg_content</td>
<td>str</td>
<td>被举报消息内容</td>
</tr>
<tr>
<td>grp_id</td>
<td>str</td>
<td>IM 群ID</td>
</tr>
<tr>
<td>reason</td>
<td>str</td>
<td>举报原因</td>
</tr>
</tbody>
</table>
<ul>
<li>forbid_user_talk
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_user_id</td>
<td>long</td>
<td>目标用户ID</td>
</tr>
<tr>
<td>duration</td>
<td>int</td>
<td>持续时长</td>
</tr>
</tbody>
</table>
<ul>
<li>dian_zan
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_user_id</td>
<td>long</td>
<td>目标用户ID</td>
</tr>
<tr>
<td>from_user_id</td>
<td>long</td>
<td>来自用户ID</td>
</tr>
</tbody>
</table>
<ul>
<li>cancel_dian_zan
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>key</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_user_id</td>
<td>long</td>
<td>目标用户ID</td>
</tr>
<tr>
<td>from_user_id</td>
<td>long</td>
<td>来自用户ID</td>
</tr>
</tbody>
</table>
<ul>
<li>upload_user_state
消息内容：</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">switchon</td>
<td style="text-align: left;">bool</td>
<td style="text-align: left;">否</td>
<td>false</td>
<td>是否开启face++检测</td>
</tr>
<tr>
<td style="text-align: left;">reason</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>1、摄像头权限未打开 2、用户未开启 3、设备温度太高 4、页面没有开启face++</td>
</tr>
<tr>
<td style="text-align: left;">userpresent</td>
<td style="text-align: left;">long</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>检测到人脸的时间长度，单位毫秒。用户的face_detect_state数据要从服务器上获得初始值</td>
</tr>
<tr>
<td style="text-align: left;">focus</td>
<td style="text-align: left;">long</td>
<td style="text-align: left;">否</td>
<td>0</td>
<td>正确姿势观看视频时间长度，单位毫秒</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>当视频不能及时播放时候，向用户展示loading动画，等待视频可以播放时候或者等待超时或者用户退出时候，向服务器上报本次loading情况。
消息类型 type：  video_loading
消息数据 data:   start_at： 开始loading时间，单位ms, 距课程开始的时间               end_at：  结束loading时间，单位ms, 距课程开始的时间
data_buffered:  True/False   是否有视频缓存；如果有视频缓存，一般是seek耗时；反之没缓存情况下，代表数据下载耗时</p>
</li>
<li>当客户端完成视频缓存，即全部下载完视频后上报消息给服务器：
消息类型 type：  video_buffered
消息数据 data:   buffered_at： 完成缓存时间，单位ms, 距课程开始的时间</li>
</ul>
<h4>Websocket服务器与AI机器人服务之间的消息定义</h4>
<p>课程服务器 —> AI机器人服务器：</p>
<ul>
<li>
<p>事件通知</p>
<ul>
<li>课程开始</li>
</ul>
<p>消息内容格式：</p>
<pre><code class="language-json">{
type: &quot;start_lesson&quot;,
&quot;id&quot;:  51019,
&quot;instructor_id&quot;:  3120770,
im_group_id: 0
}</code></pre></table>
<ul>
<li>课程结束</li>
</ul>
<p>消息内容格式：</p>
<pre><code class="language-json">{
type: &quot;finished_lesson&quot;,
&quot;id&quot;:  51019,
&quot;instructor_id&quot;:  3120770,
im_group_id: 0
}</code></pre></table>
</li>
<li>
<p>群发消息， 文本类型</p>
<ul>
<li>正式上课前（分组结束则正式进入上课过程）前3/2/ 1分钟提醒</li>
<li>休息结束倒计时30秒的提醒</li>
<li>布置作业环节提醒做作业</li>
<li>学员进入教室时欢迎学员来上课</li>
<li>学员送花行为提示</li>
</ul>
<p>消息内容格式：</p>
<pre><code class="language-json">{
type: &quot;message_to_group&quot;,
target_group_id: {group_im_id},
message: &quot;&quot;,
from_user_id: {AI_id},      // 以哪个机器人身份发送
}</code></pre></table>
</li>
<li>
<p>用户行为</p>
<ul>
<li>学员向 AI助教发消息
消息内容格式：
<pre><code class="language-json">{
type: &quot;message_to_robot&quot;,
target_user_id: {AI_id},  // AI机器人ID，存在多个AI机器人
message: &quot;&quot;,
from_user_id: {user_id}
}</code></pre></table></li>
<li>
<p>发私信，目前只支持人工助教向用户发私信
消息内容格式：</p>
<pre><code class="language-json">{
type: &quot;message_to_user&quot;,
target_user_id: {AI_id},
message: &quot;&quot;,
from_user_id: {user_id}
}</code></pre></table>
</li>
<li>
<p>通知 AI 服务器仍未进入课程的用户, 课程正式开始时通知一次，课程开始10分钟后通知一次
消息内容格式：</p>
<pre><code class="language-json">{
type: &quot;user_state&quot;,
data:{
users: [{&quot;id&quot;: 123, &quot;name&quot;: &quot;truan&quot;, &quot;entered&quot;: false} ],
&quot;school_name&quot;: {school_name},
&quot;class_name&quot;: {class_name},
lesson_name: {lesson_name},
timestampe: {offset} # 距正式开课的时长，单位为秒
}
}</code></pre></table>
</li>
<li>举报聊天脏话
消息内容格式：
<pre><code class="language-json">{
type: &quot;report_abuse&quot;,
target_user_id: {user_id},
msg_seq: {msg_seq},
msg_content: {msg_content},
grp_id: {im_group_id},
from_user_id: {user_id}
reason: {reason}
}</code></pre></table></li>
<li>
<p>禁言, 人工助教禁言某个用户
消息内容格式：</p>
<pre><code class="language-json">{
type: &quot;forbid_user_talk&quot;,
target_user_id: {user_id},
from_user_id: {user_id},
&quot;group_id&quot;:群聊idr,
duration: 600   // 持续时长，单位秒
}</code></pre></table>
</li>
<li>人工助教解禁用户
消息内容格式：
<pre><code class="language-json">{
type: &quot;unblock_user_talk&quot;,
target_user_id: {user_id},
from_user_id: {user_id},
&quot;group_id&quot;:群聊id
}</code></pre></table></li>
</ul>
</li>
</ul>
<p>AI机器人服务器 —> 课程服务器：</p>
<ul>
<li>私信指定用户
消息内容格式：
<pre><code class="language-json">{
type: &quot;message_to_user&quot;,
target_user_id: {user_id},
message: &quot;消息内容&quot;,
from_user_id: {user_id}     // 机器人ID
}</code></pre></table></li>
<li>禁言
消息内容格式：
<pre><code class="language-json">{
type: &quot;forbid_user_talk&quot;,
target_user_id: {user_id},
duration: 600   // 持续时长，单位秒
}</code></pre></table></li>
</ul>
<h2>参考</h2>
<ul>
<li>[技术调查](<a href="http://doc.namibox.com/index.php?s=/1&page_id=82">http://doc.namibox.com/index.php?s=/1&page_id=82</a> "技术调查")</li>
<li>[系统设计](<a href="http://doc.namibox.com/index.php?s=/1&page_id=87">http://doc.namibox.com/index.php?s=/1&page_id=87</a> "系统设计")</li>
</ul></div><h2>9.6、网校课程HTTP服务</h2><div style="margin-left:20px;"><ul>
<li>
<p>课前获取课程信息
webview向APP发送消息开启网校课堂：</p>
<pre><code class="language-json">{
command: &quot;enter_class_room&quot;,
start_at: &quot;2018-01-01 18:00&quot;,              // 上课时间
ws_url: &quot;wss://ns1.namibox.com/vschool/{class_id}/lesson/{lesson_id}/?token=01234567891231231&quot;,  // websocket服务器地址
im_group_id: 123415,
http_urls: {
    pk_info : &quot;https://namibox.com/vschool/class/{class_id}/lesson/{lesson_id}/pk_info&quot;,
    class_score: &quot;https://namibox.com/vschool/class/{class_id}/lesson/{lesson_id}/class_score&quot;,
    exercises_review: &quot;https://namibox.com/vschool/{class_id}/lesson/{lesson_id}/exercises_review&quot;,
    next_lesson: &quot;https://namibox.com/vschool/class/{class_id}/lesson/{lesson_id}/next_lesson&quot;,
    exercise: &quot;https://namibox.com/vschool/class/{class_id}/lesson/{lesson_id}/exercise&quot;，
    survey:&quot;https://dev.namibox.com/vschool/survey/{class_id}/{lesson_id}&quot;,//问卷地址
    reward_task:&quot;https://dev.namibox.com/vschool/query_reward_task/{class_id}/{lesson_id}&quot;,//查询勋章接口

}, 
}</code></pre></table>
</li>
<li>
<p>课后查看课堂结果信息:</p>
<ul>
<li>
<p>pk_info :  获得这节课的PK信息汇总
返回内容例子：</p>
<pre><code class="language-json">{
&quot;my_correct&quot;:0.666667,     //正确率
&quot;my_rank_in_class&quot;:3,     //班级排名
&quot;my_rank_in_group&quot;:1,       //组内排名
&quot;my_score&quot;:139,            //累计学分
&quot;groups_results&quot;: [
{
    &quot;average_score&quot;: 14, //平均得分
    &quot;total_score&quot;: 44, //总得分
    &quot;group_id&quot;: 1,  //分组id
    &quot;slogan&quot;: &quot;没有什么不可能是不可能的啊&quot;,//分组slogen
    &quot;name&quot;: &quot;测试E组&quot;,  //分组名称
    &quot;img&quot;:&quot;http://r.namibox.com/tina/static/app/head/boy4.jpg&quot;,  //分组logo
    &quot;rank&quot;: [
        {
            &quot;score&quot;: 170,    //个人得分
            &quot;user_id&quot;: 3127899, //
            &quot;correct_rate&quot;: 0.0, //正确率
            &quot;unfinish_exercises&quot;:0,//未答的练习题数
            &quot;correct_exercises&quot;:0,//正确的练习题数
            &quot;error_exercises&quot;:0,//错误的练习题数
            &quot;exercise_total_time&quot;:3600,//练习题总用时，单位毫秒
            &quot;nick&quot;: &quot;ghh&quot;, //用户名称
            &quot;head_img&quot;:    //用户头像 &quot;http://wf.namibox.com/user/11477/headimage/20160817_39.png@1e_160w_160h_1c_0i_1o_90Q_1x.png?1158x1179@229290&quot;,
        }, 
        {
            &quot;score&quot;: 170, 
            &quot;user_id&quot;: 3127899, 
            &quot;correct_rate&quot;: 0.0,
            &quot;unfinish_exercises&quot;:0,//未答的练习题数
            &quot;correct_exercises&quot;:0,//正确的练习题数
            &quot;error_exercises&quot;:0,//错误的练习题数
            &quot;nick&quot;: &quot;姚珊珊&quot;,
            &quot;head_img&quot;: &quot;http://wf.namibox.com/user/3127899/user_work20171030145639/20171030145710_0.jpg@1e_160w_160h_1c_0i_1o_90Q_1x.jpg?754x973@416214&quot;,

        },
    ]
}, 
{
    &quot;average_score&quot;: 14, 
    &quot;total_score&quot;: 44, 
    &quot;group_id&quot;: 2, 
    &quot;slogan&quot;: &quot;没有什么不可能是不&quot;,
    &quot;name&quot;: &quot;测试F组&quot;,
    &quot;img&quot;: &quot;http://r.namibox.com/tina/static/app/head/boy6.jpg&quot;,
    &quot;rank&quot;: [
        {
            &quot;score&quot;: 200, 
            &quot;user_id&quot;: 3127899, 
            &quot;correct_rate&quot;: 1.0,
            &quot;unfinish_exercises&quot;:0,//未答的练习题数
            &quot;correct_exercises&quot;:0,//正确的练习题数
            &quot;error_exercises&quot;:0,//错误的练习题数
            &quot;nick&quot;: &quot;ghh&quot;,
            &quot;head_img&quot;: &quot;http://wf.namibox.com/user/11477/headimage/20160817_39.png@1e_160w_160h_1c_0i_1o_90Q_1x.png?1158x1179@229290&quot;,
        }, 
        {
            &quot;score&quot;: 170, 
            &quot;user_id&quot;: 11477, 
            &quot;correct_rate&quot;: 0.0,
            &quot;unfinish_exercises&quot;:0,//未答的练习题数
            &quot;correct_exercises&quot;:0,//正确的练习题数
            &quot;error_exercises&quot;:0,//错误的练习题数
            &quot;nick&quot;: &quot;姚珊珊&quot;,
            &quot;head_img&quot;: &quot;http://wf.namibox.com/user/3127899/user_work20171030145639/20171030145710_0.jpg@1e_160w_160h_1c_0i_1o_90Q_1x.jpg?754x973@416214&quot;,

        },
    ]
}
], 
&quot;retcode&quot;: &quot;SUCC&quot;
}</code></pre></table>
</li>
<li>class_score: 获得当前用户在这节课里的获得学分信息汇总，包括红包
返回内容例子：
<pre><code class="language-json">{
&quot;rank_in_class&quot;: 1,//班级排名
&quot;rank&quot;: 0.944444,//班级排名比率
&quot;name&quot;: &quot;ghh&quot;,   //用户名称
&quot;head_img&quot;: &quot;http://wf.namibox.com/user/11477/headimage/20160817_39.png?1158x1179@229290&quot;,   //用户头像
&quot;user_id&quot;: 11477,   //用户id
&quot;score_detail&quot;: [{
&quot;personal&quot;: 0,//个人得分
&quot;average&quot;: 1,//班级平均得分
&quot;key&quot;: &quot;attendance_class_score&quot;,
&quot;desc&quot;: &quot;完整上课学分&quot;,
&quot;explain&quot;:&quot;不迟到不早退，中间没有中断，就能得到满分100分&quot;
}, {
&quot;personal&quot;: 0,
&quot;average&quot;: 0,
&quot;key&quot;: &quot;exercises_score&quot;,
&quot;desc&quot;: &quot;总答题学分&quot;,
&quot;explain&quot;:&quot;课程过程中回答问题正确，速度越快分数越高&quot;
}, {
&quot;personal&quot;: 0,
&quot;average&quot;: 0,
&quot;key&quot;: &quot;group_win_class_score&quot;,
&quot;desc&quot;: &quot;团队胜利学分&quot;,
&quot;explain&quot;:&quot;所在的战队答题PK获得最终胜利&quot;
}, {
&quot;personal&quot;: 0,
&quot;average&quot;: 1,
&quot;key&quot;: &quot;face_detect_class_score&quot;,
&quot;desc&quot;: &quot;面部追踪学分&quot;,
&quot;explain&quot;:&quot;摄像头识别到你的上课姿势越端正、听课越认真分数越高&quot;
}, {
&quot;personal&quot;: 0,
&quot;average&quot;: 5,
&quot;key&quot;: &quot;class_score&quot;,
&quot;desc&quot;: &quot;本课总学分&quot;,
&quot;explain&quot;:&quot;&quot;
}],
&quot;retcode&quot;: &quot;SUCC&quot;
}</code></pre></table></li>
<li>exercises_review: 这节课中的练习题及其讲解，包含当前用户的回答情况
返回内容例子：
<pre><code class="language-json">
{
&quot;exercises&quot;: [
{
    &quot;my_answer&quot;: &quot;&quot;, //我的答案
    &quot;my_score&quot;: 0, //我的得分
    &quot;correct&quot;: false, ////答题是否正确
    &quot;content&quot;: { //题目内容
        &quot;difficulty_level&quot;: &quot;普通&quot;, 
        &quot;question&quot;: {
            &quot;reference&quot;: &quot;&quot;, 
            &quot;attach_type&quot;: &quot;文字&quot;, 
            &quot;text&quot;: &quot;选出所给单词的中文意思&quot;, 
            &quot;reference_type&quot;: &quot;语音&quot;, 
            &quot;input_type&quot;: &quot;文字&quot;, 
            &quot;attach&quot;: &quot;apple&quot;, 
            &quot;text_type&quot;: &quot;文字&quot;, 
            &quot;input&quot;: &quot;&quot;
        }, 
        &quot;sub_type&quot;: &quot;文字&quot;, 
        &quot;score&quot;: 4, 
        &quot;id&quot;: 747152, 
        &quot;answer_analyse&quot;: &quot;&quot;, 
        &quot;type&quot;: &quot;选择题&quot;, 
        &quot;options&quot;: [
            {
                &quot;content&quot;: &quot;梨子&quot;, 
                &quot;is_correct&quot;: false, 
                &quot;content_type&quot;: &quot;文字&quot;
            }, 
            {
                &quot;content&quot;: &quot;苹果&quot;, 
                &quot;is_correct&quot;: true, 
                &quot;content_type&quot;: &quot;文字&quot;
            }, 
            {
                &quot;content&quot;: &quot;西瓜&quot;, 
                &quot;is_correct&quot;: false, 
                &quot;content_type&quot;: &quot;文字&quot;
            }, 
            {
                &quot;content&quot;: &quot;香蕉&quot;, 
                &quot;is_correct&quot;: false, 
                &quot;content_type&quot;: &quot;文字&quot;
            }
        ]
    }, 
    &quot;my_speed&quot;: 9999, //答题速度
    &quot;id&quot;: 747152   //习题id
}, </code></pre></table></li>
</ul>
<p>],
"retcode": "SUCC"
}</p>
<table width='100%' class='codestyle'><pre><code>- next_lesson: 下节课预告信息
返回内容例子：
```json
{
&quot;is_last&quot;: true,//是否最后一节课
&quot;name&quot;: &quot;没有课程&quot;,//课程名称
&quot;time&quot;: &quot;2018年01月16日 下午 02:38:32&quot;,//课程时间
&quot;desc&quot;: &quot;没有课程，没有内容&quot;,//课程内容描述
&quot;tips&quot;: &quot;&quot;,//页面提示文案
&quot;retcode&quot;: &quot;SUCC&quot;
}</code></pre></table>
<ul>
<li>exercise: 当前课程的课后练习
返回内容例子： 
<pre><code class="language-json">{
&quot;tips&quot;:&quot;注：本次作业要在2018年01月06日下午06点00分前完成&quot;,
&quot;title&quot;:&quot;本节课需要完成以下二项作业，完成后会有学分奖励！&quot;,
&quot;img_url&quot;:&quot;&quot;, //课后作业答题配图
&quot;exercise&quot;: [{
&quot;score&quot;: 0,//学分
&quot;title&quot;: &quot;配音秀课后作业&quot;,//作业名称
&quot;target&quot;: &quot;https://dev.namibox.com/vschool/review_video?schedule_id=1&quot;  //目标链接
}, {
&quot;score&quot;: 0,
&quot;title&quot;: &quot;阅读文章&quot;,
&quot;target&quot;: &quot;https://dev.namibox.com/vschool/review_video?schedule_id=1&quot;
}],
&quot;retcode&quot;: &quot;SUCC&quot;
}</code></pre></table></li>
</ul>
</li>
</ul></div><h2>9.7、领取勋章和直播中查询领取接口</h2><div style="margin-left:20px;"><h1>一、网页触发APP弹出勋章领取界面</h1>
<ul>
<li>命令参数</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>app_action</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>medal_receive</td>
<td>勋章领取</td>
</tr>
<tr>
<td style="text-align: left;">medal_msg</td>
<td style="text-align: left;">jason</td>
<td style="text-align: left;">否</td>
<td>user_name:用户名称、user_headimg:用户头像、medal_img:勋章图片、url：领取的url地址</td>
<td>勋章信息</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong>
分享和抖一抖的返回示例（历史遗留问题，暂不修改）</p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;command&quot;:&quot;app_action&quot;，
    &quot;name&quot;:&quot;medal_receive&quot;，
    &quot;medal_msg&quot;:
    {
    &quot;user_name&quot;:&quot;罗刚&quot;，
 &quot;user_headimg&quot;:&quot;https://f.namibox.com/user/18460/headimage/20171020801002_0.png@1e_32w_32h_1c_0i_1o_90Q_1x.png?631x527@41589&amp;cache=true&quot;，
 &quot;medal_img&quot;:&quot;http://dev.namibox.com/tina/static/app/vschool/my/medal_v1.png&quot;，
 &quot;url&quot;:&quot;http://dev.namibox.com/vschool/receive_medal?vs_class_id=1&amp;task_id=1&quot;

 }

}
</code></pre></table>
<h1>二、领取请求领取URl地址返回的结果</h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">error_code</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>0:表示领取成功</td>
</tr>
<tr>
<td style="text-align: left;">error_desc</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>错误描述</td>
</tr>
<tr>
<td style="text-align: left;">medal_msg</td>
<td style="text-align: left;">jason</td>
<td style="text-align: left;">否</td>
<td>medal_img:勋章图片、medal_name：勋章名称，course_name：课程名称 task_comment：目标</td>
<td>勋章信息</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
&quot;error_desc&quot;: &quot;领取成功&quot;,
&quot;error_code&quot;: 0,
&quot;medal_msg&quot;: {
    &quot;medal_img&quot;: &quot;http://dev.namibox.com/tina/static/app/vschool/my/medal_score_1.png&quot;,
    &quot;course_name&quot;: &quot;纳米盒大猫英语分级阅读（七级1）&quot;,
    &quot;task_comment&quot;: &quot;进入班级&quot;,
    &quot;medal_name&quot;: &quot;初出茅庐&quot;,
    &quot;medal_count&quot;:0
    }
}</code></pre></table>
<h1>三、领取后关闭领取界面，需要向页面发送广播消息。通知页面刷新，</h1>
<table width='100%' class='codestyle'><pre><code>消息名称：notify_receive</code></pre></table>
<h1>四、直播中领取查询接口</h1>
<table width='100%' class='codestyle'><pre><code>请求地址：http://dev.namibox.com/vschool/query_reward_task/{{网班ID}/{课程章节ID}}</code></pre></table>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">error_code</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>0:表示领取成功</td>
</tr>
<tr>
<td style="text-align: left;">error_desc</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>错误描述</td>
</tr>
<tr>
<td style="text-align: left;">medal_msg</td>
<td style="text-align: left;">list</td>
<td style="text-align: left;">是</td>
<td>medal_img:勋章图片、url：领取提交的url</td>
<td>勋章信息</td>
</tr>
<tr>
<td style="text-align: left;">medal_guide</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>提示信息</td>
</tr>
<tr>
<td style="text-align: left;">user_name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>用户真实姓名</td>
</tr>
<tr>
<td style="text-align: left;">user_headimg</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>头像</td>
</tr>
<tr>
<td style="text-align: left;">lesson_evaluation</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>课程评估</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
&quot;error_desc&quot;: &quot;查询成功&quot;,
&quot;error_code&quot;: 0,
&quot;medal_msg&quot;:[{
    &quot;medal_img&quot;: &quot;http://dev.namibox.com/tina/static/app/vschool/my/medal_score_1.png&quot;,
    &quot;url&quot;:&quot;http://dev.namibox.com/vschool/receive_medal?vs_class_id=1&amp;task_id=1&quot;
    }],
&quot;medal_guide&quot;: &quot;下面看看米娜老师给你准备的奖励吧！&quot;,
&quot;user_headimg&quot;:&quot;https://f.namibox.com/user/18460/headimage/20171020801002_0.png@1e_32w_32h_1c_0i_1o_90Q_1x.png?631x527@41589&amp;cache=true&quot;，
&quot;user_name&quot;:&quot;罗刚&quot;,
&quot;lesson_evaluation&quot;: &quot;匿名同学，很高兴你完成了大猫英语分级阅读二级6春季班班级的Lesson 2 Animal Coats课!虽然你所在的孔雀队战队在经历“热血奋战”后以失败告终，不过没有关系，下节课还有机会！ 这节课你总体表现有点糟糕，下课后一定要看回放补齐课程！而且下节课不能再迟到早退了哦！答题情况不太好，大部分题目都做错了，下次一定要认真听讲并认真做题了！这节课没有抢到红包，算是个小遗憾，不过下节课还有机会！期待你下节课更精彩的表现，别忘了完成课后作业哦！&quot;
}</code></pre></table></div><h2>9.8、课程回放</h2><div style="margin-left:20px;"><ul>
<li>
<p>打开回放
webview向APP发送消息,开始回放课程：</p>
<pre><code class="language-json">{
command: &quot;review_video&quot;,
mp4: &quot;https://www.youtube.com/watch?v=IBVo8dfqTBc&quot;,  // 视频mp4地址
title:'大猫英语-第一课',
get_review_data: &quot;https://dev.namibox.com/vschool/class/3/lesson/51379/review&quot;, //获取回放中的数据
exercise_eid:&quot;ec40722d80ca41298b7a2a374a865c45&quot;,//练习题提交id
mate_work_result: &quot;&quot; ,//获取回放中班级同学的分组、做题等信息，作为中断时候的展示
submit_result:&quot;https://dev.namibox.com/vschool/class/3/lesson/51379/submit_result&quot;// 回放中上报所有数据的接口
}</code></pre></table>
</li>
<li>
<p>获取回放中的数据</p>
<pre><code class="language-json">{
&quot;exercise_eid&quot;: &quot;fa84a69e204a11e8a55e00163e13b305&quot;,//练习题提交eid
&quot;group_info&quot;:[{

},{

}],  //分组信息
&quot;stage&quot;:[

],//stage信息, 和直播中格式相同
}</code></pre></table>
</li>
<li>
<p>上报回放信息</p>
<pre><code class="language-json">{
&quot;eid&quot;:&quot;&quot;,//初始传的eid
&quot;video_duration&quot;:&quot;&quot;,//视频时长，单位毫秒
&quot;review_duration&quot;:&quot;&quot;,//实际回看时长，单位毫秒
&quot;focus_time&quot;:&quot;&quot;,//正确姿势观看视频时间长度，单位毫秒
&quot;exercises&quot;:[
{
    &quot;exercise_id&quot;:&quot;&quot;,
    &quot;stage_index&quot;:&quot;&quot;,
    &quot;is_correct&quot;:&quot;&quot;,
    &quot;user_answer&quot;:&quot;&quot;,
    &quot;score&quot;:&quot;&quot;,
    &quot;speed&quot;:&quot;&quot;,
},
{}
]
}</code></pre></table>
</li>
<li>回放信息获取接口</li>
</ul>
<p>url:<a href="http://x.namibox.com/vschool/class/{class_id}/lesson/{lesson_id}/review/info">http://x.namibox.com/vschool/class/{class_id}/lesson/{lesson_id}/review/info</a></p>
<pre><code class="language-json">{
&quot;review_data&quot;: {
&quot;next_lesson&quot;: &quot;http://x.namibox.com/vschool/class/2/lesson/51385/next_lesson&quot;,
&quot;get_review_data&quot;: &quot;http://ut.namibox.com/vschool/playbacks/2/lesson/51385/playback-2018-06-20 10:44:45.json&quot;,
&quot;submit_result&quot;: &quot;http://x.namibox.com/vschool/class/2/lesson/51385/submit_result&quot;,
&quot;exercises_review&quot;: &quot;http://x.namibox.com/vschool/class/2/lesson/51385/review/exercises?eid=baa41230794111e89d1efc4596859445&quot;,
&quot;class_score&quot;: &quot;http://x.namibox.com/vschool/class/2/lesson/51385/review/class_score&quot;,
&quot;pk_info&quot;: &quot;http://x.namibox.com/vschool/class/2/lesson/51385/pk_info&quot;,
&quot;video&quot;: &quot;http://x.namibox.com/api/app/video?video=f4b3870db2893fb074dcdb92a2f8c7b5&amp;_ts=1521536383&quot;,
&quot;exercise_eid&quot;: &quot;baa41230794111e89d1efc4596859445&quot;,
&quot;exercise&quot;: &quot;http://x.namibox.com/vschool/class/2/lesson/51385/exercise&quot;
},
&quot;retcode&quot;: &quot;SUCC&quot;,
&quot;user&quot;: {
&quot;head_img&quot;: &quot;http://dev.namibox.com/tina/static/app/head/boy2.jpg&quot;,
&quot;user_id&quot;: 3128790,
&quot;name&quot;: &quot;我孟&quot;
}
}</code></pre></table></div><h2>9.9、网校通知提醒设置</h2><div style="margin-left:20px;"><ul>
<li>获取网校通知提醒的权限
webview向APP发送消息,获取部分系统权限：
<pre><code class="language-json">{
command: &quot;vschool_notice_policy&quot;,
}</code></pre></table></li>
</ul>
<p>返回json格式：</p>
<pre><code class="language-json">{
    app_notice: &quot;true&quot;, // 纳米盒app通知权限，
}</code></pre></table>
<ul>
<li>跳转系统通知权限的页面（越精确越好）
webview向APP发送消息,获取部分系统权限：
<pre><code class="language-json">{
command: &quot;change_app_notice_policy&quot;,
}</code></pre></table></li>
</ul></div><h2>9.10、未读消息通知样式</h2><div style="margin-left:20px;"><ul>
<li>网校消息盒子 设置未读消息</li>
</ul>
<pre><code class="language-json">{
    command: &quot;set_is_read&quot;,
    value_dict : {'message_list_notice':0,
        'message_list_report':5,
        'message_list_comment':200,
        'message_list_message':0｝
    //0表示不展示红点，其他的数字只要不是0，就展示为红点,
    //key表示为tab页的view_name
}</code></pre></table></div><h2>9.11、下发网校课程表</h2><div style="margin-left:20px;"><ul>
<li>下发网校课程表</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>class_schedule</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">scheduleurl</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>请求课表地址</td>
</tr>
<tr>
<td style="text-align: left;">vs_class_ids</td>
<td style="text-align: left;">list</td>
<td style="text-align: left;">否</td>
<td></td>
<td>班级ID数组</td>
</tr>
</tbody>
</table>
<p><strong>请求URL：scheduleurl</strong> </p>
<ul>
<li><code>https://namibox.com/vschool/classschedule</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>POST </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">vs_class_ids</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">list</td>
<td>班级ID数组</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>备注：无</p>
<p><strong>返回示例</strong></p>
</li>
</ul>
<table width='100%' class='codestyle'><pre><code> {
    &quot;3&quot;: [
        {
            &quot;start_at&quot;: &quot;2018-01-20 21:33:39&quot;,
            &quot;videourl&quot;: &quot;http://nms.namibox.com/tina/static/v_0079089423d2e0.mp4&quot;,
            &quot;size&quot;: 191096291
        },
        {
            &quot;start_at&quot;: &quot;2018-02-07 18:05:00&quot;,
            &quot;videourl&quot;: &quot;http://nms.namibox.com/tina/static/v_008944cf834cde.mp4&quot;,
            &quot;size&quot;: 497755661
        },
        {
            &quot;start_at&quot;: &quot;2018-02-12 19:00:00&quot;,
            &quot;videourl&quot;: &quot;http://nms.namibox.com/tina/static/v_007920abe1cc74-1.mp4&quot;,
            &quot;size&quot;: 342531107
        },
        {
            &quot;start_at&quot;: &quot;2018-02-19 10:00:00&quot;,
            &quot;videourl&quot;: &quot;http://nms.namibox.com/tina/static/v_008896dea9d458.mp4&quot;,
            &quot;size&quot;: 471668633
        },
        {
            &quot;start_at&quot;: &quot;2018-02-26 10:00:00&quot;,
            &quot;videourl&quot;: &quot;http://nms.namibox.com/tina/static/v_00792943f1eadd.mp4&quot;,
            &quot;size&quot;: 293357891
        },
        {
            &quot;start_at&quot;: &quot;2018-03-05 10:00:00&quot;,
            &quot;videourl&quot;: &quot;http://nms.namibox.com/tina/static/v_0079036b8937a9.mp4&quot;,
            &quot;size&quot;: 310660630
        }
    ]
}
</code></pre></table></div><h2>9.12、面部注册接口</h2><div style="margin-left:20px;"><ul>
<li>
<p>oss 请求token
url：<a href="https://dev.namibox.com/vschool/get_oss_utoken?objectKey=vschool/facial">https://dev.namibox.com/vschool/get_oss_utoken?objectKey=vschool/facial</a>
result：</p>
<pre><code class="language-json">{
&quot;AccessKeySecret&quot;: &quot;HR3fYuy1v6QxHZmApzFajTzax5XKo5QZjVqnoBHaa8qH&quot;, 
&quot;errcode&quot;: 0,
&quot;SecurityToken&quot;: &quot;CAISqQJ1q6Ft5B2yfSjIq/HBIvb3rph7xoO/VVbHrmo/bslDrZHPkTz2IH5Lf3ZuBuEdsfUwlWxU6P4SlqZ4QodZWFbJWpAptMQIoFv5yRJeWgPxv9I+k5SANTW5H3yShb3NAYjQSNfaZY3iCTTtnTNyxr3XbCirW0ffX7SClZ9gaKZwPGy/diEUPMpKAQFgpcQGT1azU8ygKRn3mGHdIVN1sw5n8wNF5L+439eX52if7hLzwfRHoJ/qcNr2LZtqNZJ+WdClmfMxaLHK0ClX719B/b9qkbZJvnXlxojGXgUPu0XeabqNq400c19DC/JkS/Ienp/VjuZlv+HfrYPzxitWMPtdOyalH97/m5SaR7LyaYdmJOqnZSydyLGJP5z0uQQ0JG0LtrHvgRbJ9hUagAEWEsifHxyonebeVWfoU1i5wTtfEtV9wqiOCFGG6vZi+Avob5bTJMJsRPUTyeUxvRCNIz1r+6tGQX/AGZ8bNTDZPUBRAyJfp+RYEK7vgPWk9CXIfKMXKQvyhV20UJra+LXtAjdPjHy9iGY1Hex+wQLrIHp2rhVbLD6IT/0hi8N8/Q==&quot;, 
&quot;AccessKeyId&quot;: &quot;STS.J2tiLCCGZqATWpvJjjbFoBTds&quot;, 
&quot;Expiration&quot;: &quot;2018-03-29T10:11:49Z&quot;, 
&quot;bucketName&quot;: &quot;namibox-w&quot;, 
&quot;objectKey&quot;: &quot;vschool/facial&quot;, 
&quot;endpoint&quot;: &quot;oss-cn-hangzhou.aliyuncs.com&quot;
}</code></pre></table>
</li>
<li>
<p>获取面部识别数据
url：<a href="https://dev.namibox.com/vschool/userfacial/get">https://dev.namibox.com/vschool/userfacial/get</a>
result：</p>
<pre><code class="language-json">{
&quot;retcode&quot;:&quot;SUCC&quot;,
&quot;facial&quot;:&quot;&quot; //面部识别数据
}</code></pre></table>
</li>
<li>
<p>设置面部识别数据
url：<a href="https://dev.namibox.com/vschool/userfacial/set?facial">https://dev.namibox.com/vschool/userfacial/set?facial</a>=
facial参数代表传递的数据</p>
</li>
<li>打开面部识别
command：“open_facial"</li>
</ul></div><h2>9.13、截屏笔记查看（支持删除）</h2><div style="margin-left:20px;"><h4>接口说明：</h4>
<ol>
<li>添加了删除接口
<table width='100%' class='codestyle'><pre><code>&quot;url&quot;: &quot;/vschool/del_capture&quot;,
&quot;method&quot;: &quot;get&quot;,
&quot;param&quot;: {capture_id:32}</code></pre></table>
<p>返回数据结构：</p>
<pre><code class="language-json">{
&quot;retcode&quot;: &quot;FAIL&quot;/&quot;SUCC&quot;,
&quot;description&quot;: &quot;删除成功&quot;
}</code></pre></table></li>
<li>接口传入数据结构修改：
在之前的图片查看（view_photo）接口基础上，添加了删除功能；添加了两个字段：
<ol>
<li>support_del: true/false; //是否支持删除</li>
<li>pic_ids : [1,2,3,4];    // 对应的图片对象id，用于删除指定图片。</li>
</ol></li>
</ol>
<p>对应的接口数据修改如下：</p>
<pre><code class="language-json">{
    &quot;command&quot;:&quot;view_photos&quot;,
    &quot;start_pos&quot;:1,
    &quot;pic_ids&quot;:[&quot;37&quot;,&quot;36&quot;,&quot;35&quot;,&quot;34&quot;,&quot;33&quot;,&quot;32&quot;,&quot;31&quot;,&quot;30&quot;],
    &quot;support_del&quot;:true,
    &quot;thumbnail&quot;：[
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402162539.jpg@1e_171w_102h_1c_0i_1o_90Q_1x.jpg?cache=true&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402162424.jpg@1e_171w_102h_1c_0i_1o_90Q_1x.jpg?cache=true&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402162412.jpg@1e_171w_102h_1c_0i_1o_90Q_1x.jpg?cache=true&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402161619.jpg@1e_171w_102h_1c_0i_1o_90Q_1x.jpg?cache=true&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402161223.jpg@1e_171w_102h_1c_0i_1o_90Q_1x.jpg?cache=true&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402160744.jpg@1e_171w_102h_1c_0i_1o_90Q_1x.jpg?cache=true&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402160444.jpg@1e_171w_102h_1c_0i_1o_90Q_1x.jpg?cache=true&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402160040.jpg@1e_171w_102h_1c_0i_1o_90Q_1x.jpg?cache=true&quot;
        ],
    &quot;large_pic&quot;:[
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402162539.jpg@1e_1024w_450h_0c_1i_1o_90Q_1x.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402162424.jpg@1e_1024w_450h_0c_1i_1o_90Q_1x.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402162412.jpg@1e_1024w_450h_0c_1i_1o_90Q_1x.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402161619.jpg@1e_1024w_450h_0c_1i_1o_90Q_1x.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402161223.jpg@1e_1024w_450h_0c_1i_1o_90Q_1x.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402160744.jpg@1e_1024w_450h_0c_1i_1o_90Q_1x.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402160444.jpg@1e_1024w_450h_0c_1i_1o_90Q_1x.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402160040.jpg@1e_1024w_450h_0c_1i_1o_90Q_1x.jpg&quot;
        ],
    &quot;original_pic&quot;:[
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402162539.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402162424.jpg&quot;,
&quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402162412.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402161619.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402161223.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402160744.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402160444.jpg&quot;,
        &quot;https://wf.namibox.com/vschool/capture/class_1/lesson_5635/312798420180402160040.jpg&quot;
        ]
}
</code></pre></table></div><h2>9.14、问卷调查</h2><div style="margin-left:20px;"><h1>一、查询调查问卷问题及答案接口</h1>
<table width='100%' class='codestyle'><pre><code>请求地址：http://dev.namibox.com/vschool/survey_questions/{{网班ID}/{课程章节ID}}</code></pre></table>
<ul>
<li>命令参数</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">vs_class_id</td>
<td style="text-align: left;">string</td>
<td></td>
<td>班级id</td>
</tr>
<tr>
<td style="text-align: left;">milesson_id</td>
<td style="text-align: left;">string</td>
<td></td>
<td>课程id</td>
</tr>
<tr>
<td style="text-align: left;">milesson_item_id</td>
<td style="text-align: left;">string</td>
<td></td>
<td>课程章节id</td>
</tr>
<tr>
<td style="text-align: left;">has_done</td>
<td style="text-align: left;">boolean</td>
<td></td>
<td>是否完成调查问卷</td>
</tr>
<tr>
<td style="text-align: left;">error_code</td>
<td style="text-align: left;">string</td>
<td></td>
<td>0表示查询成功</td>
</tr>
<tr>
<td style="text-align: left;">error_desc</td>
<td style="text-align: left;">string</td>
<td></td>
<td>错误描述</td>
</tr>
<tr>
<td style="text-align: left;">question_list</td>
<td style="text-align: left;">字典数组</td>
<td></td>
<td>调查问卷问题列表（已经做好排序）</td>
</tr>
<tr>
<td style="text-align: left;">question_id</td>
<td style="text-align: left;">string</td>
<td></td>
<td>问题id</td>
</tr>
<tr>
<td style="text-align: left;">question_title</td>
<td style="text-align: left;">string</td>
<td></td>
<td>问题标题</td>
</tr>
<tr>
<td style="text-align: left;">question_type</td>
<td style="text-align: left;">string</td>
<td></td>
<td>问题类型（单选题，多选题，评分题）</td>
</tr>
<tr>
<td style="text-align: left;">question_option_list</td>
<td style="text-align: left;">字典数组</td>
<td></td>
<td>选项列表</td>
</tr>
<tr>
<td style="text-align: left;">option_title</td>
<td style="text-align: left;">string</td>
<td></td>
<td>选项(评分题的选项最大值表示星星最大个数)</td>
</tr>
<tr>
<td style="text-align: left;">option_answer</td>
<td style="text-align: left;">string</td>
<td></td>
<td>所选结果(评分题的选项结果表示用户评的星星个数，其他题1表示选中)</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;milesson_id&quot;: 723,
    &quot;milesson_item_id&quot;: &quot;51385&quot;,
    &quot;question_list&quot;: [
        {
            &quot;question_title&quot;: &quot;这节课满足你的期待吗？&quot;,
            &quot;question_option_list&quot;: [
                {
                    &quot;option_title&quot;: &quot;1&quot;,
                    &quot;option_answer&quot;: 5
                },
                {
                    &quot;option_title&quot;: &quot;2&quot;,
                    &quot;option_answer&quot;: null
                },
                {
                    &quot;option_title&quot;: &quot;3&quot;,
                    &quot;option_answer&quot;: null
                },
                {
                    &quot;option_title&quot;: &quot;4&quot;,
                    &quot;option_answer&quot;: null
                },
                {
                    &quot;option_title&quot;: &quot;5&quot;,
                    &quot;option_answer&quot;: null
                }
            ],
            &quot;question_type&quot;: &quot;评分题&quot;,
            &quot;question_id&quot;: 34
        },
        {
            &quot;question_title&quot;: &quot;这节课你的整体感受如何？&quot;,
            &quot;question_option_list&quot;: [
                {
                    &quot;option_title&quot;: &quot;A.很开心&quot;,
                    &quot;option_answer&quot;: 1
                },
                {
                    &quot;option_title&quot;: &quot;B.很有收获&quot;,
                    &quot;option_answer&quot;: null
                },
                {
                    &quot;option_title&quot;: &quot;C.很激动&quot;,
                    &quot;option_answer&quot;: null
                },
                {
                    &quot;option_title&quot;: &quot;D.很轻松&quot;,
                    &quot;option_answer&quot;: 1
                },
                {
                    &quot;option_title&quot;: &quot;E.很累心&quot;,
                    &quot;option_answer&quot;: null
                }
            ],
            &quot;question_type&quot;: &quot;多选题&quot;,
            &quot;question_id&quot;: 33
        },
        {
            &quot;question_title&quot;: &quot;你觉得这节课难度如何？&quot;,
            &quot;question_option_list&quot;: [
                {
                    &quot;option_title&quot;: &quot;A.不难&quot;,
                    &quot;option_answer&quot;: 1
                },
                {
                    &quot;option_title&quot;: &quot;B.很难&quot;,
                    &quot;option_answer&quot;: null
                },
                {
                    &quot;option_title&quot;: &quot;C.太简单了&quot;,
                    &quot;option_answer&quot;: null
                }
            ],
            &quot;question_type&quot;: &quot;单选题&quot;,
            &quot;question_id&quot;: 35
        }
    ],
    &quot;vs_class_id&quot;: &quot;7&quot;,
    &quot;has_done&quot;: true,
    &quot;error_desc&quot;: &quot;查询成功&quot;,
    &quot;error_code&quot;: 0
}</code></pre></table></div><h2>9.15、答案提交规范</h2><div style="margin-left:20px;"><p>1.选择题</p>
<table width='100%' class='codestyle'><pre><code>选项本身，不要去除选项中的空格
例如：
    正确：&quot;Three bears&quot;
    错误：&quot;Threebears&quot;</code></pre></table>
<p>2.朗读题</p>
<table width='100%' class='codestyle'><pre><code>评测分数</code></pre></table>
<p>3.填空题</p>
<table width='100%' class='codestyle'><pre><code>题干包含答案
例如：
[It's] [an] English book.
[h][a][t]

[] [an] English book.</code></pre></table>
<p>4.排序题</p>
<table width='100%' class='codestyle'><pre><code>类型：数组
元素：对应的索引,没填就是-1
例如：
    [1,3,2,0]
    [3,1,-1,-1]</code></pre></table></div><h2>9.16、练习题审核</h2><div style="margin-left:20px;"><ul>
<li>
<p>打开审核</p>
<pre><code class="language-json">{
command:'verify_exercise',
exercise_info_url:'',
}</code></pre></table>
</li>
<li>获取练习题数据</li>
</ul>
<pre><code class="language-json">{
    interrupt_index:0,//当前题的index，默认是0
    interrupts:[
        {
            page:&quot;50&quot;,//ppt页码
            duration:36000,//倒计时，单位毫秒
            id:5844,//中断点id
            exercises:[
             {
            &quot;options&quot;: [{
                    &quot;content&quot;: &quot;Three rabbits.&quot;,
                    &quot;is_correct&quot;: false,
                    &quot;content_type&quot;: &quot;文字&quot;
                }, {
                    &quot;content&quot;: &quot;Three birds.&quot;,
                    &quot;is_correct&quot;: false,
                    &quot;content_type&quot;: &quot;文字&quot;
                }, {
                    &quot;content&quot;: &quot;Three bears.&quot;,
                    &quot;is_correct&quot;: true,
                    &quot;content_type&quot;: &quot;文字&quot;
                }
            ],
            &quot;difficulty_level&quot;: &quot;普通&quot;,
            &quot;question&quot;: {
                &quot;attach&quot;: &quot;http://wf.namibox.com/image/resource_lib/nami_0000015923.png@1e_200w_1c_0i_1o_90Q_1l.png?ts=20180228213608&quot;,
                &quot;input&quot;: &quot;What can you see from the book cover(封面)?&quot;,
                &quot;reference&quot;: null,
                &quot;text_type&quot;: &quot;文字&quot;,
                &quot;text&quot;: &quot;Choose the best answer.&quot;,
                &quot;attach_type&quot;: &quot;图片&quot;,
                &quot;reference_type&quot;: &quot;图片&quot;,
                &quot;input_type&quot;: &quot;文字&quot;
            },
            &quot;sub_type&quot;: &quot;文字&quot;,
            &quot;score&quot;: 4.000000,
            &quot;answer_analyse&quot;: &quot;题目问的是“你能从封面上看到什么？”，封面上有三头熊（Three bears）。&quot;,
            &quot;type&quot;: &quot;选择题&quot;,
            &quot;id&quot;: 760257
        }
            ]
        }
    ]
}</code></pre></table></div></div><h1>10、订单管理</h1><div style="margin-left:20px;"><h2>10.1、订单售后状态迁移图</h2><div style="margin-left:20px;"><p><img src="http://doc.namibox.com/Public/Uploads/2017-11-23/5a161b892ee4b.png" alt="" /></p></div></div><h1>11、SDK相关</h1><div style="margin-left:20px;"><h2>11.1、web与app交互命令</h2><div style="margin-left:20px;"><ul>
<li>查询App状态 （web->app）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>query_apps</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">packages</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">否</td>
<td></td>
<td>app包名数组, eg：["com.xxx.aa","com.xxx.bb","com.xxx.cc"]</td>
</tr>
</tbody>
</table>
<ul>
<li>同步返回查询结果 （app->web）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">packages</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">否</td>
<td></td>
<td>返回app状态，eg：[{"packageName":"com.xxx.aa","state":1,"progress":"0.5"},{"packageName":"com.xxx.b","state":1,"progress":"0"}},{"packageName":"com.xxx.cc","state":2,"progress":1}]</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：<em>状态码state描述：0表示未下载  , 1表示下载中，2表示已安装,3表示已下载未安装.进度progress描述：0~1，float类型</em></li>
</ul>
<hr />
<ul>
<li>apk下载进度上报（仅支持安卓）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">uploadapkprogress</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">packageName</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>com.xxx.aa</td>
</tr>
<tr>
<td style="text-align: left;">url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>对应的apk下载地址</td>
</tr>
<tr>
<td style="text-align: left;">progress</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">否</td>
<td></td>
<td>0~100   <strong>-1表示下载出错</strong></td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>备注：**</p>
</li>
<li>apk下载暂停（仅支持安卓）</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">pausepackage</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">packageName</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>com.xxx.aa</td>
</tr>
<tr>
<td style="text-align: left;">url</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>对应的apk下载地址</td>
</tr>
</tbody>
</table>
<hr />
<ul>
<li>打开指定游戏app</li>
</ul>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">openpackage</td>
<td style="text-align: left;">否</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">packageName</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>app包名</td>
</tr>
<tr>
<td style="text-align: left;">downloadurl</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>app下载地址</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：主版本在接受到该命令时，需要判断是否可以打开，如不能打开则下载，否则携带用户信息打开指定游戏app</li>
</ul></div><h2>11.2、产品和订单数据注意事项</h2><div style="margin-left:20px;"><h3>产品(购买项)</h3>
<h5>表名: jct4_products</h5>
<p><img src="http://doc.namibox.com/Public/Uploads/2018-01-22/5a6583454f773.png" alt="" /></p>
<h5>数据示例</h5>
<p><img src="http://doc.namibox.com/Public/Uploads/2018-01-22/5a6586efe6014.png" alt="" />
<img src="http://doc.namibox.com/Public/Uploads/2018-01-22/5a6586f80f68f.png" alt="" />
<img src="http://doc.namibox.com/Public/Uploads/2018-01-22/5a6586fe4a033.png" alt="" /></p>
<h5>注意录入数据必须有的字段</h5>
<p><strong>supplier_id</strong>, product_name, product_subtitle, <strong>price</strong>,count_stock,title_image,<strong>sync_url</strong>,<strong>channel</strong>,comment_content_id,detail_content_id,subtype</p>
<h3>库存</h3>
<h5>表名: jct4_products_attribute_stock</h5>
<p><img src="http://doc.namibox.com/Public/Uploads/2018-01-22/5a658acce8994.png" alt="" /></p>
<h5>数据示例</h5>
<p><img src="http://doc.namibox.com/Public/Uploads/2018-01-22/5a658c90c65b1.png" alt="" /></p>
<h5>注意录入数据必须有的字段</h5>
<p><strong>product_id</strong>, stock_count,<strong> duration</strong>(不要设成很大), price,
<strong>contract_price</strong>, <strong>scale</strong></p></div><h2>11.3、第三方游戏(SDK)开发集成全流程</h2><div style="margin-left:20px;"><p>简介:本文介绍以阳阳为例，在纳米盒app里集成第三方游戏SDK或其他应用的开发流程和注意事项。</p>
<h5>1. 供应商(第三方)需准备好集成进纳米盒的app，包括ios和android版本。其中ios app已在app store上线，android app 可以在自己(可以第三方，也可以纳米盒)的服务器下载。</h5>
<h5>2. 供应商需提供应用内产品购买清单(excel)，图片和文字资料。其中，清单里的购买项必须至少在itunes store沙盒环境下购买通过；每一个app和购买项，都必须至少有一张图片和相关文字介绍。软文可以由供应商或者纳米盒自己编写。</h5>
<h5>3. 初步数据录入</h5>
<h6>1)供应商录入</h6>
<p>对应jct4_supplier表里一条记录，后面主要使用它的id</p>
<h6>2)app应用数据录入</h6>
<p>对应jct5_gamesdk表，需要字段 app_name, <strong>sdk_name</strong>, icon, <strong>supplier_id</strong>, platform, subject, grade, detail_content_id, tutorial_content_id, <strong>download_url</strong>, memo
nms上编辑入口为 产品运营>>产品管理>>游戏sdk</p>
<h6>3)购买项数据录入</h6>
<p>对应jct4_products表,需要字段 <strong>supplier_id</strong>,product_name,price【分,测试时设为1，下同】,count, title_image, fake_price, <strong>sync_url</strong>, <strong>channel</strong>, <strong>subtype</strong>[GAMESDK]</p>
<h6>4)库存表数据录入</h6>
<p>对应jct4_products_attribute_stock表，需要字段 product_id, stock_count, <strong>duration</strong>,price,<strong>contract_price</strong>,<strong>scale</strong>
3) 4)两条注意事项，请参考 <a href="http://doc.namibox.com/index.php?s=/1&page_id=115">http://doc.namibox.com/index.php?s=/1&page_id=115</a></p>
<h5>4. 在tina3里新增sdk模块</h5>
<p>url和功能基本可以分为:iap支付验证, 微信授权登录， 纳米盒授权登录， 游戏列表页， 游戏详情页，游戏内购订单确认
以此为基础创建models, views,以及消息队列工具mns_utils</p>
<h5>5. 订单同步</h5></div><h2>11.1、API设计实现</h2><div style="margin-left:20px;"><h3>11.1.1、API整理</h3><div style="margin-left:30px;"><h2>账号密码登录</h2>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-12-13/5a30b09a2a96b.png" alt="" /></p>
<h2>微信授权登录</h2>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-12-13/5a30b180e65f2.png" alt="" /></p>
<h2>纳米盒授权登录</h2>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-12-14/5a322c8ceedfe.png" alt="" /></p>
<h2>iap支付凭证校验</h2>
<p><img src="http://doc.namibox.com/Public/Uploads/2017-12-13/5a30b25fdb93c.png" alt="" /></p></div><h3>11.1.2、游戏数据API</h3><div style="margin-left:30px;"><h3>游戏包数据</h3>
<p><img src="http://doc.namibox.com/Public/Uploads/2018-01-09/5a543e2736566.png" alt="" /></p></div></div></div><h1>12、数据统计</h1><div style="margin-left:20px;"><h2>12.1、盒粉秀</h2><div style="margin-left:20px;"><h3>12.1.1、数据模型</h3><div style="margin-left:30px;"><h2>事件明细信息表模型</h2>
<h3>表名：fanshow_event</h3>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>自增主键</td>
</tr>
<tr>
<td>info_type</td>
<td>varchar</td>
<td>信息类型（包括审核信息，投诉申诉信息等）</td>
</tr>
<tr>
<td>work_id</td>
<td>varchar</td>
<td>相关作品id（审核，投诉，申诉都需要）</td>
</tr>
<tr>
<td>user_id</td>
<td>bigint</td>
<td>相关用户id（审核员，投诉人，申诉人）</td>
</tr>
<tr>
<td>create_time</td>
<td>datetime</td>
<td>事件发生时间</td>
</tr>
<tr>
<td>result</td>
<td>varchar</td>
<td>用于记录审核结果，申诉结果，审核员变动结果</td>
</tr>
<tr>
<td>description</td>
<td>varchar</td>
<td>描述（审核员淘汰原因，审核意见，投诉原因，申诉描述等）</td>
</tr>
</tbody>
</table>
<h3>补充说明</h3>
<table width='100%' class='codestyle'><pre><code>info_type字段的字典值如下：
{
    '审核信息': 'audit'
    '投诉信息': 'complaint',
    '申诉信息': 'appeal',
    '审核员变动信息': 'auditor',
    '系统自动下线作品': 'auto_offline'
}</code></pre></table>
<h2>审核员数量统计表</h2>
<h3>表名：fanshow_auditor_statistics</h3>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>自增主键</td>
</tr>
<tr>
<td>date</td>
<td>date</td>
<td>统计日期</td>
</tr>
<tr>
<td>all_count</td>
<td>int</td>
<td>审核员总数</td>
</tr>
<tr>
<td>primary_count</td>
<td>int</td>
<td>初级审核员总数</td>
</tr>
<tr>
<td>copper_count</td>
<td>int</td>
<td>铜牌审核员总数</td>
</tr>
<tr>
<td>silver_count</td>
<td>int</td>
<td>银牌审核员总数</td>
</tr>
<tr>
<td>gold_count</td>
<td>int</td>
<td>金牌审核员总数</td>
</tr>
<tr>
<td>cancel_count</td>
<td>int</td>
<td>淘汰审核员总数</td>
</tr>
</tbody>
</table>
<h2>作品标签统计表</h2>
<h3>表名：fanshow_label_statistics</h3>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>自增主键</td>
</tr>
<tr>
<td>date</td>
<td>date</td>
<td>统计日期</td>
</tr>
<tr>
<td>info_type</td>
<td>varchar</td>
<td>信息类型（该统计表中有两种标签数据）</td>
</tr>
<tr>
<td>work_type</td>
<td>varchar</td>
<td>作品类型</td>
</tr>
<tr>
<td>label</td>
<td>varchar</td>
<td>标签</td>
</tr>
<tr>
<td>count</td>
<td>int</td>
<td>数量</td>
</tr>
</tbody>
</table>
<h2>作品审核统计表</h2>
<h3>表名：fanshow_work_statistics</h3>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>自增主键</td>
</tr>
<tr>
<td>date</td>
<td>date</td>
<td>统计日期</td>
</tr>
<tr>
<td>work_type</td>
<td>varchar</td>
<td>作品类型</td>
</tr>
<tr>
<td>pass_count</td>
<td>int</td>
<td>审核通过作品总数</td>
</tr>
<tr>
<td>block_count</td>
<td>int</td>
<td>审核未通过作品总数</td>
</tr>
</tbody>
</table></div><h3>12.1.2、各类型数据统计参数</h3><div style="margin-left:30px;"><h2>审核信息</h2>
<table width='100%' class='codestyle'><pre><code>{
    'info_type': 'audit',  # 类型
    'work_id': '678789',  # 被审核作品id
    'user_id': 123456,  # 审核员id
    'result': '通过',  # 审核结果
    'description': '作品很有新意'，  # 审核意见，只限标签
    'create_time': '2018-01-05 15:24:55'  # 当前时间
}</code></pre></table>
<h2>投诉信息</h2>
<table width='100%' class='codestyle'><pre><code>{
    'info_type': 'complaint',  # 类型
    'work_id': '678789',  # 被投诉作品id
    'user_id': 123456,  # 投诉人id
    'result': '未下线', # 本次投诉结果
    'description': '营销广告'，  # 投诉意见
    'create_time': '2018-01-05 15:24:55'  # 当前时间
}</code></pre></table>
<h2>申诉信息</h2>
<table width='100%' class='codestyle'><pre><code>{
    'info_type': 'appeal',  # 类型
    'work_id': '678789',  # 申诉的作品id
    'user_id': 123456,  # 申诉人id
    'description': '被恶意审核不通过'，  # 申诉描述
    'create_time': '2018-01-05 15:24:55'  # 当前时间
}</code></pre></table>
<h2>审核员变动信息</h2>
<table width='100%' class='codestyle'><pre><code>{
    'info_type': 'auditor',  # 类型
    'user_id': 123456,  # 审核员id
    'result': '淘汰',  # 变动结果，申请成功还是淘汰
    'description': '审核通过违法作品'，  # 淘汰原因，可选
    'create_time': '2018-01-05 15:24:55'  # 当前时间
}</code></pre></table>
<h2>系统自动下线作品信息</h2>
<table width='100%' class='codestyle'><pre><code>{
    'info_type': 'auto_offline',  # 类型
    'work_id': '678789',  # 被下线的作品id
    'user_id': 123456,  # 作者id
    'result': '下线',  # 结果
    'description': '淫秽色情'，  # 下线原因
    'create_time': '2018-01-05 15:24:55'  # 当前时间
}</code></pre></table>
<h2>审核结果信息</h2>
<table width='100%' class='codestyle'><pre><code>{
    'info_type': 'audit_result',  # 类型
    'work_id': '678789',  # 被审核作品id
    'user_id': 123456,  # 作品作者id
    'result': 'pass',  # 审核结果
    'create_time': '2018-01-05 15:24:55'  # 当前时间
}</code></pre></table></div></div></div><h1>13、oss token</h1><div style="margin-left:20px;"></div><h1>14、App5.0</h1><div style="margin-left:20px;"><h2>14.1、原生化--App基础栏目及通用栏目</h2><div style="margin-left:20px;"><p><strong>基础对象</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>对象id  （格式 1_2_3 ,其中1表示的是页面id，2表示栏目id）</td>
</tr>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">否</td>
<td></td>
<td>对象事件</td>
</tr>
</tbody>
</table>
<p><strong>基础栏目</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目id  （格式 1_2 ,其中1表示的是页面id）</td>
</tr>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>栏目类别</td>
</tr>
<tr>
<td style="text-align: left;">name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>栏目名称（用于快速索引）（非必填，例如首页banner不需要配置）</td>
</tr>
<tr>
<td style="text-align: left;">section</td>
<td style="text-align: left;">dict</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目头信息</td>
</tr>
<tr>
<td style="text-align: left;">banner</td>
<td style="text-align: left;">dic</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目可能内嵌banner（除本身是banner外）</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目数据</td>
</tr>
</tbody>
</table>
<p><strong>基础栏目section</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目的标题（非必须）</td>
</tr>
<tr>
<td style="text-align: left;">more</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目右侧的更多按钮名称</td>
</tr>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目按钮点击事件</td>
</tr>
</tbody>
</table>
<ul>
<li>备注：所有栏目都继承与基础栏目，拥有基础栏目的属性，界面在做展示时，有section属性则展示，否则不展示</li>
</ul>
<p><strong>通用事件定义 action （同web与app交互命令）</strong>
eg：
action</p>
<table width='100%' class='codestyle'><pre><code>  {
   &quot;command&quot;: &quot;openview&quot;,
    &quot;url&quot;: &quot;https://namibox.com/app/pme&quot;
    &quot;view_name&quot;:&quot;pme&quot;
  }</code></pre></table>
<ul>
<li>备注：command缺省时，默认为openview命令  eg：
<table width='100%' class='codestyle'><pre><code>{&quot;url&quot;: &quot;https://namibox.com/app/pme&quot;}</code></pre></table></li>
</ul>
<p><strong>一、广告位banner</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目id</td>
</tr>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>NBNativeCategoryBanner</td>
<td>栏目类别</td>
</tr>
<tr>
<td style="text-align: left;">section</td>
<td style="text-align: left;">dic</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目头信息(banner默认无)</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目数据</td>
</tr>
</tbody>
</table>
<p>list所包含对象：</p>
<table width='100%' class='codestyle'><pre><code>  {
  &quot;id&quot;:&quot;&quot;,  //对象id
   &quot;img&quot;: &quot;图片地址&quot;,
   &quot;video_url&quot;:,   //非必选，如果banner是视频的话，点击可直接播放，可全屏播放
    &quot;action&quot;: {}    //点击事件和video_url两者最多只存在一个事件响应
  }</code></pre></table>
<p>二、通用标签数组</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>标签图标，非必选</td>
</tr>
<tr>
<td style="text-align: left;">text</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>标签名称，非必选</td>
</tr>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td></td>
<td>标签id，非必选（例如指定标签刷新（eg：班级圈新作业数））</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>  (
      {
        &quot;id&quot;:&quot;标签id&quot;
         &quot;icon&quot;:&quot;&quot;, 
         &quot;text&quot;:&quot;阅读数&quot;,
     }，
      {
        &quot;icon&quot;:&quot;&quot;, 
         &quot;text&quot;:&quot;下载量&quot;,
      }
  )</code></pre></table></div><h2>14.2、原生化--App课内页面</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>课内页面请求接口</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://namibox.com/appnative/pschool?grade=1a</code>  </li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>get </li>
</ul>
<p><strong>参数：</strong> </p>
<ul>
<li>
<p><code>https://namibox.com/appnative/pschool/catgegoryid?grade=1a</code> </p>
<p><strong>备注</strong> </p>
</li>
<li>全量更新不需要传参数，刷新栏目时需要传递参数，栏目刷新回调只返回data数据，基础数据不返回（比如updatetime 、broadcast_register 等等）</li>
</ul>
<p><strong>json示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
  &quot;updatetime&quot;: &quot;3600&quot;,
  &quot;broadcast_register&quot;: [
    &quot;broadcast_login&quot;,
    &quot;broadcast_logout&quot;,
    &quot;broadcast_classzone&quot;,
    &quot;broadcast_game_change&quot;,
    &quot;broadcast_payment&quot;
  ],
  &quot;view_name&quot;:&quot;school&quot;,
  &quot;displayname&quot;:&quot;课内&quot;,  //页面标题
  &quot;id&quot;:&quot;1&quot;,     //页面id
  &quot;showindex&quot;:ture  //是否显示索引，默认false，该字段可缺省
  &quot;wxshare&quot;:{},   //分享需要的数据
  &quot;foot&quot;: [
    &quot;你已经游到盒底了&quot;,
    &quot;翻到底的都是学霸&quot;
  ],
  &quot;search&quot;:{
        &quot;hotwords&quot;:[&quot;点读&quot;,&quot;网校&quot;],
        &quot;searchurl&quot;:&quot;xxxx&quot;,   //跳转到新页面，随机追加hotwords（当前控件显示的热词）
  },
  &quot;data&quot;: [
    {               // banner广告位
      // 见下面广告位
    },
    {               //学习工具
      // 见下面学习工具
    },
    {               //网校模块
      // 见下面网校区段
    },
    {               //微课伴学
    // 见下面微课伴学
    },
    {               //学习资料
    // 见下面学习资料
    }
}</code></pre></table>
<h1><strong>快速索引（前端处理，和后端无关）</strong></h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>参数名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>index</td>
<td>int</td>
<td>是</td>
<td>索引</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>是</td>
<td>索引名称</td>
</tr>
</tbody>
</table>
<p>注： 快速索引数据根据页面模块动态生成
遍历data，找到栏目的name有值的，然后再加上index生成
需要和列表视图联动，一一对应</p>
<hr />
<h1><strong>一、[广告位](<a href="http://doc.namibox.com/index.php?s=/1&page_id=135">http://doc.namibox.com/index.php?s=/1&page_id=135</a> "广告位")（在通用类中，无需额外定义）</strong></h1>
<h1><strong>二、学习工具（1+4）</strong></h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>工具栏id</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>是</td>
<td>NBNativeCategoryTool</td>
</tr>
<tr>
<td>section</td>
<td>object</td>
<td>否</td>
<td>工具栏section</td>
</tr>
<tr>
<td>list</td>
<td>array</td>
<td>否</td>
<td>工具列表</td>
</tr>
</tbody>
</table>
<p><strong>list中item字段说明</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>item的id</td>
</tr>
<tr>
<td>img</td>
<td>string</td>
<td>是</td>
<td>item背景图</td>
</tr>
<tr>
<td>icon</td>
<td>string</td>
<td>是</td>
<td>item图标</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>否</td>
<td>item标题</td>
</tr>
<tr>
<td>subtitle</td>
<td>string</td>
<td>否</td>
<td>item副标题</td>
</tr>
<tr>
<td>action</td>
<td>object</td>
<td>否</td>
<td>item点击事件</td>
</tr>
</tbody>
</table>
<p>json示例</p>
<table width='100%' class='codestyle'><pre><code>{
&quot;id&quot;: 4,
      &quot;category&quot;: &quot;NBNativeCategoryTool&quot;,
      &quot;section&quot;: {                //section
        &quot;title&quot;: &quot;学习工具&quot;,
        &quot;more&quot;: &quot;所有工具&quot;,
        &quot;action&quot;: {
          &quot;command&quot;: &quot;openview&quot;,
          &quot;url&quot;: &quot;https://namibox.com/app/tools&quot;,
          &quot;view_name&quot;: &quot;&quot;
        }
      },
      &quot;list&quot;: [               //1+4
        {
          &quot;id&quot;: &quot;&quot;,
          &quot;img&quot;: &quot;&quot;,
          &quot;icon&quot;: &quot;&quot;,
          &quot;title&quot;: &quot;&quot;,
          &quot;subtitle&quot;: &quot;&quot;,
          &quot;action&quot;: {
            &quot;command&quot;: &quot;openview&quot;,
            &quot;url&quot;: &quot;https://namibox.com/app/tool/id&quot;,
            &quot;view_name&quot;: &quot;&quot;
          }
        }
      ]
}</code></pre></table>
<h1><strong>三、网校区段位</strong></h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>网校栏id</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>是</td>
<td>NBNativeCategoryOnlineschool</td>
</tr>
<tr>
<td>section</td>
<td>object</td>
<td>否</td>
<td>网校栏section</td>
</tr>
<tr>
<td>banner</td>
<td>object</td>
<td>否</td>
<td>网校栏banner</td>
</tr>
<tr>
<td>list</td>
<td>array</td>
<td>否</td>
<td>网校列表</td>
</tr>
</tbody>
</table>
<p><strong><em>banner见广告位字段说明</em></strong></p>
<p><strong>网校item字段说明</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>网校id</td>
</tr>
<tr>
<td>overflow</td>
<td>bool</td>
<td>否</td>
<td>网校是否已满</td>
</tr>
<tr>
<td>price</td>
<td>string</td>
<td>否</td>
<td>价格</td>
</tr>
<tr>
<td>img</td>
<td>string</td>
<td>否</td>
<td>item背景图</td>
</tr>
<tr>
<td>tag</td>
<td>string</td>
<td>否</td>
<td>item标签（分级作文）</td>
</tr>
<tr>
<td>icon</td>
<td>string</td>
<td>否</td>
<td>item标题左边icon</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>否</td>
<td>item标题</td>
</tr>
<tr>
<td>tags1</td>
<td>array</td>
<td>否</td>
<td>tag标签（16节课 &#124; 每周2课 &#124; 每课60分组）</td>
</tr>
<tr>
<td>tags2</td>
<td>array</td>
<td>否</td>
<td>tag标签（每节课 &lt; 25元 &#124; 1200人订购）</td>
</tr>
<tr>
<td>action</td>
<td>object</td>
<td>否</td>
<td>item点击事件</td>
</tr>
</tbody>
</table>
<p>tag字段</p>
<p>见[通用标签](<a href="http://doc.namibox.com/index.php?s=/1&page_id=135">http://doc.namibox.com/index.php?s=/1&page_id=135</a> "通用标签")</p>
<p>json示例</p>
<table width='100%' class='codestyle'><pre><code>{
  &quot;id&quot;: 5,
  &quot;category&quot;: &quot;NBNativeCategoryOnlineschool&quot;,
  &quot;section&quot;: {
    &quot;title&quot;: &quot;纳米盒网校&quot;,
    &quot;more&quot;: &quot;三上网校主页&quot;,
    &quot;action&quot;: {
      &quot;command&quot;: &quot;openview&quot;,
      &quot;url&quot;: &quot;https://namibox.com/app/onlineschools&quot;,
      &quot;view_name&quot;: &quot;&quot;
    }
  },
  &quot;banner&quot;: {
    &quot;id&quot;: &quot;&quot;,
    &quot;category&quot;: &quot;NBNativeCategoryBanner&quot;,
    &quot;list&quot;: [
      {
        &quot;action&quot;: {
          &quot;command&quot;: &quot;openview&quot;,
          &quot;url&quot;: &quot;https://namibox.com/app/banner&quot;,
          &quot;view_name&quot;: &quot;&quot;
        },
        &quot;id&quot;: &quot;&quot;,
        &quot;img&quot;: &quot;&quot;,
        &quot;video_url&quot;: &quot;&quot;
      }
    ]
  },
  &quot;list&quot;: [
  {
  &quot;icon&quot;: &quot;&quot;,
  &quot;tag&quot;: &quot;分级作文&quot;,
  &quot;title&quot;: &quot;&quot;,
  &quot;img&quot;: &quot;&quot;,
  &quot;price&quot;: &quot;1000&quot;,
  &quot;tags2&quot;: [
    {
      &quot;icon&quot;: &quot;&quot;,
      &quot;text&quot;: &quot;&quot;
    }
  ],
  &quot;tags1&quot;: [
    {
      &quot;icon&quot;: &quot;&quot;,
      &quot;text&quot;: &quot;&quot;
    }
  ],
  &quot;id&quot;: &quot;&quot;,
  &quot;action&quot;: {
    &quot;command&quot;: &quot;openview&quot;,
    &quot;url&quot;: &quot;https://namibox.com/app/pme&quot;,
    &quot;view_name&quot;: &quot;pname&quot;
  },
  &quot;overflow&quot;: true
}
  ]
}</code></pre></table>
<h1><strong>五、学习资料位</strong></h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>学习资料栏id</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>是</td>
<td>NBNativeCategoryDocument</td>
</tr>
<tr>
<td>section</td>
<td>object</td>
<td>否</td>
<td>学习资料栏section</td>
</tr>
<tr>
<td>banner</td>
<td>object</td>
<td>否</td>
<td>学习资料栏banner</td>
</tr>
<tr>
<td>list</td>
<td>array</td>
<td>否</td>
<td>学习资料列表</td>
</tr>
</tbody>
</table>
<p><strong>列表字段说明</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>id</td>
</tr>
<tr>
<td>action</td>
<td>object</td>
<td>否</td>
<td>点击事件</td>
</tr>
<tr>
<td>img</td>
<td>string</td>
<td>否</td>
<td>item背景图</td>
</tr>
<tr>
<td>icon</td>
<td>string</td>
<td>否</td>
<td>item标题左边icon</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>否</td>
<td>item标题</td>
</tr>
<tr>
<td>tags</td>
<td>array</td>
<td>否</td>
<td>tag标签（查看123 &#124; 点赞333 &#124; 评论444）</td>
</tr>
</tbody>
</table>
<p>tag字段
见[通用标签](<a href="http://doc.namibox.com/index.php?s=/1&page_id=135">http://doc.namibox.com/index.php?s=/1&page_id=135</a> "通用标签")</p>
<p>json示例</p>
<table width='100%' class='codestyle'><pre><code>{
  &quot;id&quot;: 7,
  &quot;category&quot;: &quot;NBNativeCategoryDocument&quot;,
  &quot;section&quot;: {
    &quot;title&quot;: &quot;学习资料&quot;
  },
  &quot;banner&quot;: {
    &quot;id&quot;: &quot;&quot;,
    &quot;category&quot;: &quot;NBNativeCategoryBanner&quot;,
    &quot;list&quot;: [
      {
        &quot;action&quot;: {
          &quot;command&quot;: &quot;openview&quot;,
          &quot;url&quot;: &quot;https://namibox.com/app/documents&quot;,
          &quot;view_name&quot;: &quot;&quot;
        },
        &quot;id&quot;: &quot;&quot;,
        &quot;img&quot;: &quot;&quot;,
        &quot;video_url&quot;: &quot;&quot;
      }
    ]
  },
  &quot;list&quot;: [
    {
  &quot;icon&quot;: &quot;&quot;,
  &quot;title&quot;: &quot;&quot;,
  &quot;img&quot;: &quot;&quot;,
  &quot;tags&quot;: [
    {
      &quot;icon&quot;: &quot;&quot;,
      &quot;text&quot;: &quot;&quot;
    }
  ],
  &quot;id&quot;: &quot;&quot;,
  &quot;action&quot;: {
    &quot;command&quot;: &quot;openview&quot;,
    &quot;url&quot;: &quot;https://namibox.com/app/pme&quot;,
    &quot;view_name&quot;: &quot;pname&quot;
  },
  &quot;left_action&quot;: {
    &quot;command&quot;: &quot;openview&quot;,
    &quot;url&quot;: &quot;https://namibox.com/app/pme&quot;,
    &quot;view_name&quot;: &quot;pname&quot;
  }
}
  ]
}</code></pre></table>
<h1>六、微课伴学</h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>学习资料栏id</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>是</td>
<td>NBNativeCategoryAccompany</td>
</tr>
<tr>
<td>section</td>
<td>object</td>
<td>否</td>
<td></td>
</tr>
<tr>
<td>banner</td>
<td>object</td>
<td>否</td>
<td></td>
</tr>
<tr>
<td>list</td>
<td>array</td>
<td>否</td>
<td>数据列表</td>
</tr>
</tbody>
</table>
<p>数据list结构：</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段名</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>background</td>
<td>string</td>
<td>卡牌背景图</td>
</tr>
<tr>
<td>tag</td>
<td>string</td>
<td>课程标签</td>
</tr>
<tr>
<td>tag_background</td>
<td>string</td>
<td>tag背景图</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>课程标题</td>
</tr>
<tr>
<td>keywords</td>
<td>string</td>
<td>关键词,讲所有关键词组合成一个字符串，用“│”分割</td>
</tr>
<tr>
<td>day_price</td>
<td>float</td>
<td>每天价格（课程总价/课时数）</td>
</tr>
<tr>
<td>total_price</td>
<td>float</td>
<td>课程总价</td>
</tr>
<tr>
<td>order_number</td>
<td>string</td>
<td>订购人数信息</td>
</tr>
<tr>
<td>action</td>
<td>object</td>
<td></td>
</tr>
<tr>
<td>teachers</td>
<td>array</td>
<td>老师列表, 最多显示2个老师，超过显示“xx位老师正在招生”</td>
</tr>
</tbody>
</table>
<p>老师列表结构：</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段名</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>icon</td>
<td>string</td>
<td>老师头像</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>老师名称</td>
</tr>
</tbody>
</table></div><h2>14.3、原生化--App课外页面</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>课外页面请求接口</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li>
<p><code>https://namibox.com/appnative/pouter</code>  </p>
</li>
<li>备注：参数及返回格式同课内</li>
</ul>
<hr />
<p>一、免费专区（免费专区同我页面的个人栏目，此处不需要额外定义）</p>
<p>二、精品推荐位</p>
<p>三、内容列表1（平铺式）</p>
<p>四、内容列表2（平铺式）</p>
<p>五、内容列表3（滚动式）</p>
<p><strong>json示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
  &quot;updatetime&quot;: &quot;3600&quot;,
  &quot;broadcast_register&quot;: [
    &quot;broadcast_payment&quot;
  ],
  &quot;foot&quot;: [
    &quot;你已经游到盒底了&quot;,
    &quot;翻到底的都是学霸&quot;
  ],
  &quot;data&quot;: [
    {               //
      //
    }
    ]
}</code></pre></table>
<p><strong>通用字段</strong>
<em>section</em></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>参数名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>title</td>
<td>string</td>
<td>否</td>
<td>section标题</td>
</tr>
<tr>
<td>icon</td>
<td>string</td>
<td>否</td>
<td>section图标</td>
</tr>
<tr>
<td>button</td>
<td>string</td>
<td>否</td>
<td>section按钮标题</td>
</tr>
<tr>
<td>action</td>
<td>object</td>
<td>否</td>
<td>section按钮事件</td>
</tr>
</tbody>
</table>
<p><em>action</em></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>参数名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>command</td>
<td>string</td>
<td>否</td>
<td>socket的command</td>
</tr>
<tr>
<td>url</td>
<td>string</td>
<td>否</td>
<td>web页面链接</td>
</tr>
<tr>
<td>view_name</td>
<td>string</td>
<td>否</td>
<td>本地页面名称</td>
</tr>
</tbody>
</table>
<h1>一、banner</h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>参数名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>板块id</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>是</td>
<td>板块类别</td>
</tr>
<tr>
<td>list</td>
<td>Array</td>
<td>是</td>
<td>展示列表</td>
</tr>
</tbody>
</table>
<h3>json示例</h3>
<table width='100%' class='codestyle'><pre><code>{
        &quot;id&quot;: 1,
        &quot;category&quot;: &quot;native_outer_banner&quot;,
        &quot;list&quot;: [
                {
                &quot;id&quot;: &quot;1&quot;, //对象id
                &quot;img &quot;: &quot;图片地址&quot;
                &quot;video_url&quot;:&quot;https://video.mp4&quot;  //非必选，如果banner是视频的话，点击可直接播放，可全屏播放
                &quot;action&quot;: {   //点击事件和video_url两者最多只存在一个事件响应
                        &quot;command&quot;: &quot;&quot;,
                        &quot;url&quot;: &quot;&quot;,
                        &quot;view_name&quot;: &quot;&quot;
                    }
                }
}</code></pre></table>
<h1>二、精品内容专区</h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>栏目id</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>是</td>
<td>栏目类别</td>
</tr>
<tr>
<td>section</td>
<td>object</td>
<td>否</td>
<td>栏目section</td>
</tr>
<tr>
<td>list</td>
<td>array</td>
<td>否</td>
<td>栏目列表</td>
</tr>
</tbody>
</table>
<h2><strong>list中item字段说明</strong></h2>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>item的id</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>否</td>
<td>item名称</td>
</tr>
<tr>
<td>icon</td>
<td>string</td>
<td>否</td>
<td>item图标</td>
</tr>
<tr>
<td>action</td>
<td>object</td>
<td>否</td>
<td>item点击事件</td>
</tr>
</tbody>
</table>
<h3>json示例</h3>
<table width='100%' class='codestyle'><pre><code>{
&quot;id&quot;: 4,
      &quot;category&quot;: &quot;NBNativeOlessonRegions&quot;,
      &quot;list&quot;:[//两个按钮
        {
            &quot;img&quot;:&quot;图片地址&quot;,
            &quot;bigImg&quot;: &quot;https://u.namibox.com/goods/hot_sale&quot;,

            &quot;action&quot;: {               //按钮事件
                &quot;command&quot;: &quot;openview&quot;,
                &quot;url&quot;: &quot;https://u.namibox.com/goods/hot_sale&quot;,
                &quot;view_name&quot;: &quot;&quot;
                }
        },
        {
            &quot;img&quot;:&quot;图片地址&quot;,
            &quot;bigImg&quot;: &quot;https://u.namibox.com/goods/hot_sale&quot;,
            &quot;action&quot;: {               //按钮事件
                &quot;command&quot;: &quot;openview&quot;,
                &quot;url&quot;: &quot;https://u.namibox.com/goods/goods&quot;,
                &quot;view_name&quot;: &quot;&quot;
                }
        }
      ]
      },
      &quot;section&quot;: {                //section
        &quot;title&quot;: &quot;精品内容专区&quot;
      }
}
{
&quot;id&quot;: 4,
      &quot;category&quot;: &quot;NBNativeOlessonBestZone&quot;,
        &quot;footer&quot;:{
    &quot;id&quot;:&quot;10&quot;,
    &quot;title&quot;:&quot;点击查看更多&quot;,
    &quot;action&quot;: 
            {
                &quot;command&quot;: &quot;openview&quot;,
                &quot;url&quot;: &quot;https://namibox.com/lesson/milesson_best_rank?content_type=最热&amp;lanmu=全部&quot;
            }
},
      },
      &quot;list&quot;: [   //产品列表，可能为空
        {
          &quot;id&quot;: &quot;&quot;,
          &quot;title&quot;: &quot;标题&quot;,
          &quot;subTitle&quot;:&quot;子标题&quot;,
          &quot;cover&quot;:&quot;封面url&quot;
          &quot;labels&quot;:[
                {
                    &quot;img&quot;:&quot;https://img.jpg&quot;,
                    &quot;text&quot;:&quot;content&quot;
                },
                {
                    &quot;img&quot;:&quot;https://img1.jpg&quot;,
                    &quot;text&quot;:&quot;content1&quot;
                },
                ...
          ]
          &quot;price&quot;:&quot;单价&quot;;  //168.00
          &quot;action&quot;: {
            &quot;command&quot;: &quot;openview&quot;,
            &quot;url&quot;: &quot;https://namibox.com/app/pme&quot;,
            &quot;view_name&quot;: &quot;pname&quot;
          }
        }
      ]
}</code></pre></table>
<h1>三、故事|国学|绘本|科普|艺术</h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>网校栏id</td>
</tr>
<tr>
<td>category</td>
<td>string</td>
<td>是</td>
<td>网校栏类别</td>
</tr>
<tr>
<td>section</td>
<td>object</td>
<td>否</td>
<td>网校栏section</td>
</tr>
<tr>
<td>list</td>
<td>array</td>
<td>否</td>
<td>网校列表</td>
</tr>
</tbody>
</table>
<h2><strong>list 字段说明</strong></h2>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th>字段名</th>
<th>类型</th>
<th>必须</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>string</td>
<td>是</td>
<td>item id</td>
</tr>
<tr>
<td>mediatype</td>
<td>string</td>
<td>否</td>
<td>展示类型,音频、视频，audio，video,null</td>
</tr>
<tr>
<td>cover</td>
<td>string</td>
<td>是</td>
<td>封面url</td>
</tr>
<tr>
<td>cover_icon</td>
<td>string</td>
<td>否</td>
<td>封面上图标</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>是</td>
<td>ols_square、ols_rect (长)方形</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>是</td>
<td>标题</td>
</tr>
<tr>
<td>score</td>
<td>float</td>
<td>否</td>
<td>评分0-5</td>
</tr>
<tr>
<td>labels</td>
<td>array</td>
<td>是</td>
<td>[标签数组](<a href="http://doc.namibox.com/index.php?s=/1&page_id=135">http://doc.namibox.com/index.php?s=/1&page_id=135</a> "标签数组")</td>
</tr>
</tbody>
</table>
<p>json示例</p>
<table width='100%' class='codestyle'><pre><code>{
&quot;id&quot;: 5,
      &quot;category&quot;: &quot;NBNativeOlessonListArea &quot;,
      &quot;section&quot;: {
        &quot;title&quot;: &quot;故事&quot;,
        &quot;more &quot;:&quot;全部&gt;&quot;
        &quot;action&quot;: {
          &quot;command&quot;: &quot;openview&quot;,
          &quot;url&quot;: &quot;https://namibox.com/app/pme&quot;,
          &quot;view_name&quot;: &quot;pname&quot;
        }
      },
      &quot;list&quot;: [               //条目列表
        {
          &quot;id&quot;: 0,
          &quot;type&quot;: &quot;olesson_story &quot;,
           &quot;cover&quot;: &quot;https://jpg.jpg&quot;,
           &quot;cover_icon&quot;: &quot;封面上的图标&quot;
            &quot;title&quot;:&quot;《愚公移山》&quot;
            &quot;labels&quot;[
                {
                    &quot;icon&quot;:&quot;https://pic.jpg&quot;,
                    &quot;text&quot;:&quot;content&quot;
                },
                {
                    &quot;icon&quot;:&quot;https://pic.jpg&quot;,
                    &quot;text&quot;:&quot;content1&quot;
                },
        &quot;action&quot;: {
          &quot;command&quot;: &quot;openview&quot;,
          &quot;url&quot;: &quot;https://w.namibox.com/v/austory/d/audio/000016_西游记&quot;,
          &quot;view_name&quot;: &quot;story_detail&quot;
        }
                ...
            ]
        }
      ]
}</code></pre></table></div><h2>14.4、原生化--App小鱼页面</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong></p>
<ul>
<li>Me页面请求接口</li>
</ul>
<p><strong>请求URL：</strong></p>
<ul>
<li>
<p><code>https://namibox.com/appnative/pme?grade=</code></p>
</li>
<li>备注：参数及返回格式同课内</li>
</ul>
<h1>一、班级圈</h1>
<p>栏目</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>pme_classzone</td>
</tr>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryClasscircle</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">json</td>
<td>数据</td>
</tr>
<tr>
<td style="text-align: left;">section</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">jsonstring</td>
<td>{"title":"班级圈"，"more":“创建班级圈”，“action”：“”}</td>
</tr>
</tbody>
</table>
<p>list未加入班级</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">join_class</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">bool</td>
<td>是否加入班级圈：false</td>
</tr>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>左侧图片</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>标题</td>
</tr>
<tr>
<td style="text-align: left;">subtitle</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>班级数量</td>
</tr>
<tr>
<td style="text-align: left;">student_info</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>同学加入人数</td>
</tr>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">json</td>
<td>点击事件 :点击整个view、加入班级</td>
</tr>
<tr>
<td style="text-align: left;">right_action</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">json</td>
<td>右侧点击事件</td>
</tr>
<tr>
<td style="text-align: left;">right_icon</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>右侧图片</td>
</tr>
</tbody>
</table>
<p>list加入班级</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">join_class</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">bool</td>
<td>是否加入班级圈：true</td>
</tr>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>左侧图片</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>班级圈名称</td>
</tr>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">json</td>
<td>点击事件 :点击整个view、进入班级</td>
</tr>
<tr>
<td style="text-align: left;">center_list</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">list</td>
<td>中间消息数组</td>
</tr>
<tr>
<td style="text-align: left;">group_id</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>群聊id</td>
</tr>
<tr>
<td style="text-align: left;">right_action</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">json</td>
<td>右侧点击事件 :进入班级、进入直播</td>
</tr>
<tr>
<td style="text-align: left;">right_icon</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>右侧图片</td>
</tr>
</tbody>
</table>
<p>消息</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">group_id</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>有表示群聊</td>
</tr>
<tr>
<td style="text-align: left;">msg_number</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>消息数</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>标题</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;id&quot;:&quot;pme_classzone&quot;,
    &quot;category&quot;:&quot;NBNativeCategoryClasscircle&quot;,
    &quot;list&quot;:({
            &quot;join_class&quot;:false,
            &quot;icon&quot;:&quot;imageurl&quot;,
            &quot;title&quot;:&quot;尚未加入班级圈&quot;,
            &quot;subtitle&quot;:&quot;目前有**个班级&quot;,
            &quot;student_info&quot;:&quot;已有12人加入&quot;,
            &quot;right_icon&quot;:&quot;icon&quot;,x
            &quot;action&quot;:{}   
            },
            {
            &quot;group_id&quot;:&quot;04184&quot;,
            &quot;join_class&quot;:true,
            &quot;icon&quot;:&quot;imageurl&quot;,
            &quot;title&quot;:&quot;黄埔军校1班&quot;,
            &quot;right_icon&quot;:&quot;icon&quot;,
            &quot;center_list&quot;:[{&quot;id&quot;:3123,
                                &quot;title&quot;:&quot;新消息&quot;,
                                &quot;number&quot;:4
                                },
                                {&quot;id&quot;:10001,
                                &quot;title&quot;:&quot;群消息&quot;,
                                }],
            &quot;action&quot;:{},
            &quot;right_action&quot;:{}
    }
            )
  }</code></pre></table>
<h1>二、点读及教辅</h1>
<p>栏目</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>pme_clickbook</td>
</tr>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryClickread</td>
</tr>
<tr>
<td style="text-align: left;">banner</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">dic</td>
<td>没有购买的书时始终会返回banner，app根据本地是否有书来判断是否显示banner</td>
</tr>
<tr>
<td style="text-align: left;">section</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">jsonstring</td>
<td>{"title":"点读课本和教辅"，"more":“更多”，“action”：“”}</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">json</td>
<td>数据</td>
</tr>
</tbody>
</table>
<p>list</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>书封面</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>书名称</td>
</tr>
<tr>
<td style="text-align: left;">study_time</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>累计学习时长</td>
</tr>
<tr>
<td style="text-align: left;">today_study_time</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>今日学习时长</td>
</tr>
<tr>
<td style="text-align: left;">left_action</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>左侧进入书籍页面</td>
</tr>
<tr>
<td style="text-align: left;">right_action</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">json</td>
<td>右侧点击事件 :点读、播放</td>
</tr>
<tr>
<td style="text-align: left;">right_icon</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>右侧图片</td>
</tr>
<tr>
<td style="text-align: left;">book_state</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>书籍状态：0：免费 1：收费，2：已购买</td>
</tr>
<tr>
<td style="text-align: left;">period</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>有效期，收费书才显示</td>
</tr>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>书id</td>
</tr>
</tbody>
</table>
<p><strong>补充描述</strong></p>
<p>未登录：显示本地书籍（隐藏学习进度）
登录：
1、购买的（显示学习进度）
2、本地的（显示学习进度）
3.免费书服务端如果有进度数据，会返回书本信息和进度。本地需要判断是否有下载，有下载才显示。&#64;**这里的逻辑可以再确认下*****</p>
<hr />
<p><strong>功能</strong></p>
<p>左滑删除事件</p>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;id&quot;:&quot;002&quot;,
    &quot;category&quot;:&quot;NBNativeCategoryClickread&quot;,
    &quot;list&quot;:(
            {
            &quot;icon&quot;:&quot;imageurl&quot;,
            &quot;title&quot;:&quot;一年级语文&quot;,
            &quot;book_state&quot;:&quot;2&quot;
            &quot;study_time&quot;:&quot;累计学习：3小时20分钟&quot;,
            &quot;today_study_time&quot;:&quot;今日已学：28分钟&quot;,
            &quot;period&quot;:“2018-10-01”,
            &quot;right_icon&quot;:&quot;icon&quot;,
            &quot;action&quot;:{}   
            },
            {
            &quot;icon&quot;:&quot;imageurl&quot;,
            &quot;title&quot;:&quot;一年级语文&quot;,
            &quot;book_state&quot;:&quot;0&quot;,
            &quot;right_icon&quot;:&quot;icon&quot;,
            &quot;action&quot;:{}   
            },
            )
  }</code></pre></table>
<h1>三、我的网校</h1>
<p>栏目</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryMyonlineschool</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">json</td>
<td>数据</td>
</tr>
</tbody>
</table>
<h6>list</h6>
<p>正常</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>左侧图片</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>课程名称</td>
</tr>
<tr>
<td style="text-align: left;">subtitle</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>学习进度</td>
<td>退款处理中...提示</td>
</tr>
<tr>
<td style="text-align: left;">course</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>课单元名称</td>
</tr>
<tr>
<td style="text-align: left;">remind</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>黄色提醒字段</td>
</tr>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">json</td>
<td>点击事件 :点击整个view、进入班级、加入班级</td>
</tr>
<tr>
<td style="text-align: left;">start_date</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>直播开始时间 "2018-06-18 19:35:00"</td>
</tr>
<tr>
<td style="text-align: left;">end_date</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>直播结束时间 "2018-06-18 19:35:00"</td>
</tr>
<tr>
<td style="text-align: left;">center_list</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">list</td>
<td>消息数组 ：和班级圈的消息数组一样</td>
</tr>
<tr>
<td style="text-align: left;">group_id</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>群聊id</td>
</tr>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>0:正常状态，提醒为黄色 1：直播中提醒为红色</td>
</tr>
<tr>
<td style="text-align: left;">right_action</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">json</td>
<td>右侧点击事件</td>
</tr>
<tr>
<td style="text-align: left;">right_title</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>右侧描述：+56分</td>
</tr>
<tr>
<td style="text-align: left;">right_icon</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>右侧图片</td>
</tr>
</tbody>
</table>
<p>开班确认中</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>左侧图片</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>课程名称</td>
</tr>
<tr>
<td style="text-align: left;">subtitle</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>描述</td>
</tr>
<tr>
<td style="text-align: left;">remind</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>黄色提醒字段</td>
</tr>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">json</td>
<td>点击事件</td>
</tr>
<tr>
<td style="text-align: left;">start_date</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>直播开始时间 "2018-06-18 19:35:00"</td>
</tr>
<tr>
<td style="text-align: left;">server_date</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>服务器时间 "2018-06-18 19:35:00"</td>
</tr>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>2  开班确认中</td>
</tr>
</tbody>
</table>
<p>开班失败</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>左侧图片</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>课程名称</td>
</tr>
<tr>
<td style="text-align: left;">subtitle</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>失败原因，黄色</td>
</tr>
<tr>
<td style="text-align: left;">remind</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>失败提示，红色</td>
</tr>
<tr>
<td style="text-align: left;">refund_text</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>退款进度提示</td>
</tr>
<tr>
<td style="text-align: left;">state</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>3 开班失败</td>
</tr>
<tr>
<td style="text-align: left;">change_action</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">json</td>
<td>更换时间事件，没有不显示</td>
</tr>
<tr>
<td style="text-align: left;">refund _action</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">json</td>
<td>申请退款事件，没有不显示</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;id&quot;:&quot;pme_vschool&quot;,
    &quot;category&quot;:&quot;NBNativeCategoryMyonlineschool&quot;,
    &quot;list&quot;:(
            {
            &quot;group_id&quot;:&quot;04184&quot;,
            &quot;state&quot;:0,
            &quot;icon&quot;:&quot;imageurl&quot;,
            &quot;subtitle&quot;:&quot;学习进度：2/12课&quot;,
            &quot;title&quot;:&quot;黄埔军校1班1大毛英语&quot;,
            &quot;course&quot;:&quot;第三课：animal coats&quot;,
            &quot;remind&quot;:&quot;5月8日 本周二20：34&quot;,
            &quot;right_title&quot;:&quot;去写作业&quot;,
            &quot;right_icon&quot;:&quot;icon&quot;,
            &quot;right_title&quot;:&quot;+260学分&quot;，
            &quot;start_date&quot;:&quot;&quot;2018-06-18 19:35:00&quot;&quot;,
            &quot;end_date&quot;:&quot;&quot;2018-06-19 19:35:00&quot;&quot;,
            &quot;action&quot;:{},
            &quot;right_action&quot;:{}
    },
        {
            &quot;group_id&quot;:&quot;04184&quot;,
            &quot;state&quot;:2,
            &quot;icon&quot;:&quot;imageurl&quot;,
            &quot;subtitle&quot;:&quot;等待其他成员报名中，请关注开班提醒&quot;,
            &quot;title&quot;:&quot;黄埔军校1班1大毛英语&quot;,
            &quot;remind&quot;:&quot;最晚确认时间：5.8本周三20：33&quot;,
            &quot;start_date&quot;:&quot;2018-06-18 19:35:00&quot;,
            &quot;server_date&quot;:&quot;2018-06-18 10:35:00&quot;,
            &quot;action&quot;:{},
    },
    {
            &quot;group_id&quot;:&quot;04184&quot;,
            &quot;state&quot;:3,
            &quot;icon&quot;:&quot;imageurl&quot;,
            &quot;subtitle&quot;:&quot;非常抱歉，由于报名人数不足&quot;,
            &quot;title&quot;:&quot;黄埔军校1班1大毛英语&quot;,
            &quot;remind &quot;:&quot;该班级开班失败&quot;,
            &quot;change_action&quot;:{},
            &quot;refund _action&quot;:{}
    }
            )
  }</code></pre></table>
<h1>四、我的微课堂</h1>
<p>栏目</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryMylesson</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">json</td>
<td>数据</td>
</tr>
</tbody>
</table>
<p>list</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">icon</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>左侧图片</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>微课名称</td>
</tr>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">json</td>
<td>点击左侧事件</td>
</tr>
<tr>
<td style="text-align: left;">lesson_id</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">string</td>
<td>微课id</td>
</tr>
<tr>
<td style="text-align: left;">end_date</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>有效结束时间 "2018-06-18 19:35:00"</td>
</tr>
</tbody>
</table>
<p><strong>点击交互规则</strong></p>
<p>点击按钮区域，直接去往该节课的视频播放页；
点击蓝色框内除按钮区域去往订购后的课程主页，即目录页</p>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;id&quot;:&quot;001&quot;,
    &quot;category&quot;:&quot;NBNativeCategoryMylesson&quot;,
    &quot;list&quot;:(
            {
            &quot;lesson_id&quot;:&quot;04184&quot;,
            &quot;icon&quot;:&quot;imageurl&quot;,
            &quot;title&quot;:&quot;自然拼读（1年级下）&quot;,
            &quot;end_date&quot;:&quot;&quot;2018-06-18 19:35:00&quot;&quot;,
            &quot;left_action&quot;:{},
            &quot;right_action&quot;:{}
            }
            )
  }</code></pre></table>
<h1>五、我的课外读物（类别同四，无需额外定义）</h1>
<h1>六、提醒</h1>
<p>栏目</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryTip</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">json</td>
<td>数据</td>
</tr>
</tbody>
</table>
<p>list</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>提示文字</td>
</tr>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">json</td>
<td>点击事件</td>
</tr>
<tr>
<td style="text-align: left;">tip_id</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">string</td>
<td>微课id</td>
</tr>
</tbody>
</table>
<p><strong>点击交互规则</strong></p>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;id&quot;:&quot;001&quot;,
    &quot;category&quot;:&quot;NBNativeCategoryTip&quot;,
    &quot;list&quot;:(
            {
            &quot;tip_id&quot;:&quot;04184&quot;,
            &quot;title&quot;:&quot;购买网校，可以查看更多）&quot;,
            &quot;action&quot;:{},
            }
            )
  }</code></pre></table>
<h1>我的微课伴学(顶部学习数据)</h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryMyClassInfo</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">array</td>
<td>顶部学习数据，上面3个（打卡天数、已学课时、获得爱心），下面3个（学习安排，错题本，成就）</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;id&quot;:&quot;pme_banxuetop&quot;,
    &quot;category&quot;:&quot;NBNativeCategoryMyClassInfo&quot;,
    &quot;list&quot;:[
            {
            &quot;id&quot;:&quot;pme_banxuetop_punch&quot;,
            &quot;title&quot;:&quot;打卡天数&quot;,//标题
            &quot;icon&quot;:&quot;xxx&quot;,//图标
            &quot;number&quot;:7,//图标上的数字，没有则不传
            &quot;text&quot;:&quot;&quot;,//点击弹出的文案提示
            },
            {
            &quot;id&quot;:&quot;pme_banxuetop_courses&quot;,
            &quot;title&quot;:&quot;已学课时&quot;,//标题
            &quot;icon&quot;:&quot;xxx&quot;,//图标
            &quot;number&quot;:32,//图标上的数字，没有则不传
            &quot;text&quot;:&quot;&quot;,//点击弹出的文案提示
            },
            {
            &quot;id&quot;:&quot;pme_banxuetop_hearts&quot;,
            &quot;title&quot;:&quot;获得爱心&quot;,//标题
            &quot;icon&quot;:&quot;xxx&quot;,//图标
            &quot;number&quot;:60,//图标上的数字，没有则不传
            &quot;text&quot;:&quot;&quot;,//点击弹出的文案提示
            },
            {
            &quot;id&quot;:&quot;04182&quot;,
            &quot;title&quot;:&quot;学习安排&quot;,//标题
            &quot;icon&quot;:&quot;xxx&quot;,//图标
            &quot;action&quot;:{},//点击的action，有action则点击响应action，不弹提示
            },
            {
            &quot;id&quot;:&quot;04182&quot;,
            &quot;title&quot;:&quot;错题本&quot;,//标题
            &quot;icon&quot;:&quot;xxx&quot;,//图标
            &quot;action&quot;:{},//点击的action，有action则点击响应action，不弹提示
            },
            {
            &quot;id&quot;:&quot;04182&quot;,
            &quot;title&quot;:&quot;成就&quot;,//标题
            &quot;icon&quot;:&quot;xxx&quot;,//图标
            &quot;action&quot;:{},//点击的action，有action则点击响应action，不弹提示
            }
    ]
  }</code></pre></table>
<h1>我的微课伴学(课程数据)</h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryMyClassLesson</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">array</td>
<td>课程数据</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;id&quot;:&quot;001&quot;,
    &quot;category&quot;:&quot;NBNativeCategoryMyClassLesson&quot;,
    &quot;list&quot;:[
            {
            &quot;id&quot;:&quot;04184&quot;,
            &quot;title&quot;:&quot;自然拼读&quot;,//课程名称
            &quot;icon&quot;:&quot;xxx&quot;,//课程封面
             &quot;end_date&quot;:&quot;2018-06-18 19:35:00&quot;, //有效结束时间
             &quot;server_date&quot;:&quot;&quot;,服务器时间
            &quot;subtitle&quot;:&quot;课程进度：4/7课&quot;,//课程进度，未开启则不传，客户端显示“学习进度：未开启”
            &quot;course&quot;:&quot;第11课：Animal Cote&quot;,//第几课及名称，没有则不传，客户端不显示这行
            &quot;remind&quot;:&quot;待补习课程:8&quot;,//待补课数量,传0则客户端不显示这行 标红显示
            &quot;action&quot;:{},//左侧点击的action
            &quot;right_icon&quot;:&quot;xxxxxx&quot;,//右侧引导按钮图标，如果有文字也包含在图中
            &quot;right_title&quot;:&quot;完成+7&quot;,//完成任务可获得的爱心数，不传则客户端不显示“完成+x♡”的信息
            &quot;right_title_icon&quot;:&quot;♡&quot;,//文字后的小图标
            &quot;right_action&quot;:{},//右侧点击的action
            }
    ]
  }</code></pre></table>
<h1>关注公众号</h1>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryDiyihh</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">array</td>
<td>课程数据</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;id&quot;:&quot;001&quot;,
    &quot;category&quot;:&quot;NBNativeCategoryDiyihh &quot;,
    &quot;list&quot;:[
            {
            &quot;id&quot;:&quot;04184&quot;,
            &quot;action&quot;:{},//关注公众号的action
            }
    ]
  }</code></pre></table>
<h1>=================================================</h1>
<h1>其他类型</h1>
<h1>写点什么</h1>
<p>和data平级</p>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    &quot;write_shomething&quot;:[
            {
            &quot;id&quot;:&quot;04184&quot;,
            &quot;title&quot;:&quot;&quot;,
            &quot;icon&quot;:&quot;&quot;
            &quot;action&quot;:{},//关注公众号的action
            },
                {
            &quot;id&quot;:&quot;04184&quot;,
            &quot;title&quot;:&quot;&quot;,
            &quot;icon&quot;:&quot;&quot;
            &quot;action&quot;:{},//关注公众号的action
            }
    ],
    &quot;data&quot;:[]
  }</code></pre></table></div><h2>14.5、原生化--App我页面</h2><div style="margin-left:20px;"><p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://namibox.com/appnative/puc</code>  </li>
</ul>
<p>一、个人信息banner</p>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>个人banner的ID</td>
</tr>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryPersonBanner</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">array</td>
<td>用户信息数组，内部仅一个元素</td>
</tr>
</tbody>
</table>
<p>user用户信息</p>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">user_degree</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户等级</td>
</tr>
<tr>
<td style="text-align: left;">status</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>登录状态: logout/login</td>
</tr>
<tr>
<td style="text-align: left;">userid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户ID</td>
</tr>
<tr>
<td style="text-align: left;">phonenum</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户手机号</td>
</tr>
<tr>
<td style="text-align: left;">head_image</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>用户头像</td>
</tr>
<tr>
<td style="text-align: left;">nick_name</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户昵称</td>
</tr>
<tr>
<td style="text-align: left;">user_auth</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户客服登录的密码</td>
</tr>
<tr>
<td style="text-align: left;">sessionid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户session</td>
</tr>
<tr>
<td style="text-align: left;">changetime</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>changetime</td>
</tr>
<tr>
<td style="text-align: left;">im_user</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>腾讯identifier</td>
</tr>
<tr>
<td style="text-align: left;">qrAction</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">dict</td>
<td>二维码事件</td>
</tr>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">dict</td>
<td>用户信息编辑事件</td>
</tr>
<tr>
<td style="text-align: left;">attr</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">list</td>
<td></td>
</tr>
</tbody>
</table>
<p>返回示例</p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;id&quot;:&quot;001&quot;,
    &quot;category&quot;:&quot;NBNativeCategoryPersonBanner&quot;,
    &quot;list&quot;:[{
            &quot;isLogin&quot;:true,
            &quot;head_image&quot;:&quot;url&quot;,
            &quot;status&quot;:&quot;lv14&quot;,
            &quot;nick_name&quot;:&quot;盒子A&quot;,
            &quot;userid&quot;:&quot;4099499&quot;,
            &quot;phonenum&quot;:&quot;13999999999&quot;,
            &quot;action&quot;:{},
            &quot;qrAction&quot;:{},
        }]
}
</code></pre></table>
<p>二、个人栏目</p>
<p>1、 有圆角栏目类型</p>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>个人栏目的ID</td>
</tr>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryMineColumnItem  带圆角的栏目category</td>
</tr>
<tr>
<td style="text-align: left;">section</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">object</td>
<td>个人栏目section</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">array</td>
<td>个人栏目展示列表</td>
</tr>
</tbody>
</table>
<p>list中的item</p>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>item ID</td>
</tr>
<tr>
<td style="text-align: left;">img</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>图片路径</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>标题</td>
</tr>
<tr>
<td style="text-align: left;">subtitle</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">string</td>
<td>下副标题</td>
</tr>
<tr>
<td style="text-align: left;">msgcount</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>未读消息数，和推送的属性定义(如果是红点，0代表没有红点，1代表有红点)</td>
</tr>
<tr>
<td style="text-align: left;">msgtype</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">int</td>
<td>0表示显示数字  1表示显示圆点，默认显示数字，可缺省</td>
</tr>
<tr>
<td style="text-align: left;">action</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">object</td>
<td>事件</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;id&quot;:&quot;001&quot;,
    &quot;category&quot;:&quot;NBNativeCategoryMineColumnItem&quot;
    &quot;section&quot;:{}
    &quot;list&quot;:[
                {
                    &quot;id&quot;:&quot;00101&quot;
                    &quot;icon&quot;:&quot;url&quot;,
                    &quot;title&quot;:&quot;优惠券&quot;，
                    &quot;subtitle&quot;:&quot;下部副标题&quot;
                    &quot;messageCount&quot;:&quot;2&quot;,
                    &quot;action&quot;:{}
                }，
                {
                }
            ]
}</code></pre></table>
<p>2、 无圆角栏目类型</p>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>个人栏目的ID</td>
</tr>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryNormalColumnItem   普通的栏目category</td>
</tr>
<tr>
<td style="text-align: left;">section</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">object</td>
<td>个人栏目section</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">array</td>
<td>个人栏目展示列表</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;id&quot;:&quot;001&quot;,
    &quot;category&quot;:&quot;NBNativeCategoryNormalColumnItem&quot;
    &quot;section&quot;:{}
    &quot;list&quot;:[
                {
                    &quot;id&quot;:&quot;00101&quot;
                    &quot;icon&quot;:&quot;url&quot;,
                    &quot;title&quot;:&quot;优惠券&quot;，
                    &quot;subtitle&quot;:&quot;下部副标题&quot;
                    &quot;messageCount&quot;:&quot;2&quot;,
                    &quot;action&quot;:{}
                }，
                {
                }
            ]
}</code></pre></table>
<p><strong>接口数据返回格式</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;updatetime&quot;: &quot;3600&quot;,
    &quot;displayname&quot;: &quot;我的&quot;,
    &quot;view_name&quot;: &quot;main_user&quot;,
    &quot;broadcast_register&quot;: [
        &quot;broadcast_login&quot;,
        &quot;broadcast_logout&quot;
    ],
    &quot;foot&quot;: [
        &quot;你已经游到盒底了&quot;,
        &quot;我可是有底线的！&quot;
    ],
    &quot;data&quot;: [
        {
            &quot;category&quot;: &quot;NBNativeCategoryPersonBanner&quot;,
            &quot;list&quot;: [
                {
                    &quot;status&quot;: &quot;http://172.16.6.97/static/lv/lv1.png&quot;,
                    &quot;changetime&quot;: &quot;20180621223433&quot;,
                    &quot;attr&quot;: &quot;[\&quot;IM\&quot;]&quot;,
                    &quot;nick_name&quot;: &quot;彭汉田&quot;,
                    &quot;phonenum&quot;: &quot;181****2531&quot;,
                    &quot;userid&quot;: 12708967,
                    &quot;user_auth&quot;: &quot;048f291109ffe812f3989f7e335a8eeb&quot;,
                    &quot;isLogin&quot;: true,
                    &quot;sessionid&quot;: &quot;vbi5wmt7d48ah5oxemtkjzfu2s2lfymq&quot;,
                    &quot;qrAction&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/qr&quot;
                    },
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/userinfo&quot;
                    },
                    &quot;im_user&quot;: &quot;nmb_12708967&quot;,
                    &quot;head_image&quot;: &quot;http://wf.namibox.com/user/12708967/headimage/20180613607000_0.jpg?640x319@10543&quot;
                }
            ],
            &quot;id&quot;: &quot;puc_info&quot;
        },
        {
            &quot;category&quot;: &quot;NBNativeCategoryNormalColumnItem&quot;,
            &quot;list&quot;: [
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/zone/my_zone&quot;
                    },
                    &quot;subtitle&quot;: &quot;个人主页&quot;,
                    &quot;id&quot;: &quot;puc_myzone_1&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v3/my/zone.png&quot;,
                    &quot;title&quot;: &quot;我的空间&quot;
                },
                {
                    &quot;msgcount&quot;: 0,
                    &quot;subtitle&quot;: &quot;在线聊天&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v3/my/start_im.png&quot;,
                    &quot;title&quot;: &quot;我的好友&quot;,
                    &quot;msgtype&quot;: 0,
                    &quot;action&quot;: {
                        &quot;msgdot&quot;: 0,
                        &quot;command&quot;: &quot;app_action&quot;,
                        &quot;name&quot;: &quot;openim&quot;,
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/shareapp?uid=X3sBAAAAAAAn&quot;,
                        &quot;toidentifier&quot;: &quot;&quot;,
                        &quot;identifier&quot;: &quot;&quot;,
                        &quot;view_name&quot;: &quot;u_start_im&quot;,
                        &quot;region_name&quot;: &quot;popup&quot;
                    },
                    &quot;id&quot;: &quot;puc_myim_2&quot;
                },
                {
                    &quot;msgcount&quot;: 0,
                    &quot;subtitle&quot;: &quot;支持关注&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v3/my/friends_dynamic.png&quot;,
                    &quot;title&quot;: &quot;空间动态&quot;,
                    &quot;msgtype&quot;: 1,
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/zone/friends_dynamic&quot;
                    },
                    &quot;id&quot;: &quot;puc_myfollow_3&quot;
                },
                {
                    &quot;msgcount&quot;: &quot;1&quot;,
                    &quot;subtitle&quot;: &quot;新回复&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v3/my/message.png&quot;,
                    &quot;title&quot;: &quot;消息中心&quot;,
                    &quot;msgtype&quot;: 0,
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/diary/mine_new&quot;
                    },
                    &quot;id&quot;: &quot;puc_mymessage_4&quot;
                }
            ],
            &quot;id&quot;: &quot;puc_mymsg&quot;
        },
        {
            &quot;category&quot;: &quot;NBNativeCategoryMineColumnItem&quot;,
            &quot;section&quot;: {
                &quot;title&quot;: &quot;我的账户&quot;
            },
            &quot;list&quot;: [
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/my_coupon&quot;
                    },
                    &quot;id&quot;: &quot;puc_account_1&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/coupon.png&quot;,
                    &quot;title&quot;: &quot;优惠券&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/my_integral&quot;
                    },
                    &quot;id&quot;: &quot;puc_account_2&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/integral.png&quot;,
                    &quot;title&quot;: &quot;我的积分&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/my_currency&quot;
                    },
                    &quot;id&quot;: &quot;puc_account_3&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/currency.png&quot;,
                    &quot;title&quot;: &quot;我的盒币&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/my_redpack&quot;
                    },
                    &quot;id&quot;: &quot;puc_account_4&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/redpack.png&quot;,
                    &quot;title&quot;: &quot;我的红包&quot;
                }
            ],
            &quot;id&quot;: &quot;puc_account&quot;
        },
        {
            &quot;category&quot;: &quot;NBNativeCategoryMineColumnItem&quot;,
            &quot;section&quot;: {
                &quot;action&quot;: {
                    &quot;url&quot;: &quot;http://x.namibox.com/pay/my_order/all&quot;
                },
                &quot;more&quot;: &quot;全部 &gt;&quot;,
                &quot;title&quot;: &quot;我的订单&quot;
            },
            &quot;list&quot;: [
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/pay/my_order/unpaid&quot;
                    },
                    &quot;id&quot;: &quot;puc_order_1&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/order_unpaid.png&quot;,
                    &quot;title&quot;: &quot;待付款&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/pay/comment_reward&quot;
                    },
                    &quot;id&quot;: &quot;puc_order_2&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/to_comment.png&quot;,
                    &quot;title&quot;: &quot;待评论&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/pay/my_order/delivery&quot;
                    },
                    &quot;id&quot;: &quot;puc_order_3&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/order_delivery.png&quot;,
                    &quot;title&quot;: &quot;待发货&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/pay/my_order/receive&quot;
                    },
                    &quot;id&quot;: &quot;puc_order_4&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/order_receive.png&quot;,
                    &quot;title&quot;: &quot;待收货&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/pay/my_order/wait_retreat?opt_type=general&quot;
                    },
                    &quot;id&quot;: &quot;puc_order_5&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/wait_retreat.png&quot;,
                    &quot;title&quot;: &quot;退款/售后&quot;
                }
            ],
            &quot;id&quot;: &quot;puc_order&quot;
        },
        {
            &quot;category&quot;: &quot;NBNativeCategoryMineColumnItem&quot;,
            &quot;section&quot;: {
                &quot;title&quot;: &quot;特殊角色&quot;
            },
            &quot;list&quot;: [
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/teacher_zone?etype=community&quot;
                    },
                    &quot;id&quot;: &quot;puc_role_1&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/t_zone_icon.png&quot;,
                    &quot;title&quot;: &quot;教师专区&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com#&quot;
                    },
                    &quot;id&quot;: &quot;puc_role_2&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/t_zone_helper.png&quot;,
                    &quot;title&quot;: &quot;助教专区&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/domain_wx/emissary_center?_app_template=fullscreen&quot;
                    },
                    &quot;id&quot;: &quot;puc_role_3&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/icon_mycount_bouns.png&quot;,
                    &quot;title&quot;: &quot;大使专区&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/myshare&quot;
                    },
                    &quot;id&quot;: &quot;puc_role_4&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/icon_share.png&quot;,
                    &quot;title&quot;: &quot;邀请有奖&quot;
                }
            ],
            &quot;id&quot;: &quot;puc_role&quot;
        },
        {
            &quot;category&quot;: &quot;NBNativeCategoryMineColumnItem&quot;,
            &quot;section&quot;: {
                &quot;title&quot;: &quot;工具和服务&quot;
            },
            &quot;list&quot;: [
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.comxx&quot;,
                        &quot;command&quot;: &quot;app_action&quot;,
                        &quot;name&quot;: &quot;opencachedir&quot;,
                        &quot;template&quot;: &quot;fullscreen&quot;,
                        &quot;region_name&quot;: &quot;popup&quot;
                    },
                    &quot;id&quot;: &quot;puc_tool_1&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/download_list.png&quot;,
                    &quot;title&quot;: &quot;下载&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/diary/favorite_dir&quot;
                    },
                    &quot;id&quot;: &quot;puc_tool_2&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/icon_fav.png&quot;,
                    &quot;title&quot;: &quot;收藏&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/ec&quot;
                    },
                    &quot;id&quot;: &quot;puc_tool_3&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/eshop.png&quot;,
                    &quot;title&quot;: &quot;微店&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/cs_center&quot;
                    },
                    &quot;id&quot;: &quot;puc_tool_4&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/icon_cs.png&quot;,
                    &quot;title&quot;: &quot;客服&quot;
                }
            ],
            &quot;id&quot;: &quot;puc_tool&quot;
        },
        {
            &quot;category&quot;: &quot;NBNativeCategoryMineColumnItem&quot;,
            &quot;section&quot;: {
                &quot;action&quot;: {
                    &quot;url&quot;: &quot;http://x.namibox.com/auth/my_settings&quot;
                },
                &quot;more&quot;: &quot;更多 &gt;&quot;,
                &quot;title&quot;: &quot;设置&quot;
            },
            &quot;list&quot;: [
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/binding/wechat&quot;
                    },
                    &quot;id&quot;: &quot;puc_settings_1&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/wechat.png&quot;,
                    &quot;title&quot;: &quot;绑定微信&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/dev_manage&quot;
                    },
                    &quot;id&quot;: &quot;puc_settings_2&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/device.png&quot;,
                    &quot;title&quot;: &quot;设置管理&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/mpwdpage&quot;
                    },
                    &quot;id&quot;: &quot;puc_settings_3&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/passwords.png&quot;,
                    &quot;title&quot;: &quot;修改密码&quot;
                },
                {
                    &quot;action&quot;: {
                        &quot;url&quot;: &quot;http://x.namibox.com/auth/go_checkuser&quot;
                    },
                    &quot;id&quot;: &quot;puc_settings_4&quot;,
                    &quot;img&quot;: &quot;http://172.16.6.97/tina/static/app/icon/v5/puc/phone.png&quot;,
                    &quot;title&quot;: &quot;更换手机号&quot;
                }
            ],
            &quot;id&quot;: &quot;puc_settings&quot;
        }
    ],
    &quot;id&quot;: &quot;puc&quot;
}</code></pre></table></div><h2>14.6、原生化--App世界页面</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>世界页面请求接口</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li>
<p><code>https://namibox.com/appnative/pworld</code>  </p>
</li>
<li>备注：参数及返回格式同课内
![pad效果图](<a href="http://doc.namibox.com/Public/Uploads/2018-06-13/5b20d8c0319cf.png">http://doc.namibox.com/Public/Uploads/2018-06-13/5b20d8c0319cf.png</a> "pad效果图")
![手机效果图](<a href="http://doc.namibox.com/Public/Uploads/2018-06-13/5b20d8fa116f2.png">http://doc.namibox.com/Public/Uploads/2018-06-13/5b20d8fa116f2.png</a> "手机效果图")
<h1>banner</h1>
<p>见[基础栏目](<a href="http://doc.namibox.com/index.php?s=/1&page_id=135">http://doc.namibox.com/index.php?s=/1&page_id=135</a> "基础栏目")</p></li>
</ul>
<p><strong>一、广告位banner</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">空</th>
<th>默认</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目id</td>
</tr>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">否</td>
<td>NBNativeCategoryBanner</td>
<td>栏目类别</td>
</tr>
<tr>
<td style="text-align: left;">section</td>
<td style="text-align: left;">dic</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目头信息(banner默认无)</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">是</td>
<td></td>
<td>栏目数据</td>
</tr>
</tbody>
</table>
<p>list所包含对象：</p>
<table width='100%' class='codestyle'><pre><code>  {
  &quot;id&quot;:&quot;&quot;,  //对象id
   &quot;img&quot;: &quot;图片地址&quot;,
   &quot;video_url&quot;:,   //非必选，如果banner是视频的话，点击可直接播放，可全屏播放
    &quot;action&quot;: {}    //点击事件和video_url两者最多只存在一个事件响应
  }</code></pre></table>
<h1>盒粉秀/成长圈</h1>
<p>图片宫格形式</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">是</td>
<td>NBNativeCategoryGrid</td>
</tr>
<tr>
<td style="text-align: left;">type</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">是</td>
<td>子类型，1表示小图（宽高比228:180，手机显示3列，pad显示6列），2表示宽图（宽高比345:180，手机显示2列，pad显示4列）</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">array</td>
<td style="text-align: left;">否</td>
<td>信息列表</td>
</tr>
</tbody>
</table>
<p>json示例</p>
<table width='100%' class='codestyle'><pre><code>{
    ...
    &quot;type&quot;: 1,
    &quot;list&quot;: [
        {
        &quot;id&quot;: &quot;1&quot;,
        &quot;title&quot;: &quot;配音秀&quot;,
        &quot;img&quot;:&quot;背景图&quot;  //可选
        &quot;subtitle&quot;:&quot;趣配音&quot; //为空不显示
        &quot;action&quot;:{}
        },
        ...
    ]
}</code></pre></table>
<h1>活动圈</h1>
<p>见[基础栏目](<a href="http://doc.namibox.com/index.php?s=/1&page_id=135">http://doc.namibox.com/index.php?s=/1&page_id=135</a> "基础栏目")</p>
<h1>藏宝图</h1>
<p>横向滚动图片</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">category</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>NBNativeCategoryHorizontalScroll</td>
</tr>
<tr>
<td style="text-align: left;">list</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">array</td>
<td>栏目数据，格式如下示例</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>  {
    ...
    &quot;list&quot;:
        [
            {
            &quot;img&quot;:&quot;https://w.namibox.com/...&quot;,
            &quot;action&quot;:{}
            },
            ...
        ]
  }</code></pre></table>
<h1>活动</h1>
<p>同[个人栏目](<a href="http://doc.namibox.com/index.php?s=/1&page_id=139">http://doc.namibox.com/index.php?s=/1&page_id=139</a> "个人栏目")</p>
<h1>父母圈</h1>
<p>同[课内页面学习资料](<a href="http://doc.namibox.com/index.php?s=/1&page_id=135">http://doc.namibox.com/index.php?s=/1&page_id=135</a> "课内页面学习资料")</p></div><h2>14.7、点读进度提交接口</h2><div style="margin-left:20px;"><p><strong>简要描述：</strong> </p>
<ul>
<li>课本点读时长上报接口</li>
</ul>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://namibox.com/appnative/pme/clicktime</code></li>
</ul>
<p><strong>请求方式：</strong></p>
<ul>
<li>
<p>POST </p>
<p><strong>请求示例</strong></p>
</li>
</ul>
<table width='100%' class='codestyle'><pre><code>    [
     {&quot;bookid&quot;:tape1a_0001,&quot;day_time&quot;:1000},
     {&quot;bookid&quot;:tape1a_0002,&quot;day_time&quot;:2000}
    ]</code></pre></table>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>课本id</td>
</tr>
<tr>
<td style="text-align: left;">day_time</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>单位秒</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>    [
     {&quot;id&quot;:&quot;pme_clickbook_tape1a-0001&quot;,bookid&quot;:tape1a_0001,&quot;study_time&quot;:累积学习：12小时30分钟，&quot;today_study_time&quot;:40分钟},
{&quot;id&quot;:&quot;pme_clickbook_tape1a-0002&quot;,bookid&quot;:tape1a_0002,&quot;study_time&quot;:累积学习：12小时30分钟，&quot;today_study_time&quot;:40分钟},</code></pre></table>
<p><strong>返回参数说明</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>刷新对象ID，*书本id数字部分）</td>
</tr>
<tr>
<td style="text-align: left;">bookid</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>课本id</td>
</tr>
<tr>
<td style="text-align: left;">study_time</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>值：（累积学习：时间）</td>
</tr>
<tr>
<td style="text-align: left;">today_study_time</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>值：（今日已学：时间）</td>
</tr>
</tbody>
</table>
<p>*</p></div><h2>14.8、全部工具页面</h2><div style="margin-left:20px;"><h2>接口数据</h2>
<ul>
<li>url:<a href="https://dev.namibox.com/appnative/tools">https://dev.namibox.com/appnative/tools</a></li>
</ul>
<pre><code class="language-json">{
    &quot;data&quot;: [
        {
            &quot;id&quot;: &quot;1&quot;,
            &quot;title&quot;: &quot;首页推荐&quot;,
            &quot;category&quot;: &quot;first_page&quot;,
            &quot;list&quot;: [
                {
                    &quot;id&quot;: &quot;1&quot;,
                    &quot;icon&quot;: &quot;http://pic.qiantucdn.com/58pic/21/45/60/5771f78d0cffe_1024.jpg!qt324&quot;,
                    &quot;img&quot;: &quot;&quot;,
                    &quot;subtitle&quot;: &quot;&quot;,
                    &quot;title&quot;: &quot;成绩单&quot;,
                    &quot;recommend&quot;: 0,
                    &quot;display&quot;: 0,
                    &quot;action&quot;: &quot;&quot;
                }
            ]
        }
    ]
}</code></pre></table>
<h2>参数说明</h2>
<h3>recommend item是否被推荐 //0未推荐 1推荐</h3>
<h3>display item是否首页展示 //0不展示 1展示</h3>
<h3><strong><em>首页展示也作为一个单独的section放在数组的第一位</em></strong></h3>
<h2>上报接口</h2>
<ul>
<li>url:<a href="https://dev.namibox.com/appnative/report_tools">https://dev.namibox.com/appnative/report_tools</a></li>
<li>method：POST</li>
<li>data
<pre><code class="language-json">{
&quot;tools&quot;:[
{
&quot;display&quot;: 1,
&quot;subtitle&quot;: &quot;&quot;,
&quot;img&quot;: &quot;https://dev.namibox.com/tina/static/app/icon/v5/pschool/icon_purple.png&quot;,
&quot;title&quot;: &quot;听力教辅&quot;,
&quot;action&quot;: {
&quot;url&quot;: &quot;https://dev.namibox.com/v/referencebook&quot;
},
&quot;recommend&quot;: 1,
&quot;id&quot;: &quot;referencebook&quot;,
&quot;icon&quot;: &quot;https://dev.namibox.com/tina/static/app/icon/v5/pschool/icon_tingli.png&quot;
},
{
&quot;display&quot;: 1,
&quot;subtitle&quot;: &quot;&quot;,
&quot;img&quot;: &quot;https://dev.namibox.com/tina/static/app/icon/v5/pschool/icon_orange.png&quot;,
&quot;title&quot;: &quot;作文库&quot;,
&quot;action&quot;: {
&quot;url&quot;: &quot;https://dev.namibox.com/dict/article_homepage&quot;
},
&quot;recommend&quot;: 1,
&quot;id&quot;: &quot;article&quot;,
&quot;icon&quot;: &quot;https://dev.namibox.com/tina/static/app/icon/v5/pschool/icon_zuowen.png&quot;
},
{
&quot;display&quot;: 1,
&quot;subtitle&quot;: &quot;&quot;,
&quot;img&quot;: &quot;https://dev.namibox.com/tina/static/app/icon/v5/pschool/icon_rose.png&quot;,
&quot;title&quot;: &quot;汉字笔顺&quot;,
&quot;action&quot;: {
&quot;url&quot;: &quot;https://dev.namibox.com/dict/zidian?kw=火&quot;
},
&quot;recommend&quot;: 1,
&quot;id&quot;: &quot;zidian&quot;,
&quot;icon&quot;: &quot;https://dev.namibox.com/tina/static/app/icon/v5/pschool/icon_hanzi.png&quot;
}]
}</code></pre></table></li>
</ul></div><h2>14.9、原生化-签到抽奖页面</h2><div style="margin-left:20px;"><p>三、签到</p>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://namibox.com/appnative/psign</code>  </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">isLogin</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">boolean</td>
<td>是否已登录</td>
</tr>
<tr>
<td style="text-align: left;">usernum</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户总签到数量</td>
</tr>
<tr>
<td style="text-align: left;">totaldays</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>累计签到天数</td>
</tr>
<tr>
<td style="text-align: left;">ctotaldays</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>连续签到天数</td>
</tr>
<tr>
<td style="text-align: left;">url</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>未登录的url</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>描述信息</td>
</tr>
<tr>
<td style="text-align: left;">subtitle</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>按钮提示信息</td>
</tr>
</tbody>
</table>
<p><strong>返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;isLogin&quot;: true,
    &quot;totaldays&quot;: &quot;0016&quot;,
    &quot;subtitle&quot;: &quot;签到抽奖&quot;,
    &quot;title&quot;: &quot;您已连续签到0天&quot;,
    &quot;ctotaldays&quot;: 0,
    &quot;usernum&quot;: &quot;00000&quot;
}</code></pre></table>
<p>四、抽奖</p>
<p><strong>请求URL：</strong> </p>
<ul>
<li><code>https://namibox.com/appnative/plottery</code> </li>
</ul>
<p><strong>参数：</strong> </p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">参数名</th>
<th style="text-align: left;">必选</th>
<th style="text-align: left;">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">usernum</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>用户总签到数量</td>
</tr>
<tr>
<td style="text-align: left;">status</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">boolean</td>
<td>签到抽奖动作执行结果状态返回</td>
</tr>
<tr>
<td style="text-align: left;">rewardtype</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>奖品类型 0=积分 1=优惠券</td>
</tr>
<tr>
<td style="text-align: left;">rewardnum</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">int</td>
<td>奖品价值 (积分数或者优惠券面值)</td>
</tr>
<tr>
<td style="text-align: left;">coupontype</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">string</td>
<td>优惠券类型</td>
</tr>
<tr>
<td style="text-align: left;">title</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">String</td>
<td>优惠券则为优惠券描述信息 如：微课伴学优惠券;积分则为积分底部提示信息</td>
</tr>
<tr>
<td style="text-align: left;">subtitle</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">String</td>
<td>按钮提示信息</td>
</tr>
<tr>
<td style="text-align: left;">id</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">String</td>
<td>优惠券id</td>
</tr>
<tr>
<td style="text-align: left;">url</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">String</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>正确返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;status&quot;: true,
    &quot;subtitle&quot;: &quot;&quot;,
    &quot;title&quot;: &quot;抽中积分已直接发放到账户，积分用于账号升级\n暂时可以用来抵扣错题精讲，同步课课练等课程&quot;,

        &quot;url&quot;: &quot;&quot;,
    &quot;usernum&quot;: &quot;00002&quot;,
    &quot;rewardnum&quot;: 10,
    &quot;rewardtype&quot;: 0
}</code></pre></table>
<p><strong>错误返回示例</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;error_desc&quot;: &quot;您已经签到&quot;,
    &quot;status&quot;: false,
    &quot;error_code&quot;: 1002
}</code></pre></table></div><h2>14.10、出版社&amp;品牌专区</h2><div style="margin-left:20px;"><ul>
<li>url:<a href="https://dev.namibox.com/appnative/brand_publish">https://dev.namibox.com/appnative/brand_publish</a></li>
<li>data:</li>
</ul>
<pre><code class="language-json">{
&quot;brand_list_data&quot;: {
&quot;培生教材&quot;: {
&quot;icon&quot;: &quot;/tina/static/v/menu/longman/title.pnghttp://172.16.7.70&quot;,
&quot;tips_text&quot;: &quot;新朗文小学英语&quot;,
&quot;title&quot;: &quot;培生教材&quot;,
&quot;url&quot;: &quot;/v/menu/longmanhttp://172.16.7.70&quot;
}
},
&quot;publisher&quot;: {
&quot;New Cambridge剑桥少儿&quot;: {
&quot;icon&quot;: &quot;http://172.16.7.70/tina/static/v/publisher/NC/title.jpg?upd=20180222105836&quot;,
&quot;subtitle&quot;: &quot;收录了New Cambridge剑桥少儿的电子化教材，支持复读、点读及跟读评测功能&quot;,
&quot;title&quot;: &quot;New Cambridge剑桥少儿&quot;
},
&quot;SuperKids少儿英语&quot;: {
&quot;icon&quot;: &quot;http://172.16.7.70/tina/static/v/publisher/SK/title.jpg?upd=20180222105836&quot;,
&quot;subtitle&quot;: &quot;收录了SuperKids少儿英语的电子化教材，支持复读、点读及跟读评测功能&quot;,
&quot;title&quot;: &quot;SuperKids少儿英语&quot;
}
}
}</code></pre></table></div><h2>14.11、顶部扫码接口</h2><div style="margin-left:20px;"><p>*简要描述：** </p>
<ul>
<li>顶部扫码接口</li>
</ul>
<p><em>书本条码：</em> </p>
<table width='100%' class='codestyle'><pre><code>
扫码结果以978开头，请求扫码地址。和点读页扫码一致
请求url: https://namibx.com/api/app/search_scnamicode?scnamicode=**扫码结果**
</code></pre></table>
<p><em>特殊登录二维码</em> </p>
<table width='100%' class='codestyle'><pre><code>
扫码结果包含**_login|**，请求扫码地址。没有登录先提示登录。
请求url:  https://namibx.com/auth/token_fire?action=' + action + '&amp;token=' + token 

action：为|前面部分
token：为|后面部分
</code></pre></table>
<p><em>扫码为url</em> </p>
<table width='100%' class='codestyle'><pre><code>1.若果是包含namibox.com的域名，直接open新窗口，
2.否则提示该地址 &quot;+result+&quot; 不是纳米盒的地址，如果打开存在一定的风险。您确定要打开这个地址吗？，用默认浏览器打开。
</code></pre></table>
<p>*扫码流程：**
<img src="http://doc.namibox.com/Public/Uploads/2018-06-23/5b2e0de42a7e3.png" alt="" /></p></div><h2>14.12、年级上报接口</h2><div style="margin-left:20px;"><h2>年纪上报接口</h2>
<ul>
<li>url:<a href="https://dev.namibox.com/appnative/report_grade">https://dev.namibox.com/appnative/report_grade</a></li>
<li>method:POST</li>
<li>
<p>data</p>
<pre><code class="language-json">{
&quot;grade&quot;:&quot;2a&quot;
}</code></pre></table>
</li>
<li>参数说明
grade: sysconfig中年级数据的key对应的值</li>
</ul></div><h2>14.1、Web与App消息推送机制</h2><div style="margin-left:20px;"><h3>14.1.1、页面消息定义</h3><div style="margin-left:30px;"><p><strong>基础页面id</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段（页面）</th>
<th style="text-align: left;">id</th>
<th>view_name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">课内页面</td>
<td style="text-align: left;">pschool</td>
<td>main_school</td>
</tr>
<tr>
<td style="text-align: left;">课外页面</td>
<td style="text-align: left;">pouter</td>
<td>main_outer</td>
</tr>
<tr>
<td style="text-align: left;">PME页面</td>
<td style="text-align: left;">pme</td>
<td>main_me</td>
</tr>
<tr>
<td style="text-align: left;">世界页面</td>
<td style="text-align: left;">pworld</td>
<td>main_world</td>
</tr>
<tr>
<td style="text-align: left;">我的页面</td>
<td style="text-align: left;">puc</td>
<td>main_user</td>
</tr>
</tbody>
</table>
<p><strong>转发给页面的消息</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">type</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;"></td>
<td>默认为空，表示转发给页面的消息，APP解析后将推送广播出去，或者传递给指定viewname的页面处理</td>
</tr>
<tr>
<td style="text-align: left;">message_name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;"></td>
<td>消息类型</td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;"></td>
<td>传给页面的消息体</td>
</tr>
<tr>
<td style="text-align: left;">dest_view_name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;"></td>
<td>指定处理消息的页面的viewname，如为空，则广播处理</td>
</tr>
</tbody>
</table>
<p><strong>message 刷新类型</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">字段（页面）</th>
<th style="text-align: left;">message</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">刷新页面</td>
<td style="text-align: left;">refresh_page</td>
<td>刷新单个页面</td>
</tr>
<tr>
<td style="text-align: left;">刷新栏目</td>
<td style="text-align: left;">refresh_lanmu</td>
<td>刷新单个栏目</td>
</tr>
<tr>
<td style="text-align: left;">刷新对象</td>
<td style="text-align: left;">refresh_obj</td>
<td>对象是数组，可以刷新多个。为了兼容原来功能避免过多消息，push_class_webcast、push_class_webcast_finish、push_newmsg、push_dynamic 等同 refresh_obj</td>
</tr>
</tbody>
</table>
<p><strong>message 页面刷新消息</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;refresh_page&quot;,
                &quot;obj&quot;: {
                        &quot;id&quot;: &quot;pme&quot;
                        }
                },
    &quot;dest_view_name&quot;: &quot;main_user&quot;
}</code></pre></table>
<p><strong>message 栏目刷新消息</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;refresh_lanmu&quot;,
                &quot;obj&quot;: {
                        &quot;id&quot;: &quot;pme_classzone&quot;
                        }
                },
    &quot;dest_view_name&quot;: &quot;main_user&quot;
}</code></pre></table>
<p><strong>message 对象刷新消息，对象的obj是数组，可以刷新页面多个对象</strong></p>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;refresh_obj&quot;,
                &quot;msgcount&quot;:5
                &quot;obj&quot;: [{
                        &quot;id&quot;: &quot;puc_mymsg_newmsg&quot;,
                        &quot;msgcount&quot;: 5
                        },{
                        &quot;id&quot;: &quot;puc_mymsg_friendreq&quot;,
                        &quot;msgcount&quot;: 1
                        }],
                },
    &quot;dest_view_name&quot;: &quot;main_user&quot;
}</code></pre></table></div><h3>14.1.2、我的页面</h3><div style="margin-left:30px;"><hr />
<p><strong>好友发新帖、发盒粉秀作品</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">message</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">push_dynamic</td>
<td>消息类型，为兼容等同refresh_obj</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">list</td>
<td style="text-align: left;">[{"id": "puc_mymsg_friendsdynamic", "msgcount": 1} ]</td>
<td>对象id  （格式：页面id_栏目id_对象id）</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;push_dynamic&quot;,
                &quot;obj&quot;: [{
                        &quot;id&quot;: &quot;puc_mymsg_friendsdynamic&quot;,
                        &quot;msgcount&quot;: 1
                        }]
                },
    &quot;dest_view_name&quot;: &quot;main_user&quot;
}</code></pre></table>
<p><strong>消息中心--好友请求、点赞、回复</strong>
<strong>我的好友--好友请求</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">message</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">push_newmsg</td>
<td>消息类型    ，为兼容等同refresh_obj</td>
</tr>
<tr>
<td style="text-align: left;">msgcount</td>
<td style="text-align: left;">int</td>
<td style="text-align: left;">5</td>
<td>消息中心数量</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">list</td>
<td style="text-align: left;">[{"id": "puc_mymsg_newmsg","msgcount": 5}]</td>
<td>消息中心数量</td>
</tr>
<tr>
<td style="text-align: left;">friend_req</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;"></td>
<td>frined_req(req, agree, reject) ，备注：客户端可以忽略，兼容老版本</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;push_newmsg&quot;,
                &quot;msgcount&quot;:5
                &quot;obj&quot;: [{
                        &quot;id&quot;: &quot;puc_mymsg_newmsg&quot;,
                        &quot;msgcount&quot;: 5
                        },{
                        &quot;id&quot;: &quot;puc_mymsg_friendreq&quot;,
                        &quot;msgcount&quot;: 1
                        }],
                &quot;friend_req&quot;: &quot; &quot;,
                },
    &quot;dest_view_name&quot;: &quot;main_user&quot;
}</code></pre></table></div><h3>14.1.3、PME页面</h3><div style="margin-left:30px;"><p><strong>班级圈--学校合并</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">message</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">refresh_lanmu</td>
<td>消息类型</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">{"id": "pme_classzone"}</td>
<td>对象id  （格式：页面id_栏目id_对象_id）</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;refresh_lanmu&quot;,
                &quot;obj&quot;: {
                        &quot;id&quot;: &quot;pme_classzone&quot;
                        }
                },
    &quot;dest_view_name&quot;: &quot;main_me&quot;
}</code></pre></table>
<p><strong>班级圈--老师布置作业数、学生完成作业</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">message</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">refresh_obj</td>
<td>消息类型</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">list</td>
<td style="text-align: left;">[{"id": "pme_classzone_work5","number": 10}]</td>
<td>对象id  （格式：页面id_栏目id_对象id）备注：5为班级圈中的班级id, 10为作业数量</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;:[{
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;refresh_obj&quot;,
                &quot;obj&quot;: {
                        &quot;id&quot;: &quot;pme_classzone_work5&quot;,
                        &quot;number&quot;: 10
                        }
                }],
    &quot;dest_view_name&quot;: &quot;main_me&quot;
}</code></pre></table>
<p><strong>班级圈--直播开始</strong>
---备注：直播开始需要app显示标志同时，需要弹窗提示是否进入直播间。原有推送稍微改造。</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">message</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">push_class_webcast</td>
<td>消息类型，为兼容等同refresh_obj</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">list</td>
<td style="text-align: left;">[{"id": "pme_classzone_work5",right_icon":""} ]</td>
<td>对象id  （格式：页面id_栏目id_对象id）备注：5为班级圈中的班级id</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;push_class_webcast&quot;,
                &quot;obj&quot;: {
                        &quot;id&quot;: &quot;pme_classzone_work5&quot;,
                        &quot;right_icon&quot;:&quot;%s/tina/static/app/icon/v5/pme/go_living.png&quot;
                        }
                },
                'virtual_id': '',
                'target_class_id': '',
                'src_class': '',
                'cast_domain': '',
                'service_type': '',
                'webcast_id': '',
                'watch_password': '', 
                'room_number': '',
                'nick_name': '', 
                'head_img':''
    &quot;dest_view_name&quot;: &quot;main_me&quot;
}</code></pre></table>
<p><strong>班级圈--直播结束通知</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">message</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">push_class_webcast_finish</td>
<td>消息类型，为兼容等同refresh_obj</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">list</td>
<td style="text-align: left;">[{"id": "pme_classzone_work5","right_icon":""}]</td>
<td>对象id  （格式：页面id_栏目id_对象id）备注：5为班级圈中的班级id</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;push_class_webcast_finish&quot;,
                &quot;obj&quot;: [{
                        &quot;id&quot;: &quot;pme_classzone_work5&quot;，
                        &quot;right_icon&quot;:&quot;%s/tina/static/app/icon/v5/pme/enter_class.png&quot;}
                        }]
                },
                'virtual_id': '',
                'target_class_id': '',
                'src_class': '',
                'cast_domain': '',
                'service_type': '',
                'webcast_id': '',
                'watch_password': '', 
                'room_number': '',
                'nick_name': '', 
                'head_img':''
    &quot;dest_view_name&quot;: &quot;main_me&quot;
}</code></pre></table>
<p><strong>1.网校--购买成功、AI服务器开班失败
2.网校--申请退款成功/更换班级/课前课后作业完成，领取学分后/一次性任务完成领取学分/网课直播结束后（进度更新、消息通知）/领取毕业证书
</strong>
---备注：可能还是要更具实际情况刷新栏目还是刷新整个页面，优先栏目。</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">message</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">refresh_lanmu</td>
<td>消息类型</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">{"id": "pme_vschool"}</td>
<td>对象id  （格式：页面id_栏目id_对象id）</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;refresh_lanmu&quot;,
                &quot;obj&quot;: {
                        &quot;id&quot;: &quot;pme_vschool&quot;
                        }
                },
    &quot;dest_view_name&quot;: &quot;main_me&quot;
}</code></pre></table>
<p><strong>网校--消息盒子数变更中AI服务器的消息/评论/留言</strong>
---备注：课程服务器班级结束后，报告导致消息盒子数变更。栏目刷新有了。</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">message</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">refresh_obj</td>
<td>消息类型</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">list</td>
<td style="text-align: left;">[{"id": "pme_vschool_msgbox5","obj_value": 10}]</td>
<td>对象id  （格式：页面id_栏目id_对象id）备注：5为网校班级id, 10为消息盒子数</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;refresh_obj&quot;,
                &quot;obj&quot;: [{
                        &quot;id&quot;: &quot;pme_vschool_msgbox5&quot;,
                        &quot;number&quot;: 10
                        }]
                },
    &quot;dest_view_name&quot;: &quot;main_me&quot;
}</code></pre></table>
<p><strong>微课堂、课外栏目、点读和教辅购买成功</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">message</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">refresh_page</td>
<td>消息类型</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">{"id":"pme"}</td>
<td>对象id  （格式：页面id_栏目id_对象id）</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;refresh_page&quot;,
                &quot;obj&quot;: &quot;{
                        &quot;id&quot;: &quot;pme&quot;
                        }&quot;
                },
    &quot;dest_view_name&quot;: &quot;main_me&quot;
}</code></pre></table>
<p><strong>微课伴学--  购买成功/制订学习计划/做任务</strong>
---备注：做任务是否发送消息根据任务的完成情况获得爱心的变化。</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">message</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">refresh_lanmu</td>
<td>消息类型</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">json</td>
<td style="text-align: left;">{"id": "pme_banxue"}</td>
<td>消息对象</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;refresh_lanmu&quot;,
                &quot;obj&quot;: &quot;{
                        &quot;id&quot;: &quot;pme_banxue&quot;
                        }&quot;
                },
    &quot;dest_view_name&quot;: &quot;main_me&quot;
}</code></pre></table>
<p><strong>微课伴学-- 微课伴学全局栏目对象刷新</strong>
---备注：微课伴学全局爱心，打卡天数，已学课时有变化，都会发送此消息。</p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">message</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">message</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">refresh_obj</td>
<td>消息类型</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">list</td>
<td style="text-align: left;">[{"id": "pme_banxuetop_hearts", "number":7}]</td>
<td>对象ID，pme_banxuetop_hearts（爱心）、pme_banxuetop_punch（打卡）、pme_banxuetop_courses（已学课时）</td>
</tr>
</tbody>
</table>
<table width='100%' class='codestyle'><pre><code>{
    &quot;type&quot;: &quot; &quot;,
    &quot;message_name&quot;: &quot; &quot;,
    &quot;message&quot;: {
                &quot;command&quot;: &quot;message&quot;,
                &quot;message&quot;: &quot;refresh_obj&quot;,
                &quot;obj&quot;: [{
                        &quot;id&quot;: &quot;pme_banxuetop_hearts&quot;,
                        &quot;number&quot;: 60
                        }]
                },
    &quot;dest_view_name&quot;: &quot;main_me&quot;
}</code></pre></table></div><h3>14.1.4、跳转消息</h3><div style="margin-left:30px;"><p><strong>跳转指定页面消息</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">jump_page</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">view_name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">"main_school"</td>
<td>跳转的view</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">dict</td>
<td style="text-align: left;">{"id"："pme"}</td>
<td>id为要跳转的页面id</td>
</tr>
</tbody>
</table>
<p><strong>跳转指定页面栏目消息</strong></p>
<table>
<thead><tr style='background-color: rgb(0, 136, 204); color: rgb(255, 255, 255);'>
<th style="text-align: left;">key</th>
<th style="text-align: left;">类型</th>
<th style="text-align: left;">value</th>
<th>注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">command</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">jump_lanmu</td>
<td></td>
</tr>
<tr>
<td style="text-align: left;">view_name</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">"main_school"</td>
<td>跳转的view</td>
</tr>
<tr>
<td style="text-align: left;">obj</td>
<td style="text-align: left;">dict</td>
<td style="text-align: left;">{"id"："pschool_vschool"}</td>
<td>id为要跳转的页面id</td>
</tr>
</tbody>
</table></div></div></div><h1>15、微课伴学</h1><div style="margin-left:20px;"></div></body></html>